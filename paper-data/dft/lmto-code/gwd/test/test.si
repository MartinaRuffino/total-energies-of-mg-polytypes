#!/bin/tcsh

set testfile = $0
set testdir = $testfile:h
set topdir  = `cd $testdir/../..; pwd`

set path = ($topdir $topdir/utils $path)


echo '--- start test of optics with mefac, Si'
echo "... 1. $testdir/test.gwd --quiet --poszer --noplot si"
$testdir/test.gwd --quiet --poszer --noplot si
echo '... 2. do optics'
cp $testdir/si/sigma.si .
echo 'lmf si -vnk=12 -vmetal=3 -voptmod=1 -vmefac=2 -vsig=12 --rsig:ascii --rs=1,0 -vnit=1 --iactiv=no --pr45,20,45 -vso=0 > out.si'
lmf si -vnk=12 -vmetal=3 -voptmod=1 -vmefac=2 -vsig=12 --rsig:ascii --rs=1,0 -vnit=1 --iactiv=no --pr45,20,45 -vso=0 > out.si
echo '... 3. check status of: cmp opt.si gwd/test/si/opt.si : '
set n = `cmp -l opt.si $testdir/si/opt.si  | wc -l`
if ($n <= 3) echo '          optics test yields' $n difference between files opt.si $testdir/si/opt.si ... PASSED
if ($n >  3) echo '          optics test yields' $n difference between files opt.si $testdir/si/opt.si ... FAILED

