% const nit=1 nsph=0 gfmode=1 pgf=0 sparse=1 scr=0 idxp=1 idxd=2 twoc=f gamma=twoc ccor=~twoc
% const idxf=scr%10==1?1:2 bzj=(scr%10==1?0:1) nsp=2 nc=f so=f nclead=0 declead=0 eref=-2540.56813
% const vne=0 nzne=(vne<>0)?abs(2000*vne)+1:0 delne=1e-10 mmode=(nzne>0)?110:10
% const lmf=t nel=2
% const rw=lmf?.88:1 nl=lmf?4:3
% char0 strx=cuau
% char eltl=ab elta=Co eltb=Pt
% includo spec.prop
% const a=7.1866 ca=.975
HEADER  CoPt ({strx})
VERS    LMASA-6 FTB-6 LMF-6 LM:7 ASA:7
IO      SHOW=F HELP=F VERBOS=30 20 IACTIV=t
GF      MODE={gfmode} GFOPTS={?~twoc==0~p3~}
HAM     NSPIN={nsp} REL=T NONCOL={nc} SO={so} QASA=0
OPTIONS NSPIN={nsp} REL=T SCR={scr} # SHARM=t
        ASA[CCOR={ccor} TWOC={twoc} GAMMA={gamma} NSPH={nsph} ] HF=t
        NONCOL={nc} SO={so} FORCES=f
# put in symops by hand to test layer GF for this case
% ifdef strx=='24yz'
% ifdef nzne
SYMGRP  r2x # NOORB
% endif
% ifdef nc & pgf==1|pgf==5|pgf==7
SYMGRP  i::(0,1/2,-1/20) r2x r2z::(0,-1/2,-1/20)
%endif
% endif

% ifdef strx=='file'
% ifdef nc & pgf==1|pgf==2|pgf==5|pgf==7
SYMGRP  i::(0,1/2,-1/20) r2x r2z::(0,-1/2,-1/20)
%endif
% const nk1=12 nk2=nk1 nk3=2 nz=10
PGF     MODE={pgf} PLATL=1 0 0 PLATR=1 0 0 SPARSE={sparse}
        GFOPTS={?~twoc==0~p3~};padtol=1d-4;{?;nclead;nclead;};{?;declead;declead;};refinegs=1d-12
STRUC   FILE=site NL={nl} NSPEC=2 ALAT={a}
SPEC    ATOM=Co Z={Za} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefa} A=.03
        ATOM=Pt Z={Zb} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefb} A=.03
SITE    FILE=site
BZ      NKABC={nk1} {nk2} {nk3} BZJOB={bzj} METAL=T TETRA=T NPTS=900 SAVDOS=F NOINV=0
%ifdef pgf==5|pgf==7
        EMESH=10 0 -.1 0 -.001 .3 .01*0
%endif
        EMESH={nz} {mmode} -1 0 .5 .3 {nzne} {vne} {delne} .0001
% elseifd strx=='cuau'
% const nk1=12 nk2=10 nk3=nk1 nz=10
# lm copt -vscr=52 -vnit=0 -vbzj=1
% ifdef dir==110
STRUC   NBAS=2  NSPEC=2  NL={nl}  ALAT={a}/sqrt(2)
        PLAT=  1    0           0
               0   {ca}*sqrt(2) 0
               0    0           1
SITE    ATOM=Co  POS= 0.0000  0.000000       0.000000
        ATOM=Pt  POS= 0.5000  {ca}*sqrt(2)/2 0.5
BZ      NKABC={nk1} {nk2} {nk3} BZJOB={bzj} METAL=1 TETRA=T NPTS=900 SAVDOS=F
        EMESH={nz} 10 -1 -.05 .5 .3 .01*0 NOINV=0
% else
STRUC   NBAS=2  NSPEC=2  NL={nl}  ALAT={a}
        PLAT=  .5    .5    .0
               .5   -.5    .0
               .0    .0    {ca}
SITE    ATOM=Co  POS= 0.0000  0.00  0.000000
        ATOM=Pt  POS= 0.5000  0.00  {ca}/2
BZ      NKABC={nk1} {nk3} {nk2} BZJOB={bzj} METAL=T TETRA=T NPTS=900 SAVDOS=F
        EMESH={nz} 10 -1 -.05 .5 .3 .01*0 NOINV=0
% endif
SPEC    ATOM=Co Z={Za} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefa} A=.03
        ATOM=Pt Z={Zb} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefb} A=.03
ITER    MIX=B,b=.5 NIT={abs(nit)} CONVC=1D-5 CONV=0
%
MIX     MODE=B,b=.5
% elseifd strx=='l12'
% const ng=12 nk1=12 nz=10 a=7.1866
FTMESH  NG123={ng} TOL=1d-7
# lmfa copt -cstrx=l12 -vnsp=1
# ftb  copt -cstrx=l12 -vnsp=1
STRUC   NBAS=4 NSPEC=2 NL={nl} ALAT={a} PLAT=1 0 0  0 1 0   0 0 1
SITE    ATOM=Pt POS=   0.01   0.02   0.03
        ATOM=Co POS=  .5  .5   0
        ATOM=Co POS=   0  .5  .5
        ATOM=Co POS=  .5   0  .5
BZ      NKABC={nk1} {nk1} {nk1} BZJOB={bzj} METAL=2 TETRA=T NPTS=900 SAVDOS=F DELEF=.1
        EMESH={nz} 10 -1 -.05 .5 .3 .01*0 NOINV=0
SPEC    ATOM=Co Z={Za} LMX=2 LMXA={nl-1} R/W={rw}+.01 IDXDN=1 1 1 {idxf} EREF={erefa} A=.03
        BAS: {nel},0,1,2.3,-.1,2,2,1,-.1,0,2,1.3,-1,0,1,2,-3
        ATOM=Pt Z={Zb} LMX=2 LMXA={nl-1} R/W={rw}-.01 IDXDN=1 1 1 {idxf} EREF={erefb} A=.03
        BAS: {nel},0,1,2.3,-.1,2,2,1,-.1,0,2,1.3,-1,0,1,2,-3  LFOCA=2
ITER    MIX=B,b=.5 NIT={abs(nit)} CONVC=1D-5 CONV=0
MIX     MODE=B,b=.5
% elseifd strx=='12'
% const nk1=8 nk2=nk1 nk3=8 nz=10
# lm copt -vscr=52 -cstrx=12
STRUC   NBAS=12 NSPEC=2 NL={nl} ALAT=7.1866
        PLAT=  3.0 3.0  0
               0.5 -.5  0
               0   0   {ca}
SPEC    ATOM=Co Z={Za} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefa} A=.03
        ATOM=Pt Z={Zb} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefb} A=.03
SITE    ATOM=Co POS= -0.5 -0.5 0     ROT=(1,.1,.5)0*pi/5
        ATOM=Pt POS= 0.0 -.5 {ca}/2  ROT=(1,.1,.5)0*pi/5
        ATOM=Co POS= 0 0 0           ROT=(1,.1,.5)0*pi/5
        ATOM=Pt POS= 0.5 0.0 {ca}/2  ROT=(1,.1,.5)0*pi/5
        ATOM=Co POS= 0.5 0.5 0       ROT=(1,.0,.0)pi/1
        ATOM=Pt POS= 1.0 0.5 {ca}/2  ROT=(1,.1,.5)0*pi/5
        ATOM=Pt POS= 1 1 0           ROT=(1,.1,.5)0*pi/5
        ATOM=Co POS= 1.5 1.0 {ca}/2  ROT=(1,.1,.5)0*pi/5
        ATOM=Pt POS= 1.5 1.5 0       ROT=(1,.0,.0)pi/1
        ATOM=Co POS= 2.0 1.5 {ca}/2  ROT=(1,.1,.5)0*pi/5
        ATOM=Pt POS= 2.0 2.0 0       ROT=(1,.0,.0)pi/1
        ATOM=Co POS= 2.5 2.0 {ca}/2  ROT=(1,.1,.5)0*pi/5
BZ      NKABC={nk1} {nk2} {nk3} BZJOB={bzj} METAL=T TETRA=T NPTS=900 SAVDOS=F
        EMESH={nz} 10 -1 -.05 .5 .3 .01*0 NOINV=0
% elseifd strx=='16' | strx=='20' | strx=='24'
# lm copt -vscr=52 -cstrx=20
% cvar strx=='16' nbas=16 h=8
% cvar strx=='20' nbas=20 h=10
% cvar strx=='24' nbas=24 h=12
% const nk1=8 nk2=12 nk3=2 nz=10
CONST   dh={h}/2
PGF     MODE={pgf} PLATL=1 0 0 PLATR=1 0 0 GFOPTS={?~twoc==0~p3~} SPARSE={sparse}
STRUC   NBAS={nbas} NSPEC=2 NL={nl} ALAT=5.0816936
        PLAT=0   0 {ca}*sqrt(2)
             0   1 0
            {h}  0 0
SPEC    ATOM=Co Z={Za} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefa} A=.03
        ATOM=Pt Z={Zb} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefb} A=.03
SITE    ATOM=Co POS=-0.25  0.00  0             PL=-0
        ATOM=Co POS= 0.25  0.50  {ca}/sqrt(2)  PL= 0
        ATOM=Pt POS= 0.75  0.00  0             PL= 0
        ATOM=Pt POS=-0.75  0.50  {ca}/sqrt(2)  PL=-0
        ATOM=Co POS=-1.25  0.00  0             PL=-1
        ATOM=Co POS= 1.25  0.50  {ca}/sqrt(2)  PL= 1
        ATOM=Pt POS= 1.75  0.00  0             PL= 1
        ATOM=Pt POS=-1.75  0.50  {ca}/sqrt(2)  PL=-1
        ATOM=Co POS=-2.25  0.00  0             PL=-2
        ATOM=Co POS= 2.25  0.50  {ca}/sqrt(2)  PL= 2
        ATOM=Pt POS= 2.75  0.00  0             PL= 2
        ATOM=Pt POS=-2.75  0.50  {ca}/sqrt(2)  PL=-2
        ATOM=Co POS=-3.25  0.00  0             PL=-3
        ATOM=Co POS= 3.25  0.50  {ca}/sqrt(2)  PL= 3
        ATOM=Pt POS= 3.75  0.00  0             PL= 3
        ATOM=Pt POS=-3.75  0.50  {ca}/sqrt(2)  PL=-3
        ATOM=Co POS=-4.25  0.00  0             PL=-4
        ATOM=Co POS= 4.25  0.50  {ca}/sqrt(2)  PL= 4
        ATOM=Pt POS= 4.75  0.00  0             PL= 4
        ATOM=Pt POS=-4.75  0.50  {ca}/sqrt(2)  PL=-4
        ATOM=Co POS=-5.25  0.00  0             PL=-4
        ATOM=Co POS= 5.25  0.50  {ca}/sqrt(2)  PL= 4
        ATOM=Pt POS= 5.75  0.00  0             PL= 4
        ATOM=Pt POS=-5.75  0.50  {ca}/sqrt(2)  PL=-4
BZ      NKABC={nk1} {nk2} {nk3} BZJOB={bzj} METAL=T TETRA=T NPTS=900 SAVDOS=F
        EMESH={nz} 10 -1 -.05 .5 .3 .01*0 NOINV=0
# --- APB in yz plane ---
% elseifd strx=='24yz' | strx=='32yz'
# lm copt -cstrx=24yz
% cvar strx=='24yz' nbas=24 h=6
% cvar strx=='32yz' nbas=32 h=8
% const nk1=12 nk2=nk1 nk3=2 nz=10
PGF     MODE={pgf} PLATL=1 0 0 PLATR=1 0 0 SPARSE={sparse}
        GFOPTS={?~twoc==0~p3~};padtol={nzne?-1d-6:1d-4};{?;nclead;nclead;};{?;declead;declead;}# ;activerot
        GFOPTS={?~twoc==0~p3~};padtol={nzne?-1d-6:1d-4};{?;nclead;nclead;};{?;declead;declead;} #;refinegs=1d-12
STRUC   NBAS={nbas} NSPEC=2 NL={nl} ALAT={a}
        PLAT= 0  1   0
              0  0  {ca}
             {h} 0   0
SPEC    ATOM=Co Z={Za} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefa} A=.03
        ATOM=Pt Z={Zb} LMX=2 R/W={rw} IDXDN=1 1 1 {idxf} EREF={erefb} A=.03
SITE    ATOM=Co POS= 0.0000 0.0000 0       PL=0-1*1 ROT=y:pi
        ATOM=Pt POS= 0.5000 0.0000 {ca/2}  PL=0+1*1 ROT=y:pi
        ATOM=Co POS= 0.5000 0.5000 0       PL=0+1*1
        ATOM=Pt POS= 0.0000 0.5000 {ca/2}  PL=0-1*1
        ATOM=Co POS= 1.0000 0.0000 0       PL= 1
        ATOM=Pt POS= 1.5000 0.0000 {ca/2}  PL= 1
        ATOM=Co POS= 1.5000 0.5000 0       PL= 1
        ATOM=Pt POS= 1.0000 0.5000 {ca/2}  PL= 1
        ATOM=Co POS= 2.0000 0.0000 0       PL= 2
        ATOM=Pt POS= 2.5000 0.0000 {ca/2}  PL= 2
        ATOM=Co POS= 2.5000 0.5000 0       PL= 2
        ATOM=Pt POS= 2.0000 0.5000 {ca/2}  PL= 2
% ifdef strx=='32yz'
         ATOM=Co POS= 3.0000 0.0000 0       PL= 3
         ATOM=Pt POS= 3.5000 0.0000 {ca/2}  PL= 3
         ATOM=Co POS= 3.5000 0.5000 0       PL= 3
         ATOM=Pt POS= 3.0000 0.5000 {ca/2}  PL= 3
% endif
        ATOM=Pt POS=-1.0000 0.0000 0       PL=-1 ROT=y:pi
        ATOM=Co POS=-0.5000 0.0000 {ca/2}  PL=-1 ROT=y:pi
        ATOM=Pt POS=-0.5000 0.5000 0       PL=-1
        ATOM=Co POS=-1.0000 0.5000 {ca/2}  PL=-1
        ATOM=Pt POS=-2.0000 0.0000 0       PL=-2
        ATOM=Co POS=-1.5000 0.0000 {ca/2}  PL=-2
        ATOM=Pt POS=-1.5000 0.5000 0       PL=-2
        ATOM=Co POS=-2.0000 0.5000 {ca/2}  PL=-2
        ATOM=Pt POS=-3.0000 0.0000 0       PL=-3
        ATOM=Co POS=-2.5000 0.0000 {ca/2}  PL=-3
        ATOM=Pt POS=-2.5000 0.5000 0       PL=-3
        ATOM=Co POS=-3.0000 0.5000 {ca/2}  PL=-3
% ifdef strx=='32yz'
        ATOM=Pt POS=-4.0000 0.0000 0       PL=-4
        ATOM=Co POS=-3.5000 0.0000 {ca/2}  PL=-4
        ATOM=Pt POS=-3.5000 0.5000 0       PL=-4
        ATOM=Co POS=-4.0000 0.5000 {ca/2}  PL=-4
% endif
BZ      NKABC={nk1} {nk2} {nk3} BZJOB={bzj} METAL=T TETRA=T NPTS=900 SAVDOS=F
%ifdef pgf==5|pgf==7
        EMESH=10 0 -.1 0 -.001 .3 .01*0 NOINV=0
%endif
        EMESH={nz} {mmode} -1 0 .5 .3 {nzne} {vne} {delne} .0001
% endif
SYMGRP  find
.ITER    MIX=A0,b=.4 NIT={abs(nit)} CONVC=1D-4 CONV=0
.MIX     MODE=A0,b=.4
ITER    MIX=B,b={scr>0?.5:(pgf==2?.5:.2)} NIT={abs(nit)} CONVC=3D-6 CONV=0
MIX     MODE=B,b={scr>0?1:(pgf==2?.5:.2)}
START   BEGMOM={nit<0?2:nit==0} CNTROL=F
