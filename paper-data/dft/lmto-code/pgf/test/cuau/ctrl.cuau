HEADER  Master file for transition and other elemental metals
# For lmf or GW input, use e.g.
# lmf -vasa=f -vlmf=t
% const asa=t lmf=f scale=.983 lmxf=6 hf=f tp=t xcf=2 xcn=0 lmh=f au=t
% const nit=0 ccor=t twoc=f gamma=f exc=0 pgf=0 sparse=1 nclead=0 declead=0 da=0 scr=0 nsp=1
% const Zn=f Cd=f
%ifdef Li (a0e)
%const  vol=6.547^3/2 Z=3 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-14.8363:-14.7106 bcc=t
%elseifd Be (a0e,c0e)
%const  vol=4.275^3*0.961/sqrt(2) Z=4 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-29.0952:-28.9148 hcp=t
%elseifd C
%const  vol=7.67^3/4 Z=6 nd0=0 np0=2 mom=0 ef0=0
%const  eref=lmh?-75.3053:-74.9949
%var    tp=f
%elseifd N
%const  vol=7.67^3/4 Z=7 nd0=0 np0=3 mom=0 ef0=0
%const  eref=lmh?-108.7417:-108.3613
%var    tp=f
%elseifd O
%const  vol=7.67^3/4 Z=8 nd0=0 np0=4 mom=0 ef0=0
%const  eref=lmh?-149.6055:-149.1822
%elseifd Fl
%const  vol=7.67^3/4 Z=9 nd0=0 np0=5 mom=0 ef0=0
%const  eref=lmh?-198.9010:-198.4228
%elseifd Na (a0e)
%const  vol=7.964^3/2 Z=11 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-323.9536:-323.3409 bcc=t
%const  rsm1=2.9 rsmd1=2.9 ngd=6
%elseifd Mg (a0e,c0e)
%const  vol=6.008^3*.994/sqrt(2) Z=12 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-399.5824:-398.9159 hcp=t
%elseifd Al (a0e)
%const  vol=7.606^3/4 Z=13 nd0=0 np0=1 mom=0 ef0=0
%const  eref=lmh?-484.2945:-483.5463 fcc=t ngd=8
%const  rsm1=1.8 rsmd1=1.8 ed1=-.01
%var    tp=f
%elseifd Si
%const  vol=7.67^3/4 Z=14 nd0=0 np0=2 mom=0 ef0=0
%const  eref=lmh?-578.53355:-577.69658
%var    tp=f
%elseifd P
%const  vol=7.67^3/4 Z=15 nd0=0 np0=3 mom=0 ef0=0
%const  eref=lmh?-682.6306:-681.7019
%var    tp=f
%elseifd S
%const  vol=7.67^3/4 Z=16 nd0=0 np0=4 mom=0 ef0=0
%const  eref=lmh?-796.7102:-795.7136
%elseifd Cl
%const  vol=7.67^3/4 Z=17 nd0=0 np0=5 mom=0 ef0=0
%const  eref=lmh?-921.3120:-920.2358
%elseifd K (a0e)
%const  vol=9.876^3/2 Z=19 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-1202.3534:-1201.1108 bcc=t
%elseifd Ca (a0e)
%const  vol=10.49^3/4 Z=20 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-1358.6611:-1357.3538 fcc=t
%elseifd Sc (a0e,c0e)  s2d1
%const  vol=6.234^3*.974/sqrt(2) Z=21 nd0=1 np0=0 mom=0 ef0=0
%const  eref=lmh?-1526.0016:-1524.6173 hcp=t
%elseifd Ti (a0e,c0e)  s1d3
%const  vol=5.560^3*.97/sqrt(2) Z=22 nd0=2 np0=0 mom=0 ef0=0
%const  eref=lmh?-1704.9844:-1703.4890 hcp=t
%elseifd V (a0e)    s1d4
%const  vol=5.707^3/2 Z=23 nd0=3 np0=0 mom=0 ef0=0
%const  eref=lmh?-1895.8753:-1894.2951 bcc=t
%elseifd Cr (a0e)   s1d5
%const  vol=5.433^3/2 Z=24 nd0=4 np0=0 mom=1 ef0=0
%const  eref=lmh?-2098.9693:-2097.3033 bcc=t nsp=2 elind=-.5
%const  rsm1=2 rsmd1=1.10 rsm2=1.3 rsmd2=1 ngd=15 gmax=9.5
%char   psta="4.58,4.32,3.70,4.11,5.08" qfa="2 0 7"
#%const corep=-2
%cchar  locorb corep PZ=5.5,3.9,4.5 t 
%elseifd Mn   s2d5 ?
%const  vol=5.2^3/2 Z=25 nd0=5 np0=0 mom=0 ef0=0
%const  eref=lmh?-2314.3248:-2312.6092 bcc=t
%elseifd Fe (a0e)
%const  vol=5.394^3/2 Z=26 nd0=6 np0=0 ef0=0
%const  eref=lmh?-2542.3426:-2540.5681 mom=2.2 bcc=t nsp=2 elind=-.5
%const  rsm1=2 rsmd1=1.05 rsm2=1.3 rsmd2=1 ngd=15 gmax=9.5
%char   psta="4.58,4.32,3.70,4.11,5.08" qfa="2 0 7"
#%const corep=-2
%cchar  locorb corep PZ=5.5,3.9,4.5 t 
%elseifd Co (a0e,c0e)  s2d7  lmh depends sensitively on RMAX
%const  vol=4.711^3*.995/sqrt(2) Z=27 nd0=7 np0=0 ef0=0 mom=1.6
%const  eref=lmh?-2783.53:-2781.6524 hcp=t nsp=2 elind=-.5
#%const corep=-2
%cchar  locorb corep PZ=5.5,3.9,4.5 t 
%const  rsm1=2 rsmd1=1.05 rsm2=1.3 rsmd2=1 ngd=12 gmax=9.5
%char   psta="4.51,4.28,3.76,4.11,5.08" qfa="2 0 7"
%elseifd Ni (a0e)   s1d9
%const  vol=6.621^3/4 Z=28 nd0=8 np0=0 mom=.6 ef0={lmf?1.3:0} nsp=2
%const  eref=lmh?-3038.1050:-3036.1820 fcc=t elind=-.7
%const  rsm1=2 rsmd1=.95 rsm2=1.3 rsmd2=1 ngd=12 gmax=9.5
%char   psta="4.6,4.4,3.8,4.11,5.08" qfa="2 0 8"
%elseifd Cu (a0e) s1d10
%const  vol=6.798^3/4 Z=29 nd0=9 np0=0 mom=0 ef0=0
%const  eref=lmh?-3306.4359:-3304.4345 fcc=t
%ifdef bigbas
%const  rsm1=1.7 rsmd1=1.00 rsm2=1.3 rsmd2=1 ed1=-.01 ngd=12 gmax=9.5
%char   basm="RSMH={rsm1},{rsm1},{rsmd1} EH=-.01,-.01,{ed1}"
%char   basm="{basm} RSMH2=1.7,1.7,1.1 EH2=-1,-1,-1"
%else
%const  rsm1=1.7 rsmd1=1.00 rsm2=1.3 rsmd2=1 ngd=12 gmax=9.5
%endif
%elseifd Zn (a0e,c0e) s2d10
%const  vol=5.018^3*1.12/sqrt(2) Z=30 nd0=10 np0=0 mom=0 ef0=0
%const  eref=lmh?-3588.5895:-3586.5189 hcp=t
%elseifd Ga
%const  vol=7.67^3/4 Z=31 nd0=0 np0=1 mom=0 ef0=0
%const  eref=lmh?-3884.2872:-3882.1256
%elseifd As
%const  vol=7.67^3/4 Z=33 nd0=0 np0=3 mom=0 ef0=0
%const  eref=lmh?-4517.8415:-4515.4714
%elseifd Se
%const  vol=8.24^3*.696/sqrt(2) Z=34 nd0=0 np0=4 mom=0 ef0=0
%const  eref=lmh?-4855.9134:-4853.4670
%elseifd Rb
%const  vol=vol=10.57^3/2 Z=37 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-5957.8443:-5955.1147 bcc=t
%elseifd Sr (a0e) s2
%const  vol=11.43^3/4 Z=38 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-6354.2361:-6351.4281 fcc=t
%elseifd Y (a0e,c0e)
%const  vol=6.886^3*.958/sqrt(2) Z=39 nd0=1 np0=0 mom=0 ef0=0
%const  eref=lmh?-6765.4799:-6762.5727 hcp=t
%elseifd Zr (a0e,c0e) s1d3
%const  vol=6.106^3*.974/sqrt(2) Z=40 nd0=2 np0=0 mom=0 ef0=0
%const  eref=lmh?-7192.0796:-7189.0263 hcp=t
%elseifd Nb (a0e)
%const  vol=6.222^3/2 Z=41 nd0=3 np0=0 mom=0 ef0=0
%const  eref=lmh?-7634.2494:-7631.0823 bcc=t
%elseifd Mo (a0e) s1d5
%const  vol=5.937^3/2 Z=42 nd0=4 np0=0 mom=0 ef0=0
%const  eref=lmh?-8092.2041:-8088.9209 bcc=t
%elseifd Tc
%const  vol=5.18^3*.982/sqrt(2) Z=43 nd0=5 np0=0 ef0=0 mom=0
%const  eref=lmh?-8565.9731:-8562.5418 hcp=t
%elseifd Ru (a0e,c0e)
%const  vol=5.106^3*.968/sqrt(2) Z=44 nd0=6 np0=0 ef0=0 mom=0
%const  eref=lmh?-9055.8738:-9052.4204 hcp=t
%elseifd Rh (a0e)
%const  vol=7.169^3/4 Z=45 nd0=7 np0=0 ef0=0 mom=0
%const  eref=lmh?-9562.3473:-9558.7907 fcc=t
%elseifd Pd (a0e) s1d8
%const  vol=7.327^3/4 Z=46 nd0=8 np0=0 ef0=0 mom=0
%const  eref=lmh?-10085.5577:-10081.8924 fcc=t
%elseifd Ag (a0e) s1d10
%const  vol=7.674^3/4 Z=47 nd0=9 np0=0 ef0=0 mom=0
%const  eref=lmh?-10625.7667:-10621.9685 fcc=t elind=-.7 ngd=15
%elseifd Cd (a0e,c0e)
%const  vol=5.603^3*1.14/sqrt(2) Z=48 nd0=10 np0=0 mom=0 ef0=0
%const  eref=lmh?-11182.7667:-11178.8931 hcp=t
%elseifd In 2s1p
%const  abct=6.13 cbct=9.33 vol=abct^2*cbct/2 Z=49
%const  eref=lmh?-11756.5524:-11752.5630 nd0=0 np0=1 mom=0 ef0=0 bct=t
%elseifd Sn 2s2p
%const  vol=12.24^3/4/2 Z=50 nd0=0 np0=2 mom=0 ef0=0
%const  eref=lmh?-12347.5389:-12343.4222
%elseifd Te 2s4p
%const  vol=8.41^3*.814/sqrt(2) Z=52 nd0=0 np0=4 mom=0 ef0=0
%const  eref=lmh?-13581.7015:-13577.3544
%elseifd Cs
%const  vol=vol=11.43^3/2 Z=55 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-15565.9590:-15561.2527 bcc=t
%elseifd Ba (a0e)
%const  vol=9.433^3/2 Z=56 nd0=0 np0=0 mom=0 ef0=0
%const  eref=lmh?-16262.9903:-16258.1782 bcc=t
%elseifd La s2d1
%const  vol=7.09^3*.991/sqrt(2) Z=57 nd0=1 np0=0 mom=0 ef0=0
%const  eref=lmh?-16978.2357:-16973.2948 hcp=t
%elseifd Haf (a0e,c0e) s2d2
%const  vol=6.03^3*.968/sqrt(2) Z=72 nd0=2 np0=0 mom=0 ef0=0
%const  eref=lmh?-30144.5720:-30137.6046 hcp=t
%elseifd Ta (a0e)
%const  vol=6.226^3/2 Z=73 nd0=3 np0=0 mom=0 ef0={lmf?1.8:0}
%const  eref=lmh?-31197.1092:-31189.9017 bcc=t
#%const  rsm1=2.2 rsm2=1.4
%const  rsm1=1.2 rsm2=1.2
%char   psta="6.5,6.3,5.7,5.11,5.08" qfa="2 0 3"
%elseifd W (a0e)
%const  vol=5.966^3/2 Z=74 nd0=4 np0=0 mom=0 ef0=0
%const  eref=lmh?-32272.8772:-32265.5134 bcc=t
%elseifd Re (a0e,c0e)
%const  vol=5.209^3*.989/sqrt(2) Z=75 nd0=5 np0=0 mom=0 ef0=0
%const  eref=lmh?-33371.9218:-33364.4264 hcp=t
%elseifd Os (a0e,c0e) s2d6
%const  vol=5.163^3*.966/sqrt(2) Z=76 nd0=6 np0=0 mom=0 ef0=0
%const  eref=lmh?-34494.8876:-34487.2370 hcp=t
%elseifd Ir (a0e) s1d8
%const  vol=7.239^3/4 Z=77 nd0=7 np0=0 ef0=0 mom=0
%const  eref=lmh?-35641.9213:-35634.0931 fcc=t
%elseifd Pt (a0e) s1d9
%const  vol=7.381^3/4 Z=78 nd0=8 np0=0 ef0=0 mom=0
%const  eref=lmh?-36813.4896:-36805.4789 fcc=t
%elseifd Au (a0e) s1d10
%const  vol=7.66^3/4 Z=79 nd0=9 np0=0 ef0=0 mom=0 gmax=9.5
%const  eref=lmh?-38009.8780:-38001.6756 fcc=t
%const  rsm1=1.9 rsmd1=1.10 ed1=-.01 ngd=15 elind=-.8
%ifdef bigbas
%char   basm="RSMH={rsm1},{rsm1},{rsmd1} EH=-.01,-.01,{ed1}"
%char   basm="{basm} RSMH2=1.9,1.9,1.1,1.9*0 EH2=-1,-1,-1,{ed1}"
%endif
%elseifd Hg s2d10
%const  vol=7.71^3/4 Z=80 nd0=10 np0=0 ef0=0 mom=0
%const  eref=lmh?-39231.2340:-39222.8479
%elseifd Tl s2p1d10
%const  vol=6.486^3*.977/sqrt(2) Z=81 nd0=10 np0=1 ef0=0 mom=0 hcp=t
%const  eref=lmh?-40477.3968:-40468.8134
%elseifd Pb (a0e)
%const  vol=9.263^3/4 Z=82 nd0=10 np0=2 ef0=0 mom=0
%const  eref=lmh?0:0
%else
%stop 1 stop 1 'no element defined'
%endif
# ...these are lmf defaults
%const  bigbas=0 rsm1=1.5 rsmd1=rsm1 ed1=-.01 rsm2=rsm1 rsmd2=rsmd1 e2=-1 rsm3=rsm1 ngd=20
%const  nl=asa?3:5 lmxa=4 rsma=0 kmx=4 lfoca=1 elind=-1 gmax=0 met=lmf?2:1 frzwf=f
%const  afcc=(4*vol)^(1/3) abcc=(2*vol)^(1/3) ahcp=(vol*sqrt(2))^(1/3) abct=abcc

VERS    LMFP-5.0 LMASA-6 LMF-6 LMF-6 LM:7 ASA:7
% ifdef gmax
HAM     GMAX={gmax}  FORCES={hf==f} XCFUN={xcf} ELIND={elind} TOL=1d-5 QASA=0
        NSPIN={nsp} REL=t 
% endif
#HAM     FTMESH=15,15,200 FORCES={hf==f} XCFUN={xcf} ELIND={elind} TOL=1d-5 QASA=0
        NSPIN={nsp} REL=t FRZWF={frzwf}
HAM     FTMESH=15,15,240+30 FORCES={hf==f} XCFUN={xcf} ELIND={elind} TOL=1d-5 QASA=0
        NSPIN={nsp} REL=t FRZWF={frzwf}
HAM     FTMESH=15,15,180 FORCES={hf==f} XCFUN={xcf} ELIND={elind} TOL=1d-5 QASA=0
        NSPIN={nsp} REL=t FRZWF={frzwf}
HAM     FTMESH=18,18,42 FORCES={hf==f} XCFUN={xcf} ELIND={elind} TOL=1d-5 QASA=0
        NSPIN={nsp} REL=t FRZWF={frzwf}
HAM     FTMESH={ngd} FORCES={hf==f} XCFUN={xcf} ELIND={elind} QASA=0
        NSPIN={nsp} REL=t FRZWF={frzwf}
% ifdef mapj==3
MAP   F *: 2: 2,-1 \h\t:\{job-1} \h\t:\{job-2}
% elseifd mapj==2
MAP   F *: \h\t:\{job-1}
% elseifd mapj==1
MAP   F *: \h\t:\{job}
% endif
% ifdef lmh
MAP     F *:  \h\t:lmh
% endif
MAP     F *:  \h\t:g
MAP     F *:  3:  1 -1 1  \h\t \h\t:1 \h\t:2
IO      SHOW=f HELP=F VERBOS=31 20 WKP=F IACTIV={nit==0}
... Note: need put mom in master to use this!
SOLVE   SMODE=0 TOL=0.001 H=0.05 EEPS=0.00001 LQ1=T IPM=5
        VAR=mom

Elt  alat  rc*  ns*     Efree      E(0,2)  E(rc*,ns*)  E(sc)  expt  ASA

% const strx=t hcp=f fcc=f bcc=f bct=f
%ifndef (asa|lmf)
MASTER  a={fcc?afcc:(bcc?abcc:(hcp?ahcp:abct))} job=5
%if strx
        JOB  1  alatj=a*{scale}^(5-job)
        JOB  2  alatj=a*{scale}^(5-job)
        JOB  3  alatj=a*{scale}^(5-job)
        JOB  4  alatj=a*{scale}^(5-job)
        JOB  5  alatj=a*{scale}^(5-job)
        JOB  6  alatj=a*{scale}^(5-job)
        JOB  7  alatj=a*{scale}^(5-job)
        JOB  8  alatj=a*{scale}^(5-job)
        JOB  9  alatj=a*{scale}^(5-job)

        JOB  11 tet=.96
        JOB  12 tet=.97
        JOB  13 tet=.98
        JOB  14 tet=.99
        JOB  15 tet=1.00
        JOB  16 tet=1.01
        JOB  17 tet=1.02
        JOB  18 tet=1.03
        JOB  19 tet=1.04
        JOB  20 tet=1.05
        JOB  21 tet=1.06
        JOB  22 tet=1.07
        JOB  23 tet=1.08
        JOB  24 tet=1.09
        JOB  25 tet=1.10
        JOB  26 tet=1.11
        JOB  27 tet=1.12
        JOB  28 tet=1.13
        JOB  29 tet=1.14

        JOB  31 trig=1-.04*2/3
        JOB  32 trig=1-.03*2/3
        JOB  33 trig=1-.02*2/3
        JOB  34 trig=1-.01*2/3
        JOB  35 trig=1
        JOB  36 trig=1+.01*2/3
        JOB  37 trig=1+.02*2/3
        JOB  38 trig=1+.03*2/3
        JOB  39 trig=1+.04*2/3
%endif
%ifdef harris
        JOB   1   rc=3.5
        JOB   2   rc=4
        JOB   3   rc=4.5
        JOB   4   rc=5
        JOB   5   rc=5.5
        JOB   6   rc=6
        JOB   7   rc=20

        JOB  11   ns=1.8  nd=nd0+2-ns
        JOB  12   ns=1.9  nd=nd0+2-ns
        JOB  13   ns=2    nd=nd0+2-ns
        JOB  14   ns=2.1  nd=nd0+2-ns
        JOB  15   ns=2.2  nd=nd0+2-ns
        JOB  16   ns=2.3  nd=nd0+2-ns
        JOB  17   ns=2.4  nd=nd0+2-ns
        JOB  18   ns=2.5  nd=nd0+2-ns

        JOB  21   ns=1.8/2 np=ns  nd=nd0+2-ns-np
        JOB  22   ns=1.9/2 np=ns  nd=nd0+2-ns-np
        JOB  23   ns=2.0/2 np=ns  nd=nd0+2-ns-np
        JOB  24   ns=2.1/2 np=ns  nd=nd0+2-ns-np
        JOB  25   ns=2.2/2 np=ns  nd=nd0+2-ns-np
        JOB  26   ns=2.3/2 np=ns  nd=nd0+2-ns-np
        JOB  27   ns=2.4/2 np=ns  nd=nd0+2-ns-np
        JOB  28   ns=2.5/2 np=ns  nd=nd0+2-ns-np
        JOB  29   ns=2.6/2 np=ns  nd=nd0+2-ns-np
%endif
%endif

% cchar strn twoc==0 p3
GF      MODE={exc} GFOPTS={strn}
PGF     MODE={pgf} PLATL=1/sqrt(2) 1/sqrt(6) 1/sqrt(3) PLATR=1/sqrt(2) 1/sqrt(6) 1/sqrt(3)
        SPARSE={sparse} GFOPTS={?~twoc==0~p3~};padtol=.01;{?;nclead;nclead;};{?;declead;declead;} #;refinegs=1d-12
GW      NKABC=nkgw GCUTB=2.7 GCUTX=2.2
STR     RMAX=2.7
STR     RMAX=4.1 MODE=10
CONST   rc=0 nk=16 nk2=nk tet=1 bzj={fcc?1:bcc?4:0} mom={mom} cbya=sqrt(8/3) nkgw=8
% ifdef Li | Na | K | Rb | Cs
        ns=1 nd=0
% endif
% ifdef ns
        ns={ns}
% endif
        lmxb={Z>=46?321:221} ns=2 np={np0} nd={nd0}+2+{np0}-ns-np
        a={fcc?afcc:(bcc?abcc:(hcp?ahcp:abct))}

# --- Structural and site information --- 
# Use -vfile=t if you want information supplied by the site file.
# To use this option,  you must:
#   1. tailor the const declarations below a,avw,rw
#   2. If there is a second atom B, tailor the SPEC group for it.
%ifdef file
# For fcc, use avw=(3/pi/16)^(1/3)*a rw=.9
% const a=afcc avw=(3/pi/16)^(1/3)*a rw=.9 nk=4 nl=3
% echo a={a}, avw={avw}
STRUC   FILE=site NL={nl} NSPEC=2 ALAT={a} DALAT={da} 
        SHEAR=0 0 1 tet
SITE    FILE=site
SYMGRP  find
SPEC
% ifdef sclwsr
        SCLWSR=1 OMAX1=.04 WSRMAX=3.30
% endif
        ATOM=A Z={Z} R={rw*avw} LMXB=lmxb LMXF={lmxf} EREF={eref} A={lmh?.015:.025}
        MMOM=0 0 mom
        CSTRMX=1
%ifdef lmf
        LMXA={lmxa} RSMA={rsma} KMXA={kmx}
%ifdef basm
        {basm}
%else
        RSMH={rsm1},{rsm1},{rsmd1} EH=-.01,-.01,{ed1}
%       ifdef bigbas
        RSMH2={rsm2},{rsm2},{rsmd2},{rsm2} EH2={e2},{e2},{e2},-.01
%       endif
%endif
%endif

# this is afm counterpart to A
#         ATOM=B Z={Z} R={rw*avw} LMXB=lmxb LMXF={lmxf} EREF={eref} A={lmh?.015:.025}
#         MMOM=0 0 -mom
#         CSTRMX=1
# %ifdef lmf
#         LMXA={lmxa} RSMA={rsma} KMXA={kmx}
# %ifdef basm
#         {basm}
# %else
#         RSMH={rsm1},{rsm1},{rsmd1} EH=-.01,-.01,{ed1}
# %       ifdef bigbas
#         RSMH2={rsm2},{rsm2},{rsmd2},{rsm2} EH2={e2},{e2},{e2},-.01
# %       endif
# %endif
# %endif
#

# this is for Cu
% const erefcu=-3304.4345
        ATOM=B Z=29 R={rwcu*avw} LMXB=lmxb LMXF={lmxf} EREF={erefcu} A={lmh?.015:.025}
        MMOM=0 0 mom
        CSTRMX=1
%ifdef lmf
        LMXA={lmxa} RSMA={rsma} KMXA={kmx}
        RSMH={1.7},{1.7},{1.0} EH=-.01,-.01,{-.1}
%ifdef bigbas
        RSMH2=0,2,1.1 EH2=-1,-1,-1
%endif
%endif

# this is for Carbon
# % const Zb=6 rwb=.5
# % char basb="RSMH=1.2,.90,1.2 EH=-.5,-.1,-.1"
#         ATOM=B Z={Zb} R={rwb*avw} LMXB=lmxb LMXF={lmxf} A={lmh?.015:.025}
# %ifdef lmf
#         LMXA={lmxa} RSMA={rsma} KMXA={kmx}
# %ifdef basb
#         {basb}
# %      endif
# %endif

%endif

STRUC   NBAS={hcp?2:1} NSPEC=1 NL={nl} EBAS=-.01 -1 -2 TET=tet
#        ROT=(1,-b1,0)acos(1/sqrt(3))
%ifdef f
%elseifd hcp
        ALAT=a DALAT={da} PLAT=1 0 0   1/2 sqrt(3)/2 0   0 0 cbya
%ifdef lmf | asa
SYMGRP  find
% endif
SYMGRP  R6Z:T(.5,1/sqrt(12),cbya/2) MZ MX
%elseifd bct
        ALAT=a DALAT={da} PLAT= -.5  .5  {.5*cbct/abct}
                      .5 -.5  {.5*cbct/abct}
                      .5  .5 -{.5*cbct/abct}
SYMGRP R4Z MZ R2X
%elseifd fcc
        ALAT=a DALAT={da} PLAT=  .0 .5 .5  .5  .0 .5  .5 .5  .0
#              SLAT=  .5 -.5 .0   .5 0 -.5  1 1 1
%elseifd bcc
        ALAT=a DALAT={da} PLAT= -.5 .5 .5  .5 -.5 .5  .5 .5 -.5
% endif
% ifdef stet
SYMGRP  R4Z MX
% elseifd strig
SYMGRP  R3D M(1,-1,0)
% endif
SYMGRP  R3D R4Z MZ

% ifdef zn | cd
% const rw=asa?1:(lmf?.88:.84)
% elseifd stet | strig
% const rw=asa?1:(lmf?.89:(fcc+hcp?.86:.84))
% else
% const rw=asa?1:(lmf?.91:(fcc+hcp?.88:.86))
% endif
CLASS   ATOM=A Z={Z} R/W={rw} LMXB=lmxb LMXF={lmxf} EREF={eref} A={lmh?.015:.025}
        MMOM=0 0 mom
% if Z<=12
        NR=901
% endif
%ifdef lmf
#       BAS: {bigbas+2},0,1,{rsm1},-.1,2,2,{rsmd1},{ed1},1,2,{rsm2},{e2},0,1,{rsm3},-3
        LMXA={lmxa} RSMA={rsma} KMXA={kmx}
#  P={psta} Q={qfa}
%ifdef locorb
       {locorb}
%endif
        RSMG/W=-1*{rw} RFOCA/W=-1*{rw} LFOCA={lfoca}
%ifdef basm
        {basm}
%else
        RSMH={rsm1},{rsm1},{rsmd1} EH=-.01,-.01,{ed1}
%       ifdef bigbas&corep
        RSMH2={rsm2},{rsm2},{rsmd2},{rsm2} EH2={e2},{corep},{e2},-.01
%       elseifd bigbas
        RSMH2={rsm2},{rsm2},{rsmd2},{rsm2} EH2={e2},{e2},{e2},-.01
%       endif
%endif
%endif
SITE    ATOM=A POS= 0 0 0
%if hcp
        ATOM=A POS=1/2  1/2/sqrt(3)  cbya/2
%endif
OPTIONS NSPIN={nsp} REL=t NPAN={tp+1} XCFUN={xcf} XCN={xcn} HF={hf} SCR={scr}
        Q =BAND INVIT=T GRCOR={lmh} LMH={lmh}
        ASA[ CCOR={ccor} TWOC={twoc} GAMMA={gamma} ] SAVVEC={exc>=10}
% ifdef Li | Na | K | Rb | Cs | Ba | Sr
FIT     WVS=1 1  NFIT=2  EFIT=-.2 -1
% endif
FIT     WVS=1 1  NFIT=2  EFIT=-.5 -2
BZ      NKABC=nk nk nk2 BZJOB=bzj W=.002 NPTS=1001 NKABC2=6 JOB2=bzj
        EF0={ef0} DELEF=.1 TETRA=1 DOS={ef0}-1 {ef0}+.5 METAL={met}
% ifdef hf
        NEVMX=-1
% endif
%ifdef exc>=10
        NEVMX=18 EFMAX=10
%endif
        EMESH=15 10 -1 0 .8 .3 INVIT=f NOINV=T
EWALD   AS=2.0 TOL=1D-10 ALAT0=a NKRMX=600 NKDMX=600
%ifdef relax
DYN     MSTAT: 5,t,.001,0,.005 NIT=20
%endif
% cconst pgf==1 beta={scr>1?.5:.02}
% const beta=.6 conve=0 convc=3e-5
ITER    MIX=A1,b={beta},k=4 CONV={conve} CONVC={convc} NIT={nit}
MIX     MODE=A1,b={beta},k=4 CONV={conve} CONVC={convc}
# use this one to sometimes mix in elind=0.05
ITER    MIX=A3,b={beta},elind=.3,n=10;A0,b={beta/2},elind=.05,n=1,k=1 NIT={nit}
        CONV={conve} CONVC={convc}
MIX     MODE=A3,b={beta},elind=.3,n=10;A0,b={beta/2},elind=.05,n=1,k=1 
        CONV={conve} CONVC={convc}
ITER    MIX=A3,b={beta} NIT={nit} CONV=.00001 CONVC=.0001
MIX     MODE=A3,b={beta}
        NMIX=2 AMIX=T BETA=.8 CONV=.00001 CONVC=.0001
HARRIS  RHO=T RC=rc WIDTH=1/2.5 RNCHAN=0 0 1 EFIT=-1 -2 -3 -4 -5 -6
# --- START ---
START   CNTROL={nit==0} BEGMOM={nit==0} NIT={nit} FREE=f
%if nsp==1
%ifdef Li | Be
        ATOM=A P=2.63 2.55 3.19 4.11 5.08 6.07 7.06
        Q=ns 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  TPAN=2 1 1
%elseifd Mg
        ATOM=A P=0.73 0.46 0.22 0.11 0.08 .06 .05
        Q=2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  TPAN=1 2 1
%elseifd Al
        ATOM=A P=0.79 0.57 0.24 0.11 0.08 .07 .06
%elseifd Na | K
        ATOM=A P=0.64 0.31 0.24 0.10 0.06 .05 .05
%elseifd Ca
        ATOM=A P=4.68 4.36 3.39 4.11 5.07 6.05 7.05
%elseifd Sc
        ATOM=A P=0.61 0.34 0.58 0.11 0.08 .07 .06
%elseifd Ti
        ATOM=A P=0.57 0.31 0.67 0.11 0.08 .07 .06
%elseifd V
        ATOM=A P=0.52 0.28 0.73 0.11 0.08 .07 .06
%elseifd Cr
        ATOM=A P=0.51 0.28 0.76 0.11 0.08 .07 .06
%elseifd Mn
        ATOM=A P=0.53 0.30 0.80 0.11 0.08 .07 .06
%elseifd Fe
        ATOM=A P=0.58 0.33 0.83 0.11 0.08 .07 .06
%elseifd Co
        ATOM=A P=0.61 0.36 0.85 0.11 0.08 .07 .06
%elseifd Ni
        ATOM=A P=0.61 0.36 0.87 0.11 0.08 .07 .06
%elseifd Cu
        ATOM=A P=4.65 4.39 3.88 4.11 5.08 6.07 7.06
%elseifd Zn
        ATOM=A P=4.77 4.47 3.90 4.11 5.08 6.07 7.06
        Q=2 0 0 0 0 0 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0  TPAN=1 2 1
%elseifd Sr
        ATOM=A P=5.70 5.32 4.42 4.11 5.07 6.05 7.05
%elseifd Y
        ATOM=A P=0.61 0.34 0.58 0.11 0.08 .07 .06
%elseifd Zr
        ATOM=A P=0.54 0.23 0.68 0.11 0.08 .07 .06
%elseifd Nb
        ATOM=A P=0.50 0.22 0.74 0.11 0.08 .07 .06
%elseifd Mo
        ATOM=A P=0.50 0.22 0.77 0.11 0.08 .07 .06
%elseifd Tc
        ATOM=A P=0.52 0.24 0.80 0.11 0.08 .07 .06
%elseifd Ru
        ATOM=A P=0.55 0.27 0.83 0.12 0.08 .07 .06
%elseifd Rh
        ATOM=A P=0.58 0.29 0.86 0.12 0.08 .07 .06
%elseifd Pd
        ATOM=A P=0.60 0.31 0.88 0.11 0.08 .07 .06
%elseifd Ag
        ATOM=A P=0.63 0.33 -0.90 0.11 0.08 .07 .06
%elseifd Cd
        ATOM=A P=5.79 5.45 4.91 4.11 5.08 6.06 7.05
        Q=2 0 0 0 0 0 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0  TPAN=1 2 1
%elseifd In
        ATOM=A P=5.85 5.58 4.92 4.11 5.08 6.06 7.05
        Q=2 0 0 1 0 0 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0  TPAN=1 2 1
%elseifd Te Guess
        ATOM=A  P=0.79 0.57 0.24 0.11 0.08 .07 .06
        Q=2 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  TPAN=0 0 2
%elseifd Cs | Rb
        ATOM=A P=0.79 0.57 0.24 0.11 0.08 .07 .06
        Q=1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  TPAN=2 2 1
        TPAN=2 2 1 1  IDMOD=0 0 0 0
%elseifd Ba
        ATOM=A P=0.68 0.31 0.43 0.11 5.07 6.05 7.05
        TPAN=2 2 1 1  IDMOD=0 0 0 0
%elseifd La
        ATOM=A P=0.48 0.19 0.65 0.11 0.08 .07 .06
        TPAN=2 2 1 1  IDMOD=0 0 0 0
%elseifd Haf
        ATOM=A P=0.65 0.28 0.65 4.93 0.08 .07 .06
        TPAN=2 2 1 1  IDMOD=0 0 0 0
        Q=ns 0 0 np 0 0 nd 0 0 14 0 0 0 0 0 0 0 0 0 0 0
%elseifd Ta
#        ATOM=A P=0.60 0.24 0.72 0.13 0.08 .07 .06
#        TPAN=2 2 1 2  IDMOD=0 0 0 1
        ATOM=A P=0.60 0.24 0.72 4.93 0.08 .07 .06
        TPAN=2 2 1 1  IDMOD=0 0 0 0
        Q=ns 0 0 np 0 0 nd 0 0 14 0 0 0 0 0 0 0 0 0 0 0
%elseifd W
        ATOM=A P=0.59 0.24 0.76 0.15 0.08 .07 .06
        TPAN=2 2 1 2  IDMOD=0 0 0 0
%elseifd Re
        ATOM=A P=0.62 0.27 0.79 0.15 0.08 .07 .06
        TPAN=2 2 1 2  IDMOD=0 0 0 0
%elseifd Os
        ATOM=A P=0.63 0.28 0.82 0.15 0.08 .07 .06
        TPAN=2 2 1 1  IDMOD=0 0 0 0
%elseifd Ir
        ATOM=A P=0.65 0.29 0.85 0.14 0.08 .07 .06
        TPAN=2 2 1 1  IDMOD=0 0 0 0
%elseifd Pt
        ATOM=A P=0.68 0.31 0.87 0.12 0.08 .07 .06
        TPAN=2 2 1 1  IDMOD=0 0 0 0
%elseifd Au | Hg | Tl
        ATOM=A P=0.67 0.34 -0.89 0.11 0.08 .07 .06
        TPAN=2 2 1 1  IDMOD=0 0 0 0
%else
%stop 1 Aborting ... no element defined
%endif
        Q=ns 0 0 np 0 0 nd 0 0 0 0 0 0 0 0 0 0 0 0 0 0  TPAN=2 2 1
%endif  nsp==1
# Generic spin-pol
%ifdef nsp==2&asa
        ATOM=A P=0.51 0.28 0.76  0.51 0.28 0.76 TPAN=0 2 1
        Q=ns==1?1:ns/2 0 0 np 0 0    mom+nd/2 0 0
          ns==1?0:ns/2 0 0  0 0 0   -mom+nd/2 0 0
%endif
%ifdef nsp==2&asa==0
% ifdef Au | Hg | Tl
     ATOM=A P=0.51 0.28 -.9 .11 .08 .07 .06
              0.51 0.28 -.9 .11 .08 .07 .06
% else
     ATOM=A P=0.51 0.28 0.76 .11 .08 .07 .06
              0.51 0.28 0.76 .11 .08 .07 .06
% endif
     Q=ns==1?1:ns/2 0 0 np 0 0 (-mom+nd)/2 0 0 0 0 0 0 0 0 0 0 0 0 0 0
       ns==1?0:ns/2 0 0  0 0 0 (mom+nd)/2  0 0 0 0 0 0 0 0 0 0 0 0 0 0
     TPAN=2 {Z<=10?1:2} 1
%endif
%ifdef asa
% char nam=A
% include q.bulk
%endif
JOB   5
