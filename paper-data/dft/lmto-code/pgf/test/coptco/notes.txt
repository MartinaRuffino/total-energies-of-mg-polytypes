In this test where the Euler angles are rotated by 0, +/- 120 degrees in the plane,
the spin and orbital moments generated by SO coupling should be invariant, apart from a rotation.

The following tests how well the symmetry is kept. 
You need files 'rot', '0' and '120'

1. For 'rot', copy the following into file rot
cos(th) sin(th)    0
-sin(th) cos(th)   0
0         0        1


2. Extract '0  and '120'  from the output of the test run
Extract the spin-and-orbital moments with this emacs macro: 
(Create empty buffer b and start at first site below MAGCPA)

C-SPC			;; set-mark-command
5*C-f			;; forward-char
ESC w			;; kill-ring-save
C-x o			;; other-window
C-y			;; hilit-yank
C-x o			;; other-window
9*C-f			;; forward-char
C-SPC			;; set-mark-command
30*C-f			;; forward-char
ESC w			;; kill-ring-save
C-x o			;; other-window
SPC			;; self-insert-command
C-y			;; hilit-yank
C-x o			;; other-window
C-x C-x			;; exchange-point-and-mark
C-n			;; next-line
C-x C-x			;; exchange-point-and-mark
C-n			;; next-line
C-x C-x			;; exchange-point-and-mark
ESC w			;; kill-ring-save
C-a			;; beginning-of-line
2*C-n			;; next-line
C-x o			;; other-window
SPC			;; self-insert-command
C-y			;; hilit-yank
RET			;; newline
C-x o			;; other-window


3. Make the comparison using, e.g.

mc -ff6.0,12f12.6 '-vth=120*pi/180' rot -a rot 0-24 -a 0 120-24 -a 120 0 -coll 2,3,4 rot -x 0 -coll 5,6,7 rot -x -ccat -1:30 -v2dia -e1 i -tog -ccat -w . 120 -- > 24

4. Compare maximum errors (max value of discrepancy in 3 spin + 3 orbital components) 
   for 12, 24, 48, 64 k-divisions. Error drops approximately as 1/N
mc -f12f12.6 12 -abs -coll 2:7 -max 24 -abs -coll 2:7 -max -ccat 48 -abs -coll 2:7 -max -ccat 64 -abs -coll 2:7 -max -ccat

     nk=12       nk=24       nk=48       nk=64
    0.000028    0.000011    0.000009    0.000002
    0.000019    0.000013    0.000010    0.000005
    0.000022    0.000012    0.000010    0.000007
    0.000020    0.000011    0.000009    0.000006
    0.000029    0.000015    0.000012    0.000009
    0.000013    0.000013    0.000007    0.000002
    0.000057    0.000098    0.000008    0.000013
    0.000019    0.000011    0.000003    0.000006
    0.000023    0.000011    0.000003    0.000003
    0.000009    0.000028    0.000014    0.000007
    0.000035    0.000004    0.000003    0.000003
    0.000018    0.000020    0.000008    0.000007
    0.000009    0.000004    0.000002    0.000002
    0.000016    0.000008    0.000005    0.000003
    0.000008    0.000010    0.000006    0.000002
    0.000008    0.000010    0.000006    0.000002
    0.000016    0.000008    0.000006    0.000002
    0.000009    0.000005    0.000003    0.000002
    0.000018    0.000020    0.000009    0.000008
    0.000035    0.000005    0.000003    0.000002
    0.000010    0.000029    0.000013    0.000007
    0.000022    0.000011    0.000003    0.000003
    0.000019    0.000012    0.000004    0.000006
    0.000057    0.000097    0.000007    0.000013
    0.000013    0.000013    0.000008    0.000001
    0.000029    0.000015    0.000011    0.000010
    0.000020    0.000011    0.000009    0.000006
    0.000022    0.000012    0.000009    0.000007
    0.000020    0.000013    0.000010    0.000004
    0.000028    0.000011    0.000009    0.000003
avg 0.000022    0.000018    0.000007    0.000005
