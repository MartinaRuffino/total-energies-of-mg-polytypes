<!DOCTYPE html><html>

<head>
<title>Optics Package</title>
<style>

/* For hyperlinks */
a:link {color:#FF0000;}      /* unvisited link */
a:link {color:#222288;}      /* unvisited link */
a:visited {color:#228822;}  /* visited link */
a:hover {color:#FF00FF;}  /* mouse over link */
a:active {color:#0000FF;}  /* selected link */
a:link {text-decoration:none;}
a:visited {text-decoration:none;}
a:hover {text-decoration:underline;}
a:active {text-decoration:underline;}

body {
       background-color:#ffffgg;
     }
 h1 {
      color:#880000;
      text-align:center;
      font-size:12px;
    }
 h2 {
      color:#bb3300;
      font-size:120%;
      font-weight:normal;
      font-style:italic;
    }

 h3 {
      color:#2255bb;
      font-size:110%;
      font-weight:normal;
      font-style:italic;
      text-indent: 0.5em;
    }

 h4 {
      color:#000000;
      font-size:100%;
      font-weight:bold;
      text-indent: 1.0em;
    }

 h5 {
      color:#444488;
      font-size:100%;
      font-weight:bold;
      font-style:normal;
      text-indent: 1.5em;
    }

  P {
<!--  font-family:"Times New Roman"; -->
<!--  font-size:12px; -->
<!--  color: red; -->
    }

  q {
      color: red;
    }

  a {
        color: blue;
    }

  tlarge {
       <font-size="+1">
    }

</style>

<!-- Enables the use of latex -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</head>

<h1><B><FONT size="+2">Optics package (v7.10)</FONT></B></h1>

<h2>Purpose</h2>

The optics package enables the computation of the imaginary part of the <i>q</i>&rarr;0 dielectric
response function Im &epsilon;(&omega;), and also the joint
density-of-states, JDOS(&omega;).

The package has been implemented in the ASA and full-potential band codes, <b>lm</b> and
<b>lmf</b>.  It was adapted from a program written by
S. Rashkeev and W. Lambrecht, who in turn adapted it from several
other authors.  Rashkeev and Lambrecht also implemented an nonlinear
optics branch in the ASA, which is available here.  Ben Kaube
implemented the <b>lmf</b> version. 

<P>

The package allows you to calculate one of:

<OL>
<LI> Im &epsilon;(&omega;), without local-field effects

<LI> JDOS(&omega;), the joint DOS between unoccupied conduction band
     states <i>c</i> and occupied valence band states <i>v</i>, <br>
        JDOS = &sum;<sub><i>c</i>,<i>v</i></sub>&delta;(&epsilon;<sub><i>c</i></sub>&minus;&epsilon;<sub><i>v</i></sub>&minus;&omega;). <br>
     In the spin polarized case, <i>c</i> and <i>v</i> belong to the same spin. JDOS(&omega;)
     and Im &epsilon;(&omega;) are very similar; except the
     latter has a matrix element of the momentum operator, whereas
     JDOS does not.  One important difference:  the gradient operator
     has 3 components for <i>xyz</i> polarizations, whereas JDOS has only 1.

<LI> JDOS<sup>+&minus;</sup>(&omega;) the joint DOS between majority-spin
     unoccupied conduction band states <i>c</i> and minority spin occupied
     valence band states <i>v</i> (only relevant for spin polarized
     calculations); alternatively, JDOS<sup>&minus;+</sup>(&omega;).
     JDOS<sup>+&minus;</sup>; is to the transverse spin suspeptiblity as 
     DOS is to Im &epsilon;.

<LI> DOS(&omega;): the usual DOS, <i>D</i>(&omega;) = &sum;<sub><i>i</i></sub>&delta;(&epsilon;<sub><i>i</i></sub>&minus;&omega;).

</OL>

In addition to calculating one of the above, the user may also
decompose whichever quantity (say JDOS for definiteness) in one of
several ways:

<OL>
<LI> by wave number <b>k</b>;

<LI> into individual contributions from (occ,unnoc) pairs

<LI> by both <b>k</b> and (occ,unnoc) pairs

<LI> project out the 
<A href="#Mulliken">Mulliken decomposition</A> to JDOS from a particular orbital, or group of orbitals.

</OL>

<b>lm</b> and <b>lmf</b> differ only in how the optical matrix
elements are calculated: they use the same input system and
call the same optics routines.  Thus the input, output and this
documentation apply to both <b>lm</b> and <b>lmf</b>.


<P>

Several Brillouin zone integration methods are in the package.  The
fastest, but least accurate, is a sampling method (
<A href="tokens.html#OPTICScat"><FONT size="+1"><tt>LTET=0</tt></FONT></A>).
There is a plain tetrahedron integrator (<FONT size="+1"><tt>LTET=1 or LTET=2</tt></FONT> below).
But its applicability is restricted to only a few of the options
listed above).  There is also a sophisticated tetrahedron integration
(<FONT size="+1"><tt>LTET=3</tt></FONT>), adapted from a <i>GW</i>
package.  It is the most memory intensive but offers all the options
available.  Unless you want <i>k</i>-resolved or Mulliken-resolved
output, and you are working with an insulator, <FONT
size="+1"><tt>LTET=1</tt></FONT> is recommended as it takes less
memory, runs faster, and seems to be slightly more accurate than the
<FONT size="+1"><tt>LTET=3</tt></FONT> integrator.

<h2>Doing Optics Calculations</h2>

There is a significant cost to calculate of the dielectric function, even just the bulk Im &epsilon;(&omega;).
This is because the number of (occ,unocc) pairs scales quadratically with system size.
Thus while the cost of a normal band calculation scales as <i>N</i><sup>3</sup>,
the cost to calculate Im &epsilon;(&omega;) scales as <i>N</i><sup>4</sup>, with <i>N</i> 
the number of states in the unit cell.

Moreover, to obtain good resolution in Im &epsilon;(&omega;), you need a rather fine <i>k</i> mesh.

<h3>Input for optics</h3>

The optics takes its input from category <FONT size="+1"><tt>OPTICS</tt></FONT>, documented in
<A href="tokens.html#OPTICScat"><FONT size="+1">tokens.html</FONT></A>.

<h3><A name="Mulliken">Mulliken decomposition</A></h3>

An eigenfunction <i>&psi;</i><sub><i>i</i></sub>(<b>r</b>) 
can be decomposed according to a Mulliken analysis:

<BR>
    &nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp;<i>&psi;</i><sub><i>i</i></sub>(<b>r</b>) =
    &Sigma;<sub><i>lm</i></sub><i>C</i><sub><i>lm</i></sub><sup>(<i>i</i>)</sup>&nbsp;
    &chi;</i><sub><i>lm</i></sub>(<b>r</b>)
<BR>
Coefficients <i>C</i> are the projections of <i>&psi;</i><sub><i>i</i></sub> onto
basis functions &chi;</i><sub><i>lm</i></sub>(<b>r</b>). (Note: index <i>lm</i> applies
only the ASA basis with 1 atom/cell.  When more
than 1 atom is involved <i>lm</i>&rarr;<b>R</b><i>lm</i>; also the <b>lmf</b> basis 
can have more than one radial function per <b>R</b><i>lm</i>).  We can "decompose" the unit norm of 
|&psi;</i><sub><i>i</i></sub>(<b>r</b>)|<sup>2</sup> (which integrates to unity)
into fractional parts
|C</i><sub><i>lm</i></sub><sup>(<i>i</i>)</sup>&nbsp;|<sup>2</sup>,
which must sum to 1 (assuming an orthogonal basis, which isn't the case --- so the
formulas have to be adapted to include the overlap matrix).  This is known as a Mulliken analysis.

<BR><BR>

Inputs for the Mulliken decomposition are not entered in the <FONT size="+1"><tt>ctrl</tt></FONT> file.
Instead you must use command-line arguments <FONT size="+1"><tt>--jdosw</tt></FONT>.  For example:
<pre>
  --jdosw~5,6,8~7,9
</pre>
will project out (by Mulliken projection) only the part of the occupied-state
belonging to orbitals 5,6,8, and the part of the unoccupied-state
eigenfunctions belonging to orbitals 1:4,7,9.  (If the material were Fe with
<i>spd</i> orbitals, 5,6,8 are the t<sub>2g</sub> orbitals and 7,9 are the e<sub>g</sub> orbitals.)
      
The program will generate (in file <FONT size="+1"><tt>jdos.<i>ext</i></tt></FONT>; see below) 
two JDOS: the full JDOS and the projection onto the subset.

<BR><BR> 

You can optionally supply a <i>pair</i> of projections. The second
projection has the same structure as the first; the switch to specify
it is <FONT size="+1"><tt>--jdosw2</tt></FONT>.  Thus:
<pre>
  --jdosw~5,6,8~7,9 --jdosw2~7,9~5,6,8
</pre>
specifies that two channels are to be generated in addition to the total JDOS:
first channel has (occ,unocc) = (5,6,8 and 7,9) as before; 
second channel has (occ,unocc) = (7,9 and 5,6,8).  In the latter
channel the Mulliken projections of valence and conduction states are
interchanged.


<H2><A name="Installation"><FONT size="+1">Installation</FONT></A></H2>

If you are using <FONT size="+1"><tt>configure</tt></FONT>, add switch <FONT size="+1"><tt>--enable-optics</tt></FONT> when invoking it.

<H2><A name="editor"><FONT size="+1">Optics File editor</FONT></A></H2>

Not documented yet; sorry.


<H2><A name="examples">Test cases and Examples</A></H2>

The tests cases both test and illustrate various branches in the optics code.
A fair amount of useful information is printed out when the tests are run,
to help you see what's going on.

<P> For the ASA package there are the following:

<BR><tt>
 &nbsp&nbsp&nbsp;optics/test/test.optics [material]
<BR></tt>
where <FONT size="+1"><tt>material</tt></FONT> is one of: (<FONT size="+1"><tt>ogan fe si mngas sic</tt></FONT>)

<LI> The first three tests calculate Im &epsilon; using two kinds of tetrahedron and sampling integration.

     <BR> In the GaN case (material is <FONT size="+1"><tt>ogan</tt></FONT>) FILBND and EMPBND are demonstrated.

<LI> Test 4 generates joint DOS, resolved by individual bands, using 
     the simple tetrahedron integration.

     <BR> In the Fe case, JDOS is made for the first spin.

<LI> Test 5 generates joint DOS, resolved by individual bands, using
     the advanced tetrahedron integration.

     <BR> In the Fe case, JDOS is made for the second spin.

     Also the JDOS is Mulliken-projected onto two different channels,
     to illustrate which orbitals (t<sub>2g</sub> and e<sub>g</sub>) contribute
     to the JDOS.  Since only two channels can be generated at a time,
     the calculation runs twice so all four combinations, 
 <pre>
       Locc=5,6,8   and Lunocc=5,6,8    Locc=5,6,8   and Lunocc=1:4,7,9;
       Locc=1:4,7,9 and Lunocc=5,6,8    Locc=1:4,7,9 and Lunocc=1:4,7,9
 </pre>
     are generated.
     Moreover, the JDOS is further resolved into (occ,unocc) pairs.

<LI> Test 6 generates JDOS, resolved by <b>k</b>

     <BR> In the Si case, a q vector is specified, so you can see the
     joint DOS between the VBM at the &Gamma; point and the CBM near
     the X point.

<LI> Test 7 generates single DOS, resolved by <b>k</b>

     In the fe case, it also performs a Mulliken projection
     with switches --jdosw~5,6,8 --jdosw2~7,9
     (Note in the DOS case there is only a single kind of orbital, not a pair)
     This test also invokes the <A href="#editor">optics file editor</A>.

<LI> Test 8 generates Im &epsilon; resolved by band pairs, and by <b>k</b> (two separate calculations)

<LI> Test 9 is for nonlinear optics 

</LI>

<BR> For the FP package there are the following tests :
<pre>
  fp/test/test.fp fe      (Im eps and JDOS for a spin polarized case)
  fp/test/test.fp zbgan   (Im eps and JDOS)
</pre>

<IMG ALIGN="LEFT" BORDER="0" SRC="zbganoptics.gif" />

The FP optics package has been little tested so far. One important check of its operation is the
dependence of Im &epsilon; on choice of sphere radii and basis set.  There should be little dependence
provided the basis is well converged.

<P> The figure shows Im &epsilon;(&omega;) for the following conditions:

<OL>

<LI> <FONT size="+1"><tt>bas1</tt></FONT>: the standard test, <FONT size="+1"><tt>fp/test/test.fp zbgan</tt></FONT>,
     It uses the Ga 3d state as valence and the 4d as a local orbital.  The N 3s and 3p states
     are also included as local orbitals.  (The <i>k</i> mesh was increased to 30 divisions to improve resolution).

<LI> <FONT size="+1"><tt>bas2</tt></FONT>: the Ga 4d is valence and the 3d is a local orbital.

<LI> <FONT size="+1"><tt>bas3</tt></FONT>: the Ga 3d is valence; there are no local orbitals.

<LI> <FONT size="+1"><tt>avw=2</tt></FONT>: same basis as <FONT size="+1"><tt>bas1</tt></FONT> but the sphere radii are reduced by 5%.

</OL>

All tests yield nearly identical Im &epsilon;(&omega;).
<FONT size="+1"><tt>bas3</tt></FONT> shows small shifts in peaks, possibly because of loss of precision in the Ga <i>d</i> channel or the N <i>s</i> channel.


