<HTML><HEAD><TITLE>Full-potential program lmf (v7.0) </TITLE><STYLE><!--P{font-size : medium;} --></STYLE></HEAD><BODY bgcolor="#cccccc">
<H1><B><FONT size="+2">Full-potential program lmf (v6.17)</FONT></B></H1>

Program <b>lmf</b> is an all-electron implantation of the local-density approximation,
with a basis consisting of generalized linear muffin tin orbitals, of LAPWs, or
some combination of the two.

<H2><A name="section1"><FONT size="+1">
1.  Overview of the full-potential method
</FONT></A></H2>

<P>

The full-potential program <B>lmf</B> was originally adapted from a program
<B>nfp</B> written by M. Methfessel and M van Schilfgaarde.  The
method is described in some detail in the following reference (click
<A href="nfp-doc.ps">here</A> to view postscript file):
<UL>
M. Methfessel, Mark van Schilfgaarde, and R. A. Casali, ``A
full-potential LMTO method based on smooth Hankel functions,'' in
  <I>Electronic Structure and Physical Properties of Solids: The Uses
  of the LMTO Method</I>, Lecture Notes in Physics
  <B>535</B>. H. Dreysse, ed. (Springer-Verlag, Berlin) 2000.<BR>
</UL>

There is also a <A href="nfp-manual.ps">manual</A>
written for the original 1997 code.  The present code
is a descendant of it with many new features and
with a different <A href="input-file-style.html">input system</A>.
But the underlying mathematical formalism, the novel augmentation method in particular,
is basically the same.

<P> The following features are unique to this method:
<BR>

<A name="smoothH"></A>
<DL>
<DT><STRONG>Smoothed Hankel functions</STRONG>
<DD>
  The envelope functions are smoothed generalizations of Hankel
  functions that found in LMTO programs.  Unlike the normal Hankel
  functions, the smoothed versions -- convolutions of ordinary Hankel
  functions and Gaussian functions --- are regular at the origin.
  They are a significantly better choice of basis than the customary
  LMTO basis set.  However, the smoothing introduces complications
  because the augmentation of a smoothed Hankel function is less
  straightforward than of a normal Hankel.  The envelope functions are
  not screened into a tight-binding representation, as in the
  second-generation and later generation LMTO methods; thus wave
  functions are evaluated by Ewald summation.  A real-space version
  using screened envelope functions is in progress.

<DT><STRONG>Local Orbitals</STRONG>
<DD>
  This package extends the linear method through the use of local
  orbitals.  Augmented methods substitute radial solutions of the
  Schrodinger equation with combinations of partial waves of angular
  quantum number <i>l</i> inside the augmentation region.  Linear
  methods used a fixed radial function (more precisely, pair of
  functions), which has validity over only a certain energy window.
  With local orbitals, a third radial function is added to the basis,
  which greatly extends the energy window over which energy
  eigenvalues can be calculated.  It is necessary, for example, to
  obtain the reliable LDA bandgap in GaAs, as the Ga 3<i>d</i> and
  4<i>d</i> partial waves are both important.  To include local
  orbitals in the basis, see <B><A href="#localorbitals">here</A></B>
  for documentation.
  
<DT><STRONG>Augmented Plane Waves</STRONG>
<DD>

  In July 2008 Takao Kotani added APWs as additional envelope
  functions, which can increase the flexibility of the basis.  One can
  view this package as an extension of a conventional LAPW method,
  enabling through the use of a few MTOs a much faster convergence in
  energy cutoff of APWs.  Alternatively, it can be viewed as an
  extension of the original MTO method, With APWs, a good quality
  basis is easier to construct than it is with a strictly with the MTO
  basis.  Also APWs offer a systematic way of converging the accuracy
  of the combined MTO+APW basis systematic and reliable manner, to
  almost arbitrarily high accuracy.  This is particularly important
  when reliable eigenvalues far above the Fermi level are needed, and
  to check the accuracy of a given MTO basis.   To include APWs
  in the basis, see <B><A href="#apw">here</A></B>
  for documentation.

<DT><STRONG>Augmentation and Representation of the charge density</STRONG>
<DD>

 The charge density representation is unique to this method.  It
 consists of three parts: a smooth density <i>n</i><sub>0</sub>
 carried on a uniform mesh, defined everywhere in space (<i>n</i><sub>0</sub> is not
 augmented, as occurs with conventional augmentation), the true
 density <i>n</i><sub>1</sub> expressed in terms of spherical harmonics
 <I>Y</I><sub>lm</sub> inside each augmentation sphere, and a
 one-center expansion of the smooth density <i>n</i><sub>2</sub>, also
 expanded in terms of harmonics <I>Y</I><sub>lm</sub> inside each
 augmentation sphere.  The total density is expressed as in the
 "threefold representation"
   <i>n</i> = <i>n</i><sub>0</sub> + <i>n</i><sub>1</sub> - <i>n</i><sub>2</sub>.

 This turns out to be an extremely useful way to carry out the
 augmentation procedure.  Quantities converge much more rapidly in the
 <i>l</i>-truncation in the augmentation sphere than occurs in
 conventional augmented wave constructions.  (The analysis is a little
 subtle; see the reference at the start of this document.)

</DL>


<P>The full-potential program builds on the basic package (documented
   in file <B><A href="lmto.html">lmto.html</A></B>) which contains an
   implementation of a tight-binding LMTO program in the Atomic
   Spheres Approximation (ASA), and shares most things in common with
   it, including a number of <B><A href="lmto.html#section3">auxiliary
   programs</A></B> useful to both ASA and this one.  For example,
   both methods are linear augmented-wave methods, and the wave
   functions inside the augmentation spheres are equivalent in the two
   cases.  The reader is strongly advised to review that documentation
   before proceeding with this one.  There are some differences in
   input between the two programs.  A description of tokens available
   to this method are documented in the file <B><A
   href="tokens.html">tokens.html</A></B>; which specifies which
   tokens can and cannot be used with this method.  There is also a
   description of tokens specific to this method located in <A
   href="#section3">Section 3</A>.  See <A
   href="Building_FP_input_file.html">Building_FP_input_file.html</A>
   or <A href="FPtutorial.html">FPtutorial.html</A> for a tutorial
   that helps you build an input file, and explains the output, and <A
   href="ASAtutorial.html">ASAtutorial.html</A> for a corresponding
   tutorial for the ASA programs.

<P>One important difference between the ASA and FP methods is that the
   FP method has no neat parametrization of total density in terms of
   <A href="lmto.html#section3">the ASA energy moments <FONT size="+1"><tt>Q0,Q1,Q2</tt></FONT></A>,
   or the representation of the potential by a few potential
   parameters, as in the ASA (see ASA overview in <B><A
   href="lmto.html">lmto.html</A></B>).  However, the basis within the
   augmentation spheres is defined from the spherical average of the
   potential, just as in the ASA, and the linearization proceeds in
   the same way.  Program <B>lmf</B> uses the same ``<A
   href="lmto.html#pbasp">continuously variable principal quantum
   numbers</A>'' <i>P</i> described to establish a mapping between the
   linearization energy and logarithmic derivative at the MT boundary,
   and to float the linearization energy to band center-of-gravity.
   Thus, the description of <i>P</i> and <FONT size="+1"><tt>IDMOD</tt></FONT> equally apply to the ASA and
   this program.

<P>
A second important difference is that the basis set is more
complicated, and in its current form, the user must choose parameters
defining the basis.  This complication is the most onerous part of the
present method, and there are plans for redesign; but at present is
necessary to treat the interstitial region reliably.  The inputs are
described below; see also <A href="FPoptbas.html">FPoptbas.html</A>
for a tutorial about choosing the basis optimally.  Note also with
the incorporation of the <B><A href="#apw">APW basis</A></B>,
other options are available.

</P>
<H2><A name="programs"></A></H2>
<P> The FP package adds two executable programs to the basic one:
<UL><LI>
 Program <B>lmf</B> is the program used for self-consistent full-potential
 calculations.  It requires a starting density, which it obtains either
 from a binary restart file <FONT size="+1"><tt>rst.<i>ext</i></tt></FONT> (typically generated by a prior
 invocation of <B>lmf</B>) or an (almost) equivalent version  <FONT size="+1"><tt>rsta.<i>ext</i></tt></FONT> in ASCII format,
 from a superposition of free-atom densities (file 
 <FONT size="+1"><tt>atm.<i>ext</i></tt></FONT>), which is created as follows
 <BR> <BR>
  <LI>
 Program <B>lmfa</B> makes each species self-consistent for the free atom and writes
 the local density, plus a fit to the tail beyond the MT radius (fit as a
 linear combination of smooth Hankel functions) to file `atm'.  Also appended to
 file `atm' is a fit to the free-atom wave functions for r>rmt.  In version
 6.9n, this is where the envelope wave functions are specified, and as the
 functions are an excellent choice for a free atom, they are not tailored to
 the solid, and you are encouraged to tinker with the basis (described in
 the next Section) before proceeding to carry out full calculations.
</UL>

<HR>
<H2><A name="section2"><FONT size="+1">
2.  Capabilities of the package
</FONT></A></H2>
<P>

<B>lmf</B> in an implementation of the local-density approximation,
and generates density-of states, and total energy as a part of the
self-consistency cycle.

<P> Other extensions are:

<P> <FONT color="#bb3300"><I>Energy bands</I>.</FONT>
You can run <B>lmf</B> in band mode to generate energy
bands along lines or planes for, generating, e.g. Fermi surfaces.
<I>k</I>-point specifications and invocation is described in 
<B><A href="generating-energy-bands.html">generating-energy-bands.html</A></B>.
Particularly useful are the <A href="ASAtutorial.html#bandweights">color weights.</A>

<P> <FONT color="#bb3300"><I>Partial DOS and Mulliken analysis</I>.</FONT>
<B>lmf</B> can generate partial dos within augmentation spheres, and
construct a Mulliken analysis.  DOS can be resolved by site, by site and
<I>l</I>, or by site and <I>lm</I>.  These options are invoked through
in <A href="generating-density-of-states.html#pdos">command-line switches</A>.  For
illustrations, invoke
<pre>
   fp/test/test.fp co 2
   fp/test/test.fp fe 2
</pre>

<P> <FONT color="#bb3300"><I>Charge density</I>.</FONT>

<B>lmf</B> can generate the charge density (smooth or not, with or
without cores), and the contribution to the density from a selected
window of states.  See <FONT size="+1"><tt>--wden</tt></FONT> and <FONT size="+1"><tt>--window</tt></FONT> in
<B><A href="fp.html#section4">command-line switches</A></B>

<P> <FONT color="#bb3300"><I>Core-level spectroscopy</I>.</FONT>
<B>lmf</B> can generate EELS spectra, which involve matrix elements
between core and valence electrons.  The EELS option is invoked with a <B><A href="fp.html#section4">command-line switches</A></B>
For illustrations, invoke
<pre>
   fp/test/test.fp fe 2
   fp/test/test.fp crn 2
</pre>

<A name="ldaplusuextension"></A>

<P> <FONT color="#bb3300"><I>LDA+U</I>.</FONT>

 The LDA+U functional was built into <B>lmf</B> in v6.15 and later, by
 Walter Lambrecht.  LDA+U needs in addition to the LDA parameters
 <i>U</i> and <i>J</i> for selected orbitals, which are empirical.
 The LDA+U constructs an additional potential for a particular
 <I>l</I> subblock (<I>m</I>=<I>-l</I>..<I>l</I>) from the <I>U</I>
 supplied by the user, and the density-matrix, which is generated by
 <B>lmf</B>.  

 Two modifications must be added to the input, which are described 
 <A href="#ldaplusu">here</A>.

 In a strictly LDA calculation, complete information is carried by the
 density, contained in the restart file, <tt>rst.ext</tt>. In the
 LDA+U case, complete information is carried by  density and
 on-site density matrices, which are contained in file <tt>dmats.ext</tt>.

 An example that illustrates LDA+U method is ErAs, which you can run by
<pre>
   fp/test/test.fp eras
</pre>

ErAs is an interesting case because LDA puts all 4 minority <I>f</I>
electrons in a single extremely narrow band at the Fermi level.  In
LDA+U the minority <I>f</I> is spit into a 4- and 3-manifold; see PRB
67, 035104 (2003).

<P> <FONT color="#bb3300"><I>GW</I>.</FONT>
<B>lmf</B> is designed to work in coordination with a GW package by
T. Kotani (the GW package comes comes separately).  <B>lmf</B> acts
both as a driver for the GW package and also can be used in a
self-consistent GW cycle.  An extra driver <B>lmfgw</B> is compiled
as part of this extensions.  Use of this driver is described in the
<B><A href="gw.html">GW driver documentation</A></B>.  You need the
extension package GW.version.tar.gz.  Also you will need the GW package itself.
For illustrations of the driver invoke
<pre>
   gw/test/test.gw si
   gw/test/test.gw gas
</pre>

<P> <FONT color="#bb3300"><I>Spin-Orbit coupling</I>.</FONT>

<b>lmf</b> solves the scalar Dirac hamiltonian.  The dominant
difference between the full Dirac hamiltonian and the scalar one is the
spin orbit coupling, which can be added as a term <i>&lambda;L&middot;S</i> 
to the scalar Dirac Hamiltonian.  

Starting with v6.15, <B>lmf</B> can add <i>&lambda;L&middot;S</i> 
to the scalar Dirac hamiltonian (courtesy of A. Chantis).  It is
possible to include the full <i>L&middot;S</i>
or just the <i>L<sub>z</sub>&middot;S<sub>z</sub></i> part. Beginning
with v7.9,&nbsp;
<i>L<sub>z</sub>&middot;S<sub>z</sub></i> + (<i>L&middot;S</i>&minus;<i>L<sub>z</sub>&middot;S<sub>z</sub></i>)
can be added where the last term is treated in an approximate manner. 
The approximation turns out to be rather good.  See 
<A href="spin-orbit-coupling.html">here</A> for some description and analysis of all three approximations.
<i>L&middot;S</i> in all three forms can be combined with the
self-energy read by a <A href="gw.html">QS<i>GW</i></A> calculation.
In the
<i>L<sub>z</sub>&middot;S<sub>z</sub></i> and approximate
<i>L&middot;S</i> forms the effect of SO coupling can be passed through to the
<i>GW</i> code, to include its effect on the self-energy.

<P>

Use <A href="tokens.html#HAMcat"><FONT size="+1"><tt>HAM_SO</tt></FONT></A>
to turn on SO coupling. 

For illustrations of all three kinds of approaches, try
<pre>
   fp/test/test.fp felz
   fp/test/test.fp gasls
</pre>


<P> <FONT color="#bb3300"><I>Local orbitals</I>.</FONT> 

 In v6.12 and later, <B><A href="#localorbitals">local
 orbitals</A></B> may be added to the basis set. 
 These orbitals are important when energy bands over a very wide
 energy window are required, when high accuracy is needed for shallow
 (semi)core states, or for energies far above the Fermi energy.
 Examples of the former occur in oxides: bond lengths are small and
 cations with shallow <I>p</I> orbitals extend somewhat beyond the
 augmentation radius. 

<P>

 Local orbitals are presented in one of two flavors.  The first,
 conventional type of local orbital is constructed by solving the
 radial Schrodinger at a different linearization energy than the usual
 valence states, and then subtracting off a particular linear of the
 valence wave function phi and energy derivative phidot such that the
 local orbital's value and slope vanish at the augmentation
 radius. Thus

 <BR> <UL>

   <LI> A local orbital is strictly confined to the augmentation
         sphere, and has no envelope function at all.

   <LI> When taken in linear combination with the valence augmentation
         functions, it can solve the Schrodinger equation exactly for
         linearization the energy chosen (that is, for the spherical
         potential that defines the wave functions).

   <LI> It turns the <I>linear</I> method into a <I>quadratic</I> one.
        Of course, it would be possible, and more accurate, to
        construct a LMTO orbital of a different principal quantum
        number complete with envelope function; however, there is a
        corresponding loss in efficiency because the additional matrix
        elements of the envelope function must be evaluated.

   <LI> for states with energies in the vicinity of the local orbital
        energy, the envelope functions of the regular valence states
        combine with the local orbital to make the interstitial part
        of the wave function. 

</UL>

Example that illustrate local orbitals of this type are
<pre>
   fp/test/test.fp gas
   fp/test/test.fp cu
</pre>
The Ga 3<I>d</I/> semicore the high-lying As 5<I>s</I/> state are
included as local orbitals.  In the Cu case, the high-lying Cu
4<I>d</I/> is included, which is important in GW calculations.

<P>

The second, extended, kind of local orbital can only be used for
semicore states.  Instead of artificially subtracting off some linear
of the phi and phidot to make the orbital vanish at the augmentation
radius, a smooth Hankel tail is attached to the orbital.  The
smoothing of tail is constructed to match as well as possible the
kinetic energy of the semicore state.  This type of orbital has the
advantage that the valence envelope function need not `carry' the tail
of the semicore state.  Its drawback is that more things can "go
wrong," namely it may fail to do a good job of fitting the kinetic
energy.

an example that illustrates the second kind of local orbital is
<pre>
  fp/test/test.fp srtio3 
</pre>
The Sr 4<I>p</I/> and Ti 3<I>p</I/> semicore states are included as
local orbitals.  In the first part of the test, they are included as
local orbitals of the first type; then the last step is recalculated
using local orbitals of the second type.

<A name="floating"></A>
<P> <FONT color="#bb3300"><I>Floating Orbitals</I>.</FONT> 

 In v6.15 and later, 
 <A href="#floatingorbitals">floating orbitals</A> may be added to the basis set.  These orbitals can
 be important when very accurate calculations are needed in open
 systems, e.g. when reliable energy bands are needed for a wide energy
 window.  These orbitals differ from the usual smooth Hankels in that
 they are not centered at an atom.  They are augmented just as the
 other orbitals, but there is no augmentation radius and thus no "head" sphere.

<P> The following illustrate the inclusion of floating orbitals in the basis:

<pre>
   fp/test/test.fp te
   fp/test/test.fp gaslc
</pre>

<A name="pmt"></A>
<P> <FONT color="#bb3300"><I>Augmented Plane Waves</I>.</FONT> 

 Starting with v6.17,
 <A href="#apw">Augmented Plane Waves</A>
 can also be included in the basis.  They play the same role as
 floating orbitals do, but APWs are superior because they are simpler
 to use (there are no parameters and they do not need to be located at
 any particular site), and the control over convergence is more
 systematic.

<P> The following illustrate the inclusion of APWs in the basis:

<pre>
   fp/test/test.fp te
   fp/test/test.fp srtio3
   fp/test/test.fp felz 4
</pre>

<P> <FONT color="#bb3300"><I>Parallel Implementation</I>.</FONT> 

Two separate parallel versions of <B>lmf</B> have been made (courtesy
of A. T. Paxton).  One parallelizes over <I>k</I>-points, and is the
most efficient for scaling; the other parallelizes many points at a
lower level.  Installation is not automatic, however.
See <A href="MPI-instructions-for-lmf">instructions</A> for installation.

<HR>
<H2><A name="section3"><FONT size="+1">
3.  Additional input for the full-potential programs
</FONT></A></H2>
<P>
The full-potential reads from the same input file as the basic package,
documented in <A href="lmto.html">lmto.html</A>. File 
<A href="input-file-style.html ">input-file-style.html</A> describes in
generic terms how the input file is grouped into categories and tokens;
<A href="tokens.html">tokens.html</A> documents tokens shared by both the basic package and this one.
<A href="Building_FP_input_file.html">Building_FP_input_file.html</A>
documents a (nearly) automatic input file generator.
This section documents tokens specific to <B>lmf</B>.

<H2><A name="spec"></A></H2>
<UL>
<LI>Category SPEC (fp extensions; see also
    <A href="tokens.html#SPECcat">SPEC</A> in the token documentation)

<BR><BR>

First, the <A href="tokens.html#SPECcat"> muffin-tin radii</A> should be
taken somewhat smaller than in the ASA.  There is no volume-filling
condition as found in the ASA.  Strictly speaking, there should be no
sphere overlaps, though in practice overlaps up to about 10% seem to
engender minimal error, because of the way the augmented potential is
constructed.  See section on "<A href="lmto.html#section8">Selection of Sphere
Radii</A>" for a discussion of choosing sphere radii and a way to
automatically find good choices for them.

<BR> <BR>
  The most important, and also the most difficult new feature of this
  method has to do with specification of
  <FONT color="#bb3300"><I>basis functions</I></FONT>.
  An envelope function takes the form of a smoothed Hankel function
  (<A href="nfp-doc.ps">convolution of an ordinary Hankel function with a Gaussian</A>).  It is
  specified by a smoothing radius <FONT size="+1"><tt>RSMH</tt></FONT> (the Gaussian width) 
  and the Hankel function energy <FONT size="+1"><tt>EH</tt></FONT>, which governs the asymptotic behavior of the envelope.  Each of
  these may be <I>l</I>-dependent.  
  With a suitable choice of <A href="tokens.html#HAMcat"><FONT size="+1"><tt>AUTOBAS</tt></FONT> tokens</A>

  <B>lmfa</B> will automatically find some reasonable choice for each <I>l</I> and write them to a file
  <FONT size="+1"><tt>basp0.<i>ext</i></tt></FONT>; see
  <A href="Building_FP_input_file.html">Building_FP_input_file.html</A> for a tutorial.

 You are to take what <b>lmfa</b> supplies, but to spend a
 little time tinkering with these parameters to minimize the energy.  The easiest
 way is to run <b>lmf</b> with the <FONT size="+1"><tt>--optbas</tt></FONT> switch, i.e.
 <br>&nbsp&nbsp&nbsp;<FONT size="+1"><tt>lmf --optbas ...</tt></FONT>.<br>
 A somewhat more detailed example, where parameters are optimized
 automatically, can be found in the 
<A href="FPoptbas.html">FPoptbas.html</A> tutorial. <br>

 The following offers some help, for users who want to choose parameters by hand.
 Some rules of thumb:

<OL>
<LI> The total energy is more sensitive to the choice of smoothing radii than
     the energies; usually there is little benefit in optimizing the
     energies.   The main exception to this rule occurs for deep orbitals,
     such as the <I>s</I> orbital on a semiconductor anion.
     <BR>

<LI> For <I>sp</I> orbitals, a good rule of thumb is to use <FONT size="+1"><tt>RSMH</tt></FONT>=2/3 &times;
     muffin-tin radius.  
     <BR>

<LI> Occupied <I>d</I> orbitals are atomic-like and require a small <FONT size="+1"><tt>RSMH</tt></FONT>.  Usually
     the value produced by <B>lmfa</B> is pretty close to the optimum one.
     <BR>

<LI> Assembling the hamiltonian is more efficient when you use the same <FONT size="+1"><tt>RSMH,EH</tt></FONT>
     for consecutive <I>l</I> channels, because it can better vectorize loops.
     However, there is a tradeoff in that the basis set may be poorer when
     it is not tailored.  If only a small energy is gained by splitting <FONT size="+1"><tt>RSMH,EH</tt></FONT>
     for consecutive <I>l's</I>, it is preferable to keep them the same.
</OL>

<H2><A name="floatingorbitals"></A></H2>
<BR> <P> <FONT color="#bb3300"><I>Floating orbitals</I>.</FONT>

To specify a floating orbital, add a new species with atomic number 0
and augmentation radius 0.  No augmentation parameters (<FONT
size="+1"><tt>LMXA,LMXL,</tt></FONT> etc) are used, bu you must also
specify the envelope function.  In the following example
<pre>
 SPEC 
     .. 
     ATOM=X Z=0 R=0 LMX=1 RSMH=1.5,1.5,1.5,1.5 EH=-.3,-.3,-.3,-.3
</pre>

species <FONT size="+1"><tt>X</tt></FONT> is specified as a floating orbital.  Although
parameters <FONT size="+1"><tt>RSMH</tt></FONT> and <FONT size="+1"><tt>EH</tt></FONT> 
are supplied for <I>spdf</I> orbitals, the <FONT size="+1"><tt>LMX=1</tt></FONT> 
token specifies that just <I>s</I> and <I>p</I> functions are to used.

In the <FONT size="+1"><tt>SITE</tt></FONT> category, you specify where to place the orbitals, e.g.
<pre>
 SITE
     .. 
     ATOM=X POS=1/2 1/2 1/2
     ATOM=X POS=3/4 3/4 3/4
</pre>


You can in principle put the floating orbitals anywhere at all.  In
practice, it makes little sense to put them too close to the regular
orbitals or too close to each other: numerical instabilities can
arise if you do so.

For an example that illustrates the floating orbitals, try elemental
Te, which has a very open structure:
<pre>
   fp/test/test.fp te
</pre>
Nine sites with floating sp orbitals are added to the three actual
atoms, increasing the basis from from 39 to 75 orbitals.  The test
shows that addition of the floating orbitals lowers the total energy
by 4 mRy and minimally affects the forces.  (Note that this test also
includes APWs, which in this case offers a more convenient and efficient
method to make the basis complete.)

<H2><A name="localorbitals"></A></H2>
<BR> <P> <FONT color="#bb3300"><I>Local orbitals</I>.</FONT>

 The local orbital is specified with the <FONT
 size="+1"><tt>PZ=</tt></FONT> token, which is its analog of the <A
 href="lmto.html#pbasp"> continuously variable principal quantum
 number <FONT size="+1"><tt>P</tt></FONT></A>.  Conventional local
 orbitals may be used either for semicore or high-lying states.  In
 this case, specify the integer part of <FONT
 size="+1"><tt>PZ</tt></FONT> must either as one less than the integer
 part of <FONT size="+1"><tt>P</tt></FONT> for a semicore state or one
 greater for a high-lying state.  As for the fractional part, it is
 recommended that you specify 0.9 or so for the semicore case; while
 for high-lying states 0.3 or so is reasonable (a larger number
 specifies a higher linearization energy).

  <P> <FONT color="#005500"><I>Extended local orbitals:</I>.</FONT>
  Extended local orbitals have a smooth Hankel envelope attached to
  the radial wave function which spills out into the interstitial.
  The tail is matched value and slope to the radial function, but
  <strong>lmf</strong> will try to vary both <FONT
  size="+1"><tt>RSMH</tt></FONT> and <FONT
  size="+1"><tt>EH</tt></FONT> to match the kinetic energy as well.
  To specify that a semicore local orbital is of the extended type,
  simply add 10 to token <FONT size="+1"><tt>PZ=</tt></FONT>.

  <P> <FONT color="#005500"><I>Hazard for conventional local
  orbitals:</I>.</FONT> Conventional local orbitals applied to
  semicore states must rely on the valence envelope functions for
  representation of these deep states in the interstitial.  Therefore be
  advised to choose the smoothing radius for at least one envelope
  function rather small (typically around 1 or so), with a
  corresponding energy rather negative (typically around -1 or so).

  <P> <FONT color="#005500"><I>Hazard for extended local orbitals:</I>.</FONT> 

  It may happen that <strong>lmf</strong> cannot find any reasonable
  combination of <FONT size="+1"><tt>RSMH</tt></FONT> and <FONT
  size="+1"><tt>EH</tt></FONT> that matches the envelope's value and
  slope to the radial wave functions.  Since this matching condition is required,
  <strong>lmf</strong> stops with a message like
<pre>
    Fit local orbitals to sm hankels, species Sr, rmt=3.1
     l  type    Pnu      Eval        K.E.       Rsm       Eh      Q(r>rmt)    Fit K.E.
    Exit -1 : mtchre : failed to match phi'/phi=-5.127 to envelope, l=1
</pre>
  This usually happens when the fractional part of <FONT
  size="+1"><tt>PZ</tt></FONT> is too large (it was set to 0.98 in
  this case).  The solution is to change the fractional part of <FONT
  size="+1"><tt>PZ</tt></FONT>.  

 <P> <strong>lmf</strong> will try to vary both <FONT size="+1"><tt>RSMH</tt></FONT> and <FONT size="+1"><tt>EH</tt></FONT>
  to match (value,slope,kinetic energy), and it may happen that <strong>lmf</strong> can match the first two but not 
  the kinetic energy of the envelope to the radial wave function.
  This doesn't cause an error but it can reduce the accuracy of the
  orbital.  It is seen in the following output:

<pre>
     l  type    Pnu      Eval        K.E.       Rsm       Eh      Q(r>rmt)    Fit K.E.
     1  low    4.900   -1.708558   -0.923699   1.00000  -0.30708   0.07250   -0.289954*
</pre>

The true and fit K.E. differ.  The solution is again to alter PZ (4.90
in this case).  It is not essential, however.  If <FONT
size="+1"><tt>PZ</tt></FONT> floats in the course of a self-consistent
cycle, <strong>lmf</strong> usually picks a good value for PZ.

<P>

 At present, the <FONT
 size="+1"><tt>P</tt></FONT> with the higher principal quantum number
 is automatically frozen to its input value (that is, <FONT
 size="+1"><tt>P</tt></FONT> is frozen when <FONT
 size="+1"><tt>PZ</tt></FONT> is a semicore orbital, and <FONT
 size="+1"><tt>PZ</tt></FONT> is frozen when it is a high-lying
 orbital).  Thus, only the <FONT size="+1"><tt>P</tt></FONT>
 corresponding to the deepest state is allowed to float (see <A
 href="lmto.html#pbasp"> IDMOD description</A>).

<H2><A name="apw"></A></H2>
<BR> <P> <FONT color="#bb3300"><I>APWs</I>.</FONT> 

It is very simple to add augmented plane waves to the basis.
APW's and smoothed LMTO's can be naturally integrated together;
a basis with both kinds of orbitals is called the "Plane Muffin-Tin" or
<A href="http://link.aps.org/doi/10.1103/PhysRevB.81.125117">PMT basis</A>.

<P>  To include APWs add these tokens to category <FONT size="+1"><tt>HAM</tt></FONT>:
<pre>
        PWMODE=1 PWEMIN=# PWEMAX=#
</pre>


<FONT size="+1"><tt>PWMODE</tt></FONT>=1 tells <b>lmf</b> to include
APWs in the basis (The default is <FONT
size="+1"><tt>PWMODE</tt></FONT>=0 which means no APWs will be
included).  <FONT size="+1"><tt>PWEMAX</tt></FONT> is an energy
cutoff (in Rydbergs): G-vectors whose energy fall below <FONT
size="+1"><tt>PWEMAX</tt></FONT> will be included.  Because MTOs can
also be included, and they already rather accurately describe low-energy states,
it makes sense to include a minimum-energy cutoff as well,
i.e. include APWs that satisfy <FONT size="+1"><tt>PWEMIN < E < PWEMAX
</tt></FONT>.

<P>

There are two further considerations the user should take note of.
First, when many APWs are used, the overlap matrix can become nearly
singular.  When this happens the secular matrix becomes unstable,
which can lead to somewhat wrong or even nonsensical results.  To
protect against this, add to <FONT size="+1"><tt>HAM</tt></FONT> the
following:
<pre>
 OVEPS=#
</pre>

If # is a positive number, <b>lmf</b> will diagonalize the overlap matrix,
and eliminate the subspace which has eigenvalues smaller than #.  This
procedure will largely eliminate these instabilities.  A reasonable
choice is <FONT size="+1"><tt>OVEPS=1E-7</tt></FONT>.

<P>

Second, high-energy APWs oscillate much more rapidly than MTOs do.
That means polynomials of higher order may be needed to augment the envelope
functions.  The order of polynomial cutoff is set by (species-specific) token
<FONT size="+1"><tt>KMXA</tt></FONT> in
the <FONT size="+1"><tt>SPEC</tt></FONT> category. When using  
<FONT size="+1"><tt>PWEMAX</tt></FONT> larger than 3 or 4,
take care that the results are converged wrt
<FONT size="+1"><tt>KMXA</tt></FONT>.  As a rough guide, the
dimensionless integer <FONT size="+1"><tt>KMXA</tt></FONT> should be
approximately as large as <FONT size="+1"><tt>PWEMAX</tt></FONT> is
(in Rydbergs).

<P>

You can see the interplay between MTOs and APWs in the Figure, which
shows the total energy <i>E</i> in SrTiO<sub>3</sub> as a function of the
number of APWs included in the basis. (The upper cutoff corresponds to
<FONT size="+1"><tt>PWEMAX</tt></FONT>=10.) 

<IMG
 WIDTH="361" HEIGHT="312" ALIGN="LEFT" BORDER="0"
 SRC="srtio3.png"
 ALT="\includegraphics[angle=0,width=.65\textwidth,clip]{srtio3.eps}">

<P>

Curve "1" includes just
<i>s</i> and <i>p</i> MT orbitals on the O sites, sufficient for a
crude representation of the valence bands (no orbitals are available
for conduction bands).  Also included are local orbitals to represent
Sr 4<i>p</i> and Ti 3<i>p</i> semicore states, as they are too extended to
be appoximated as core states.  A large number of APWs is need to get a good
total energy:  something like 150 APWs are needed to converge 
<i>E</i> to within about 50 mRy of the converged result.  (Had the O
<i>s</i> and <i>p</i> not been present, many more APWs would have been
required.)  

<P>

Curve "4" corresponds to an extreme tight-binding basis, consisting of
<i>sp</i> orbitals on Sr,
<i>spd</i> orbitals on Ti (the conduction band is mainly Ti <i>d</i>),
and <i>sp</i> orbitals on O.  The total energy of the MTO basis alone
(no APWs) is rather crude --- more than 200 mRy underbound.  However,
only 25 orbitals (plus 6 for the local orbitals) are included in this
basis.  The energy drops rapidly as low-energy APWs are included:
adding about 40 APWs is sufficient to converge <i>E</i> to about 50 mRy.

As more APWs are added,  as more APWs are added, the gain in energy
becomes more gradual; indeed convergence is very slow for large <i>E</i>.

<P>

Curve "5" differs from curve "4" only in that a Sr <i>d</i> orbital
was added.  With the addition of these 5 orbitals, the MTO-only basis
is already rather reasonable.  This would be the smallest acceptable
MTO-basis.  As in the Curve "4" basis, there is initially a rapid gain
in energy as the first few APWs are added, followed by a progressively
slower gain in energy as more APWs are added.  The blue curve close to
Curve "5" uses the same MTO basis, but <FONT
size="+1"><tt>PWEMIN</tt></FONT>=1.  Interestingly, the blue and black
curves almost superimpose on each other.  It means the gain in energy 
seems to depend on the number of APWs, but not details of their shape.

<P>

Curve "6" is a standard LMTO minimum basis: <i>spd</i> orbitals on all
atoms.  Comparing Curve "5" or Curve "6" to Curve "1" shows that the
MTO basis is vastly more efficient than the APW basis in converging
the total energy.  This is true until a minimum basis is reached.
Beyond this point, the gain APWs and more MTOs improve the total
energy with approximately the same efficiency, as the next tests show.


<P>

Curve "8" is a standard LMTO larger basis: <i>spdspd</i> orbitals on
Sr and Ti, and <i>spdsp</i> on O.  Comparing curves "6" and '8" shows
that the efficacy of any one orbital added to to the standard MTO
minimum basis is rather similar in the APW and MTO cases.  Thus,
increasing the MTO basis from 51 to 81 orbitals in the MTO basis
lowers the energy by 33 mRy; adding 33 APWs to the minimum basis
(curve "6") lowers the energy by 36 mRy.  APWs, however, have the
advantage that they are simpler to include.

<P>

Curve "11" enlarges the MTO basis still more, with Sr: <i>spdspd</i>,
Ti: <i>spdspd</i>, O: <i>spdspd</i>.  Also local orbitals are used to
represent the high-lying Ti 4<i>d</i> and O 3<i>s</i> and 3<i>p</i>
states.  For occupied states, these orbitals have little effect,
but they are important for unoccupied states higher than about 2 Ry.

Comparing the last curves, it appears that finally <i>E</i> is at last
converging to an absolute minimum at around -2.760 Ry.  The instabilities
in the overlap matrix mentioned above are largely controlled, but there
is a small uncertainty in the absolute energy on the order of 1 mRy.

It is clear even from inspection of Curve "1", that a pure APW basis
would require an extremely large number of PWs to reach this level of
convergence.

<A name="ldaplusu"></A>
<P> <FONT color="#bb3300"><I>LDA+U</I>.</FONT>

To get started, LDA+U needs in addition to the LDA input two modifications:
<UL>
          Parameters <I>U</I> and <I>J</I> 
<BR>
          Density-matrix, stored in file <FONT size="+1"><tt>dmats.ext</tt></FONT>.
         (In the course of self-consistency, it is made by <B>lmf</B>.)
</UL>

For the first, a line must be added to the input file for each species
that contains
<i>U</i> and <i>J</i>.  Consider the example taken from the ErAs test case:
<pre>
        IDU= 0 0 2 2 UH= 0 0 0.1 0.632 JH= 0 0 0 0.055
</pre>
The IDU token tells <B>lmf</B> that no <I>U</I> is to be added to the
<I>s</I> or <I>p</I> channels, but that a <I>U</I> is to be added to
the <I>d</I> and <I>f</I> channels.  IDU=2 specifies LDA+U functional
style 2; this is the "Fully Localized Limit" described in Liechtenstein, PRB 52,
R5467 (1995)).  IDU=1 specifies the "Around Mean Field" functional (Petukhov, PRB 67,
153106 (2003)).

<I>U</I>=0.1 Ry is included on the
<I>d</I> orbital, and <I>U</I>=0.632 is included on the <I>f</I>
orbital.  Additionally <I>J</I>=0.055 is put on the <I>f</I> orbital.

<P>

The density-matrix is read from and written to a file
<FONT size="+1"><tt>dmats.ext</tt></FONT>.  Two density-matrices (1 for each spin) are written
to this file in a (2<I>l</I>+1) by (2<I>l</I>+1) block for each
<I>l</I> block for which a <I>U</I> is defined.  
<FONT size="+1"><tt>dmats.ext</tt></FONT> is
an ASCII file which you can read, and it's quite useful to interpret
what's going on.  The diagonal parts are the occupation numbers and
are the most important.  Note that the file may be stored in either
spherical harmonics or real harmonics, depending on how 
<FONT size="+1"><tt>SHARM=</tt></FONT> is set in the
<FONT size="+1"><tt>OPTIONS</tt></FONT> category.

<P>

Usually it is too tedious to supply 
<FONT size="+1"><tt>dmats.ext</tt></FONT> itself, especially since you
typically won't know what to choose.  Instead, you can supply an
"occupation numbers" file <FONT size="+1"><tt>occnum.ext</tt></FONT>,
which is a starting guess for the density-matrix (its diagonal part).
<FONT size="+1"><tt>occnum.ext</tt></FONT> has one line of
(2<I>l</I>+1) numbers for the occupation numbers of the first spin,
following by a line with the occupation numbers for the second spin.

In this test:
<pre>
   fp/test/test.fp eras
</pre>

the script assumes a particular starting spin configuration through
the occupation number file <FONT size="+1"><tt>occnum.eras</tt></FONT>
it uses.  Er has 11 <i>f</i> electrons, 7 of which go into the
majority channel and 4 into the minority channel.  There is some
choice in which <i>m</i> states to fill and which to keep empty.  A key point
is that the self-consistent solution you end up with will depend on this
choice.   The
ErAs test uses the following input file for <FONT
size="+1"><tt>occnum.eras</tt></FONT> :
<pre>
  0 0 0 0 0
  0 0 0 0 0
  1 1 1 1 1 1 1
  0 1 1 1 1 0 0
</pre>

The first and second lines are occupation numbers for the majority and
minority <i>d</i> channel; the third corresponds to the majority
<i>f</i> channel where all states are taken to be filled.
The last line corresponds to the minority <i>f</i> channel.  In this case,
<i>m</i>=-2,-1,0,1 are filled and <i>m</i>=-3,2,3 are empty.
As the script notes, different choices of starting occupation numbers
lead to different self-consistent solutions.  The one with the lowest
energy is that which satisfies Hund's rule (<i>m</i>=0,1,2,3 filled
and <i>m</i>=-3,-2,-1 empty).

<P>

The occupation numbers are by default correspond to spherical
harmonic representations of <i>Y</i><sub><i>lm</i></sub>.
If you want to define the occupation numbers in real harmonics, put
<pre>
% real
</pre>
on the first line of <FONT size="+1"><tt>occnum.ext</tt></FONT>.

<P>

Note that in the LDA case, complete information is contained in the
density, stored in file <FONT size="+1"><tt>rst.ext</tt></FONT>.  In
the LDA+U case, complete information is contained in the combination of
<FONT size="+1"><tt>rst.ext</tt></FONT> and <FONT
size="+1"><tt>dmats.ext</tt></FONT>.

<P>

The density-matrix is at present mixed independently of the charge,
with linear mixing.  (This will likely change in future) To do the
mixing there is a special-purpose parameter in the <A href="tokens.html#ITERcat">ITER</A> category

<pre>
  UMIX=# 
</pre>

# is a parameter between 0 and 1.  It plays the same role for the
density-matrix as the <A href="tokens.html#mixing">mixing beta</A> 
plays for the mixing of the regular density.

<P> There is additionally a tolerance parameter

<pre>
  TOLU=#    
</pre>

that tells <B>lmf</B> to stops mixing dmats when its rms change falls
below <FONT size="+1"><tt>TOLU</tt></FONT>.  Usually it's not
necessary, and setting <FONT size="+1"><tt>TOLU</tt></FONT>=0 (or
leaving it out) means it plays no role.

<H2><A name="corehole"></A></H2>
<P> <FONT color="#bb3300"><I>Partially occupied core holes</I>.</FONT> 

Calculations involving partial core hole occupancy are useful in the
context of Slater transition-state theory, which undoes most of the
error in the LDA description of the core hole eigenvalue (see
example J. Phys. Cond. Mat. 12, 729 (2000)).

You specify which orbital in which species is to be treated as a
partially occupied by core by adding a token <tt> C-HOLE= </tt> to the
<tt> SPEC </tt> category.  You also have to specify what the partial
occupation is, which you do with token <tt> C-HOLE= </tt>.  An example
is the N 1<I>s</I> core.  A core hole of 1 electron can be put in by
<pre>
     C-HOLE=1s C-HQ=-1
</pre>
Note the sign of the charge.  The number refers to the excess electron charge.
to put in a hole, use a negative charge.  As an illustration in CrN,
you can run the test case
<pre>
     fp/test/test.fp crn
</pre>

<P> Core holes are also useful as an approximate workaround in the LDA
context to deal with (almost) nonbonding <I>f</I> electrons.  In most
4<I>f</I> systems, the <I>f</I> states get shifted away from the Fermi
level, even though the LDA typically is unable to do this (except for
Gd), because it lacks a nonlocal exchange as in LDA+U.  An approximate
workaround is to treat the 4<I>f</I> electrons as core.

For Gd in particular, the 7 majority states should be filled, while
the 7 minority states empty.  Thus a core hole of -7 is required, but
it is necessary to further specify the spin polarization of the core.
This is accomplished with a second argument.  For the Gd case (4<I>f</I> core, -7
excess electrons, with the core magnetic moment +7),  use
<pre>
    C-HOLE=4f C-HQ=-7,7 
</pre>
As an illustration, try
<pre>
    fp/test/test.fp gdn
</pre>

<H2><A name="rsteditor"></A></H2>
<P> <FONT color="#bb3300"><I>Restart file editor</I>.</FONT> 

Not documented.


<P>
<H2><A name="section4"><FONT size="+1">
4.  Command-line switches
</FONT></A></H2>

See <A href="Command-line-options.html">Command-line-options.html</A>
for a general discussion of command-line switches, and those common
to most programs, and 
<A href="Command-line-options.html#section1lmf">here</A> for those specific to <b>lmf</b>.

<br><br>
<H2><A name="section5"><FONT size="+1">
5. Frequently asked questions
</FONT></A></H2>

<P><i>Q: Running <b>lmf</b>, I faced an error like</I>
<pre>
  Exit -1 problem in locpot -- possibly low LMXA, or orbital mismatch, species Rh
  CPU time:    0.246s   Wall clock    0.286s   10:17:34 23.10.2013        on
</pre>

<i>How can I fix it?</i>

<P>A: Usually this happens because the input conditions have changed
between runing <b>lmfa</b> and <b>lmf</b>.  If for any reason the core
configuration is not consistent with
the <FONT size="+1"><tt>atm</tt></FONT> file (if overlapping atomic
densities) or the <FONT size="+1"><tt>rst</tt></FONT> file this
problem may occur.

<P> Suppose for example, you
have <FONT size="+1"><tt>HAM_AUTOBAS_LOC</tt></FONT> set, which
tells <b>lmf</b> to read information about local orbitals from
<FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>, and also
tells <b>lmfa</b> to identify local orbitals to include in the basis.
What basis information it generates, <b>lmfa</b> puts into 
<FONT size="+1"><tt>basp0.<i>ext</i></tt></FONT> .

<P> Suppose you invoke <b>lmfa</b> and it finds a new local orbital
which wasn't included in the before (e.g. missing from the
<FONT size="+1"><tt>basp<i>.ext</i></tt></FONT>).  If you now include this
local orbital, e.g. copy <FONT size="+1"><tt>basp0.<i>ext</i></tt></FONT> to
<FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>, you are changing the core
configuration which causes problems for <b>lmf</b>.  To fix the problem
run <b>lmfa</b> again with the new conditions (and remove
the <FONT size="+1"><tt>rst</tt></FONT> file if you have one).
See <A href="Building_FP_input_file.html#lmfa2">this tutorial</A> for
an example.

<P>
<I>Q: I want to generate the total </I> DOS (SAVDOS=T, DOS=range) <I>over a specified range.
But <B>lmf</B> automatically resets the range of DOS to cover all the occupied states.
When I do NiO (with deep core), the range is very large. Is there a way to avoid this problem?</I>

<BR>
<BR><I>A</I>: This is a small bug, introduced to avoid problems in the sampling integration algorithm.
Use:
<pre>
  --no-fixef0
</pre>
and the range will not change.

<BR><BR>
<DT><B>Energy Functionals</B>

<BR>
<BR><I>Q: Should the Harris-Foulkes and Hohenberg-Kohn Sham
functionals agree at self-consistency?
</I>
<BR><BR><I>A:</I> Yes.  If they do not, either you have not reached self-consistency, 
or a tolerance is set too loosely in the evaluation of the matrix elements.
A likely culprit is that the mesh of points for the interstitial
integrals is not fine enough.

Here is part of an output where mesh of 14x14x14 divisions were used for
the interstitial density.
<PRE>

 GVLIST: gmax = 4.702 a.u. created 973 vectors of 2744 (35%)
         mesh has 14 x 14 x 14 divisions; length 0.588, 0.588, 0.668
 SGVSYM: 170 symmetry stars found for 973 reciprocal lattice vectors

...

 sugcut:  make orbital-dependent reciprocal vector cutoffs for tol= 1.00E-05
 spec      l    rsm    eh     gmax    last term    cutoff
  Te       0*   1.30  -0.10   5.220    9.30E-05     973*
  Te       1*   1.30  -0.10   5.597    4.36E-04     973*
  Te       2    1.30  -0.10   5.976    2.04E-03     973*
  Te       0*   1.40  -1.00   4.847    2.11E-05     973*
  Te       1    1.40  -1.00   5.182    9.90E-05     973*
  E        0*   1.50  -0.30   4.524    1.06E-05     847 
  E        1    1.50  -0.30   4.823    2.01E-05     973*
</PRE>

The table reflects how well each of the basis orbitals is converged in
a PW expansion, which is used to make matrix elements of the
interstitial potential.  Only the E <I>s</I> orbital is converged
below the specified tolerance (10<sup>-5</sup> ).  Convergence in the
Te <I>d</I> orbital is particularly poor; however, the Te <I>d</I> is
only minimally part of the bonding, and its poor convergence doesn't
affect the energy much.  In this case (3 Te atoms), the HF and HK
total energies differ by ~10<sup>-4</sup> Ry.  Below is a table
showing the convergence in HF energy as a function of the number of
divisions, and also the difference between HK and HF energies.
<PRE>
  n       ehf         ehf-ehk
  14 -14561.140624    0.000089
  15 -14561.133966    0.000017
  16 -14561.132309    0.000005
  20 -14561.131170    0.000000

</PRE>

<BR>
<BR><I>Q: What does this mean?</I>
<PRE>
   Exit -1 ICLBSJ: sought atom no. 1 in class 7 but only 0 atoms exist
</PRE>
<I>A:</I> Usually it means that there is an improper
synchronization between site and species data. (e.g. species are
defined that have no corresponding sites)

<BR><BR>
<DT><B>Questions about symmetry operations</B>
<BR>
<BR><I>Q: Strangely enough, <B>lmf</B> already calculates bands in bndfp and then when
making output density it runs into this problem with symprj:
</I>
<PRE>    Exit -1 symprj: no site mapped into first under op # </PRE>
<I>
Why does it not detect this problem earlier?
</I>
<BR>
<BR><I>A:</I> <B>lmf</B> has to symmetrize the output density by rotating all densities of
the same class into one site, averaging them, and restoring the
average densities by inverse rotations into each site of the class.
Until that point <B>lmf</B> doesn't need any information about classes.  This
happens when symmetry operations are specified that are incompatible
with the lattice, and should not occur if the program specifies the
symmetry operations automatically.
<BR>
<BR><I>Q:</I> what is tol in the following output line
<PRE>    SYMCRY: crystal invariant under 8 symmetry operations for tol=1e-5</PRE>
and can it be set somewhere to control how symmetry routines work?
<BR>
<BR><I>A:</I> tol is the fuzz the symmetry finder allows determine
what atom positions are related by symmetry.  You can tell <B>lmf</B> (or
other programs) to adjust the positions that are nearly coincident
under symmetry operations, but are not, by the command-line argument
<PRE>    --fixpos:# </PRE>
where # is the tolerance you specify for sites being `close enough' to
coincident.

