<!DOCTYPE html><html>
<head>
<title>Tokens (v7.11) </title>
<style>

/* For hyperlinks */
a:link {color:#FF0000;}      /* unvisited link */
a:link {color:#222288;}      /* unvisited link */
a:visited {color:#228822;}  /* visited link */
a:hover {color:#FF00FF;}  /* mouse over link */
a:active {color:#0000FF;}  /* selected link */
a:link {text-decoration:none;}
a:visited {text-decoration:none;}
a:hover {text-decoration:underline;}
a:active {text-decoration:underline;}

div {
padding-top: 5px;
padding-bottom: 5px;
padding-right: 5px;
padding-left: 30px;
border: 3px solid;
}
body {
       background-color:#ffffgg;
     }
 h1 {
      color:#880000;
      text-align:center;
      font-size:12px;
    }
 h2 {
      color:#bb3300;
      font-size:120%;
      font-weight:normal;
      font-style:italic;
    }

 h3 {
      color:#33bb00;
      font-size:110%;
      font-weight:normal;
      font-style:italic;
      text-indent: 0.5em;
    }

 h4 {
      color:#000000;
      font-size:100%;
      font-weight:bold;
      text-indent: 1.0em;
    }

 h5 {
      color:#444488;
      font-size:100%;
      font-weight:bold;
      font-style:normal;
      text-indent: 1.5em;
    }

 hn {
      color:#000000;
      font-size:100%;
      font-weight:normal;
      font-style:normal;
      text-indent: 1.5em;
    }

  P {
<!--  font-family:"Times New Roman"; -->
<!--  font-size:12px; -->
<!--  color: red; -->
    }

  q {
      color: red;
    }

  a {
        color: blue;
    }

  tlarge {
       <font-size="+1">
    }

  p.pos_left
  {
  position:relative;
  left:-20px;
  }

  p.pos_right
  {
  position:relative;
  left:20px;
  right:520px;
  }

div.ex
{
width:3in;
padding:10px;
border:5px solid gray;
margin:0px;
}

</style>

</head>

<BODY bgcolor="#cccccc">

<H1><B><FONT size="+2">Tokens read by the Input system (v7.11)</FONT></B></H1>

This file documents the <b>categories</b> and <b>tokens</b> all the
LMTO suite use to read data in a common format from input file.
<A href=input-file-style.html>This page</A> explains what categories
and tokens mean, and how the input file is structured.  These tokens
describe what go into the the main input
file, <FONT size="+1"><tt>ctrl.<i>ext</i></tt></FONT>.
(<FONT size="+1"><tt><i>ext</i></tt></FONT> is a string of your
choosing with 8 or fewer characters. Other files associated with the
input file will share the same extension.)

<H3><A name="contents">Contents</A></H3>
<A href=#BZcat>BZ</A><BR>
<A href=#CONSTcat>CONST</A><BR>
<A href=#DYNcat>DYN</A><BR>
<A href=#EWALDcat>EWALD</A><BR>
<A href=#HAMcat>HAM</A><BR>
<A href=#GFcat>GF</A><BR>
<A href=#GWcat>GW</A><BR>
<A href=#HEADERcat>HEADER</A><BR>
<A href=#IOcat>IO</A><BR>
<A href=#ITERcat>ITER</A><BR>
<A href=#OPTICScat>OPTICS</A><BR>
<A href=#OPTIONScat>OPTIONS</A><BR>
<A href=#PGFcat>PGF</A><BR>
<A href=#SITEcat>SITE</A><BR>
<A href=#SPECcat>SPEC</A><BR>
<A href=#STRcat>STR</A><BR>
<A href=#STARTcat>START</A><BR>
<A href=#STRUCcat>STRUC</A><BR>
<A href=#SYMGRPcat>SYMGRP</A><BR>
<A href=#VERScat>VERS</A><BR>

<P><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
The tables below list the input systems' tokens and their function.
Tables are organized by category.

<UL>
<LI> The <b>Arguments</b> column refers to the cast belonging to the token
(`l', `i', `r', and `c' refer to logical, integer, floating-point and character data, respectively)

<LI>  The <b>Program</b> column indicates which programs the token is specific to, if any

<LI>  The <b>Optional</b> column indicates whether the token is optional (Y) or required (N)

<LI>  The <b>Default</b> column indicates the default value, if any

<LI>  The <b>Explanation</b> column describes the token's function.
</UL>

You can also can get this information from the program itself using
<A href="input-file-style.html#inputswitch"><FONT size="+1"><tt>--input</tt></FONT></A>, e.g.
<pre>
  lmfa --input
</pre>

The present document explains the input more fully, but using
<FONT size="+1"><tt>--input</tt></FONT> is the most definitive way to see
what input is expected.  It may occur that some tokens are optional for
one program and required for another, or two programs use the tokens
for separate meanings, that will not be fully explained here.

<!-- TEMPLATE
<TABLE border="1">
  <TBODY>
        <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
    <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

 <TR>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"><PRE> </PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> </TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"></TD>
   </TR>
   </TBODY>
   </TABLE>
 -->

<!-- BZ -->
<H3><A name="BZcat"></A>
<FONT size="+2"><tt>BZ</tt></FONT> category
</H3>

Category <tt>BZ</tt> holds information concerning the numerical
integration of quantities such as energy bands over the Brillouin Zone
(BZ).  The LMTO programs permit both sampling and tetrahedron
integration methods.  Both are described in
<A href="bzintegration.html">bzintegration.html</A>, and the relative
merits of the two different methods are discussed. As implemented both
methods use a uniform, regularly spaced mesh of <i>k</i>-points, which
divides the BZ into microcells as described <A href="bzintegration.html">here</A>.
Normally you specify this mesh by the
number of divisions of each of the three primitive reciprocal lattice
vectors (which are the inverse, transpose of the lattice
vectors <tt>PLAT</tt>); <tt>NKABC</tt> below.

 <p> These tokens are read by programs that make hamiltonians in periodic crystals
   (<b>lmf,lm,lmgf,lmpg,tbe</b>).  Some tokens apply only to codes that make energy bands,
   (<b>lmf,lm,tbe</b>).
<p>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TD bgcolor="e5e1ff"> GETQP </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Read list of <i>k</i>-points from a disk file.  This is a special mode, and
   you normally you would let the program choose its own mesh by specifying the number of divisions (see <FONT size="+1"><tt>NKABC</tt></FONT>).  <br>
   If token is not parsed, the program will attempt to parse <FONT size="+1"><tt>NKABC</tt></FONT>.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> NKABC </TD>
   <TD bgcolor="feffe1"><PRE> 1 to 3 i</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">

   The number of divisions in the three directions of the reciprocal
   lattice vectors. <FONT size="+1"><tt>k</tt></FONT>-points are generated along a uniform mesh
   on each of these axes.  (This is the optimal general purpose quadrature for periodic functions as it integrates
   the largest number of sine and cosine functions exactly for a specified number of points.)

   <br> The parser will attempt to read
   three integers.  If only one number is read, the missing second and
   third entries assume the value of the first.

   <br> Information from <FONT size="+1"><tt>NKABC</tt></FONT>, together with <FONT size="+1"><tt>BZJOB</tt></FONT> below,
   contains specifications equivalent to the widely used "Monkhorst Pack" scheme.
   But it is more transparent and esier to understand.
   The number of <i>k</i>-points in the full BZ is the
   product of these numbers; the number of <i>irreducible</i> <i>k</i>-points
   may be reduced by <A href=#SYMGRPcat>symmetry operations</A>.
   </TR>

   <TD bgcolor="e5e1ff"> PUTQP </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   If <FONT size="+1"><tt>T</tt></FONT>, Write out the list of irreducible <i>k</i>-points to file <FONT size="+1"><tt>qpts</tt></FONT>,
   and the weights for tetrahedron integration if available.
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> BZJOB </TD>
   <TD bgcolor="feffe1"><PRE> 1 to 3 i</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Controls the centering of the <i>k</i>-points in the BZ:<br>
   &nbsp&nbsp&nbsp;0: the mesh is centered so that one point lies at the origin<br>
   &nbsp&nbsp&nbsp;1: points symmetrically straddle the origin<br>

   Three numbers are supplied, corresponding to each of the three
   primitive reciprocal lattice vectors.  As with <FONT size="+1"><tt>NKABC</tt></FONT> if only one
   number is read the missing second and third entries assume the
   value of the first.</TD>

   </TR>

   <TD bgcolor="e5e1ff"> METAL </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
   Specifies how the weights are generated for BZ integration.
   <br> Numerical quadrature is
   used to to accumulate the output density or any BZ-integrated property. <br>
   In <i>insulators</i>, each point in the full BZ gets equal weight;
   in <i>metals</i>, the weights depend on the Fermi level <i>E<sub>F</sub></i>, which must be determined from the eigenvalues.
   There are these possibilities:
          <UL>
          <LI> <i>either</i> the weights for each <i>k</i> are known in advance, as is the case for insulators; <br>
          <LI> <i>or</i> <i>E<sub>F</sub></i> must be determined before BZ integrations are performed (tetrahedron integration).
               <br> In this more difficult case, there are two possibilities:
          <UL>
          <LI> the weight at <i>k</i> does not depend on values of neighboring <i>k</i> (the case for Methfessel-Paxton sampling integration) ;
          <LI> the weight at <i>k</i> does depend on values of neighboring <i>k</i> (tetrahedron integration).
          </UL>
          </UL>

          The first case is easy to handle.  For the latter several strategies have been developed.
          The <FONT size="+1"><tt>METAL</tt></FONT> token accepts the following:

          <br>
          &nbsp&nbsp;&nbsp&nbsp&nbsp;0: System assumed to be an insulator; weights determined <i>a priori</i>.
          <OL>
          <LI>Eigenvectors are written to disk, in which case
            the integration for the charge density can be
            deferred until all the bands are obtained.  This option is available only for the ASA:
            When accumulating just the spherical part of the charge, eigenvector data can be contracted over <i>m</i>, reducing memory demands.

          <LI> Integration weights are read from file <FONT size="+1"><tt>wkp.<i>ext</i></tt></FONT>,
            would have been generated in a prior band pass.  If <FONT size="+1"><tt>wkp.<i>ext</i></tt></FONT>
            is missing or unsuitable, the program will temporarily
            switch to <FONT size="+1"><tt>METAL=3</tt></FONT>.

          <LI> Two band passes are made; the first generates only eigenvalues to determine <i>E<sub>F</sub></i>.
          It is slower than <FONT size="+1"><tt>METAL=2</tt></FONT>, but it is more stable which can be important in difficult cases.

          <LI> Three distinct Fermi levels are assumed and weights
            generated for each.  After <i>E<sub>F</sub></i> is
            determined, the actual weights are calculated by quadratic
            interpolation through the three points.  The three Fermi levels are gradually
            narrowed to a small window around the true <i>E<sub>F</sub></i> in the course of the self-consistency cycle.
            This scheme works for sampling integration where the <i>k</i>-point weights depend on <i>E<sub>F</sub></i> only and not eigenvalues at neighboring <i>k</i>.
            You can also use this scheme in a mixed tetrahedron/sampling method:
            Weights for the band sum are determined by tetrahedron, but the charge density is integrated by sampling.
            It works better than straight sampling because the total energy is variational in the density.

          <LI> like <FONT size="+1"><tt>METAL=3</tt></FONT> in that two passes are made but
            eigenvectors are kept in memory so there is no additional overhead in the first pass.
            This is the recommended mode for <b>lmf</b> unless you are working with a large system
            and need to conserve memory.
        </OL>

        The ASA code <FONT size="+1"><tt>lm</tt></FONT> implements <FONT size="+1"><tt>METAL=0,1,2</tt></FONT>; the FP <FONT size="+1"><tt>lmf</tt></FONT> implements <FONT size="+1"><tt>METAL=0,2,3,4,5</tt></FONT>.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> TETRA </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> T</TD>
   <TD bgcolor="feffe1">
   Selects BZ integration method<br>
          &nbsp&nbsp&nbsp;0: Methfessel-Paxton sampling integration
             Tokens <FONT size="+1"><tt>NPTS, N, W, EF0, DELEF</tt></FONT> (see below) are
             relevant to this integration scheme.<br>
          &nbsp&nbsp&nbsp;1: tetrahedron integration, with Bloechl weights</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> N</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">

   Polynomial order for sampling integration; see
    see Methfessel and Paxton, Phys. Rev. B, 40, 3616 (1989).
   (Not used with tetrahedron integration or for insulators)

   <br>&nbsp&nbsp&nbsp&nbsp;0: integration uses standard gaussian method

   <br>&nbsp&nbsp;>0: integration uses generalized gaussian
          functions, i.e. polynomial of order N * gaussian to
          generate integration weights

   <br>&nbsp&nbsp;&minus;1: use the Fermi function rather than gaussians to broaden the &delta;-function.
          This generates the actual electron (fermi)
          distribution for a finite temperature.

   <br>&nbsp;100: By default, if a gap is found separating occupied and
          occupied states, the program will treat the system as
          and insulator, even when MET>0.  To suppress this, add 100 to <FONT size="+1"><tt>N</tt></FONT>
          (use &minus;101 for Fermi distribution).
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> W</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 5e-3</TD>
   <TD bgcolor="feffe1">

     <UL>
     <LI> Case <FONT size="+1"><tt>BZ_N</tt></FONT>&gt;0 :
          Broadening (Gaussian width) for Gaussian sampling integration (Ry).

     <LI> Case <FONT size="+1"><tt>BZ_N</tt></FONT>&lt;0 :
          temperature, in Ry. (the sampling weights are computed
          from the Fermi function instead of the error function(.
     </UL>
     Not used with tetrahedron integration or for insulators.
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> EF0</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Initial guess at Fermi energy.  Used with <FONT size="+1"><tt>BZ_METAL=4</tt></FONT>.
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> DELEF </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.05</TD>
   <TD bgcolor="feffe1">
   Initial uncertainty in Fermi level for sampling integration.
   Used with <FONT size="+1"><tt>BZ_METAL=4</tt></FONT>.
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> ZBAK</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Homogeneous background charge</TD>
   </TR>

   <TD bgcolor="e5e1ff"> SAVDOS</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   &nbsp&nbsp&nbsp;0 does not save dos on disk<br>
          &nbsp&nbsp&nbsp;1 writes the total density of states on NPTS mesh
            points to disk file <FONT size="+1"><tt>dos.<i>ext</i></tt></FONT>.<br>
          &nbsp&nbsp&nbsp;2 Write weights to disk for partial DOS
            (In the ASA this occurs automatically).<br>
          &nbsp&nbsp&nbsp;4 Same as (2), but write weights <i>m</i>-resolved.
            You may also cause <b>lm</b> or <b>lmf</b> to generate <i>m</i>-resolved dos using
            the --pdos command-line argument. &nbsp&nbsp;
            NB: you must turn OFF all symmetry operations to produce
            correct results.  (The extra inversion symmetry in the
            k-points from time-reversal symmetry is still allowed.)
          <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
          <FONT size="+1"><tt>SAVDOS</tt></FONT>>0 requires <FONT size="+1"><tt>BZ_NPTS</tt></FONT> and <FONT size="+1"><tt>BZ_DOS</tt></FONT> also.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> DOS</TD>
   <TD bgcolor="feffe1"><PRE> 2 r</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> &minus;1,0</TD>
   <TD bgcolor="feffe1">
   Energy window over which DOS accumulated.
          Needed <i>either</i> for sampling integration <i>or</i> if <FONT size="+1"><tt>SAVDOS</tt></FONT>>0.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> NPTS</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1001</TD>
   <TD bgcolor="feffe1">
   Number of points in the density-of-states mesh used in
          conjunction with sampling integration.<br>
          Needed <i>either</i> for sampling integration <i>or</i> if <FONT size="+1"><tt>SAVDOS</tt></FONT>>0.</TD>
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> EFMAX</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 2</TD>
   <TD bgcolor="feffe1">
   Only eigenvectors whose eigenvalues are less than <FONT size="+1"><tt>EFMAX</tt></FONT>
          are computed; this improves execution efficiency.
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> NEVMX</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
       &nbsp&nbsp&nbsp;>0 : Find at most <FONT size="+1"><tt>NEVMX</tt></FONT> eigenvectors<br>
       &nbsp&nbsp&nbsp;=0 : program uses internal default<br>
       &nbsp&nbsp&nbsp;<0 : no eigenvectors are generated (and
                    correspondingly, nothing associated with
                    eigenvectors such as density.)<br>

          <FONT color="#ff3366">Caution: if you want to look and partial DOS well above
          the Fermi level (which comes out around 0), you must
          set EFMAX and NEVMX high enough to encompass the range
          of interest</FONT>.</TD>
   </TR>

   <TD bgcolor="e5e1ff">ZVAL</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Number of electrons to accumulate in BZ integration.
          Normally <tt>zval</tt> is computed by the program.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> NOINV</TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Suppress the automatic addition of the inversion to the
          list of point group operations.  Usually the
          inversion symmetry can be included in the determination of
          the irreducible part of the BZ because of time reversal symmetry.
          There may be cases where this symmetry is broken:
          e.g. when spin-orbit coupling is included or when the (beyond
          LDA) self-energy breaks time-reversal symmetry.  In most cases, the
          program will automatically disable this addition in
          cases that knows the symmetry is broken.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> FSMOM</TD>
   <TD bgcolor="feffe1"><PRE> 2 r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0</TD>
   <TD bgcolor="feffe1">
   Set the global magnetic moment (collinear magnetic case).
          In the fixed-spin moment method, a spin-dependent potential
          shift Beff is added to constrain the total magnetic moment to
          value assigned by FSMOM=.  No constraint is imposed if this
          value is zero (the default).  <BR>
          Optional second arg supplies an initial Beff.
          It is applied whether or not the first argument is 0.
          If arg#1 &ne; 0, Beff is made consistent with it.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> DMAT</TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmgf</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Calculate the density matrix.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> INVIT</TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lm</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Enables inverse iteration generate eigenvectors (this is
          the default). It is more efficient than the QL method,
          but occasionally fails to find all the vectors.  When
          this happens, the program stops with the message:<br>

          &nbsp&nbsp;<tt>DIAGNO: tinvit cannot find all evecs</tt><br>
          If you encounter this message set INVIT=F.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> EMESH</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmgf,lmpg</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 10,0,-1,...</TD>
   <TD bgcolor="feffe1">
     Parameters defining contour integration for Green's function methods.
     <br>Element:
     <OL>
     <LI> number of energy points <FONT size="+1"><tt>nz</tt></FONT>
     <LI> contour type:
     <br>&nbsp;&nbsp;&nbsp;0:  Uniform mesh of <FONT size="+1"><tt>nz</tt></FONT> points: Real part of energy z between <FONT size="+1"><tt>emin</tt></FONT> and <FONT size="+1"><tt>emax</tt></FONT>
     <br>&nbsp;&nbsp;&nbsp;1:  Same as 0, but reverse sign of Im z
     <br>&nbsp;10:             elliptical contour
     <br>&nbsp;11:             same as 10, but reverse sign of Im z
     <br>&nbsp;100s digit used for special modifications
     <br>&nbsp;Add 100 for nonequil part using Im(z)=<FONT size="+1"><tt>delne</tt></FONT>
     <br>&nbsp;Add 200 for nonequil part using Im(z)=<FONT size="+1"><tt>del00</tt></FONT>
     <br>&nbsp;Add 300 for mixed elliptical contour + real axis to find fermi level
     <br>&nbsp;Add 1000 to set nonequil part only.

     <LI> lower bound for energy contour <FONT size="+1"><tt>emin</tt></FONT> (on the real axis)
     <LI> upper bound for energy contour <FONT size="+1"><tt>emax</tt></FONT>, e.g. Fermi level (on the real axis)
     <LI> (elliptical contour) eccentricity: ranges between 0 (circle) and 1 (line)
     <br> (uniform contour)&nbsp; Im z
     <LI> (elliptical contour) bunching parameter <FONT size="+1"><tt>eps</tt></FONT> : ranges between 0 (distributed symmetrically) and 1 (bunched toward emax)
     <br> (uniform contour)&nbsp; not used
     <LI> (nonequilibrium GF, lmpg) nzne = number of points on nonequilibrium contour
     <LI> (nonequilibrium GF, lmpg) vne = difference in fermi energies of right and left leads
     <LI> (nonequilibrium GF, lmpg) delne = Im part of E for nonequilibrium contour
     <LI> (nonequilibrium GF, lmpg) substitutes for delne when making the surface self-energy.
     </OL>

   </TR>

   <TD bgcolor="e5e1ff"> MULL</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Mulliken population analysis.
          Mulliken population analysis is also implemented in
          <b>lmf</b>, but you specify the analysis with a
          command-line argument.</TD>
   </TR>
  </TBODY>
 </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- DYN -->
<H3><A name="DYNcat"></A>
<FONT size="+2"><tt>DYN</tt></FONT> category
</H3>
Contains parameters for molecular statics and dynamics.
<P>
<TABLE border="1">
  <TBODY>
        <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">NIT</TD>
   <TD bgcolor="#feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
           maximum number of relaxation steps (molecular statics)
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">SSTAT[...]</TD>
   <TD bgcolor="#feffe1"><PRE> </PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lm,lmgf</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
           (noncollinear magnetism) parameters specifying how spin statics (rotation of quantization axes to minimize energy) is carried out.
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SSTAT_MODE</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lm,lmgf</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   &nbsp&nbsp&nbsp;0: no spin statics or dynamics<br>
   &nbsp&minus;1: Landau-Gilbert spin dynamics<br>
   &nbsp&nbsp&nbsp;1: spin statics: quantization axis determined by making output density matrix diagonal<br>
   &nbsp&nbsp&nbsp;2: spin statics: size and direction of relaxation determined from spin torque<br>
   &nbsp&nbsp&nbsp;Add  10 to mix angles independently of <FONT size="+1"><tt>P,Q</tt></FONT> (Euler angles are subject to
   <A href=#mixing>mixing</A> to accelerate convergence)<br>
   &nbsp&nbsp&nbsp;Add  1000 to mix Euler angles independently of <FONT size="+1"><tt>P,Q</tt></FONT><br>
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SSTAT_SCALE</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lm,lmgf</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1"> (used with <FONT size="+1"><tt>mode=2</tt></FONT>) scale factor amplifying magnetic forces
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SSTAT_MAXT</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lm,lmgf</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1"> maximum allowed change in angle
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SSTAT_TAU</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lm,lmgf</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1"> (used with <FONT size="+1"><tt>mode=-1</tt></FONT>) time step
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SSTAT_ETOL</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lm,lmgf</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1"> (used with <FONT size="+1"><tt>mode=-1</tt></FONT>)
   Set <FONT size="+1"><tt>tau</tt></FONT>=0 this iter if <FONT size="+1"><tt>etot-ehf>ETOL</tt></FONT>
   </TD>
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">MSTAT[...]</TD>
   <TD bgcolor="#feffe1"><PRE> </PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
           (molecular statics) parameters specifying how site positions are
           relaxed given the internuclear forces
   </TR>

  <TR>
   <TD bgcolor="e5e1ff"> MSTAT_MODE</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   &nbsp&nbsp&nbsp;0: no relaxation<br>
   &nbsp&nbsp&nbsp;4: relax with conjugate gradients algorithm.  (not generally recommended)<br>
   &nbsp&nbsp&nbsp;5: relax with Fletcher-Powell algorithm.  Find minimum along a line; a new line is chosen.  The Hessian matrix is updated only at the start of a new line minimization.  Fletcher-Powell is more stable but usually less efficient than Broyden.<br>
   &nbsp&nbsp&nbsp;6: relax with Broyden algorithm.  This is essentially a Newton-Raphson algorithm, where Hessian matrix and direction of descent are updated each iteration.

</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MSTAT_HESS</TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> T</TD>
   <TD bgcolor="feffe1">
   &nbsp&nbsp&nbsp;<FONT size="+1"><tt>T</tt></FONT>: Read hessian matrix from file, if it exists<br>
   &nbsp&nbsp&nbsp;<FONT size="+1"><tt>F</tt></FONT>: assume initial hessian is the unit matrix</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MSTAT_XTOL</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1e-3</TD>
   <TD bgcolor="feffe1">
   Convergence criterion for change in atomic displacements.<br>
   &nbsp&nbsp&nbsp;&gt;0: criterion satisfied when <FONT size="+1"><tt>xtol</tt></FONT> &gt;  net shift (shifts summed over all sites)<br>
   &nbsp&nbsp&nbsp;&lt;0: criterion satisfied when <FONT size="+1"><tt>xtol</tt></FONT> &gt;  max shift of any site<br>
   &nbsp&nbsp&nbsp;&nbsp;&nbsp;0: Do not use this criterion to check convergence

   <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
   When molecular statics are performed, <i>either</i> <FONT size="+1"><tt>GTOL</tt></FONT> <i>or</i> <FONT size="+1"><tt>XTOL</tt></FONT> <i>must</i> be specified.
   Both may be specified.</TD>
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MSTAT_GTOL</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Convergence criterion for tolerance in forces.<br>
   &nbsp&nbsp&nbsp;&gt;0: criterion satisfied when <FONT size="+1"><tt>gtol</tt></FONT> &gt;  "net" force (forces summed over all sites)<br>
   &nbsp&nbsp&nbsp;&lt;0: criterion satisfied when <FONT size="+1"><tt>xtol</tt></FONT> &gt;  max absolute force at any site<br>
   &nbsp&nbsp&nbsp;&nbsp;&nbsp;0: Do not use this criterion to check convergence

   <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
   When molecular statics are performed, <i>either</i> <FONT size="+1"><tt>GTOL</tt></FONT> <i>or</i> <FONT size="+1"><tt>XTOL</tt></FONT> <i>must</i> be specified.
   Both may be specified.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MSTAT_STEP</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.015</TD>
   <TD bgcolor="feffe1">
   Initial (and maximum) step length</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MSTAT_NKILL</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Remove hessian after <FONT size="+1"><tt>NKILL</tt></FONT> iterations.
   Never remove Hessian if <FONT size="+1"><tt>NKILL=0</tt></FONT>.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">MSTAT_PDEF= </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmf,lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0 0 ...</TD>
   <TD bgcolor="feffe1">
   Lattice deformation modes (not documented)</TD>
   </TR>

 <TR>
   <TD bgcolor="e5e1ff"> MD[...]</TD>
   <TD bgcolor="feffe1"><PRE> </PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Parameters for molecular dynamics</TD>
   </TR>

  <TR>
   <TD bgcolor="e5e1ff"> MD_MODE</TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   &nbsp&nbsp&nbsp;0: no MD<br>
   &nbsp&nbsp&nbsp;1: NVE<br>
   &nbsp&nbsp&nbsp;2: NVT<br>
   &nbsp&nbsp&nbsp;3: NPT</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MD_TSTEP</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 20.671</TD>
   <TD bgcolor="feffe1">
   Time step (a.u.)<br>
   NB: 1 fs = 20.67098 a.u.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MD_TEMP</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.00189999</TD>
   <TD bgcolor="feffe1">
   Temperature (a.u.)<br>
   NB: 1 deg.K = 6.3333e-6 a.u</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MD_TAUP</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 206.71</TD>
   <TD bgcolor="feffe1">
   Thermostat relaxation time (a.u.)</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MD_TIME</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 20671000</TD>
   <TD bgcolor="feffe1">
   Total MD time (a.u.)</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MD_TAUB</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>lmmc,tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 2067.1</TD>
   <TD bgcolor="feffe1">
   Barostat relaxation time (a.u.)</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MD_P</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>tbe</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Target pressure in NpT ensemble (a.u.)</TD>
   </TR>


   </TBODY>
   </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- EWALD -->
<H3><A name="EWALDcat"></A>
<FONT size="+2"><tt>EWALD</tt></FONT> category
</H3>
Category EWALD holds information controlling the Ewald sums for
structure constants entering into, e.g. the Madelung summations and Bloch summed structure constants (<b>lmf</b>).
Most programs use quantities in this category to carry out Ewald sumes (exceptions are <b>lmstr</b> and the molecules codes).
<P>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TD bgcolor="e5e1ff"> AS </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 2</TD>
   <TD bgcolor="feffe1">
   Controls the relative number of lattice vectors in real and reciprocal space.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> TOL</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1e-8</TD>
   <TD bgcolor="feffe1">
   Tolerance in the Ewald sums</TD>
   </TR>

   <TD bgcolor="e5e1ff"> NKDMX </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 800</TD>
   <TD bgcolor="feffe1">
   The maximum number of real-space lattice vectors
          entering into the Ewald sum, used for memory allocation.
          Normally you should not need this token.  Increase
          NKDMX if you encounter an error message like this one:<br>
             &nbsp&nbsp&nbsp;<tt>xlgen: too many vectors, n=...</tt></TD>
   </TR>

   <TD bgcolor="e5e1ff"> RPAD</TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Scale rcutoff by RPAD when lattice vectors padded in oblong geometries</TD>
   </TR>
  </TBODY>
 </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- GF -->
<H3><A name="GFcat"></A>
<FONT size="+2"><tt>GF</tt></FONT> category
</H3>
Category <FONT size="+1"><tt>GF</tt></FONT> is intended for parameters specific to the Green's function code <A href="gf.html">lmgf</A>.
It is read by <b>lmgf</b>.
<P>
 <TABLE border="1">
  <TBODY>
        <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
    <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MODE </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 </TD>
   <TD bgcolor="feffe1">
   &nbsp&nbsp&nbsp; 0: do nothing<br>
   &nbsp&nbsp&nbsp; 1: self-consistent cycle<br>
   &nbsp;     10: Transverse magnetic exchange interactions <i>J</i>(<b>q</b>)<br>
   &nbsp;     11: Read <i>J</i>(<b>q</b>) from disk and analyze results<br>
   &nbsp;     14: Longitudinal exchange interactions<br>
   &nbsp;     20: Transverse &chi;<sup>+&minus;</sup> from ASA Green's function<br>
   &nbsp;     21: Read &chi; from disk and analyze results<br>
   &nbsp;     20: Transverse &chi;<sup>++</sup>, &chi;<sup>&minus;&minus;</sup> from ASA Green's function<br>
   &nbsp; <FONT color="#ff3322"> Caution: modes 14 and higher have not been maintained.
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> GFOPTS </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   ASCII string with switches governing execution of <b>lmgf</b> or <b>lmpg</b>.  Use `<FONT size="+1"><tt>;</tt></FONT>' to separate the switches.
   <br> Available switches:
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>p1</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; First order of potential function
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>p3</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Third order of potential function
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>pz</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exact potential function (some problems; not recommended
     <br>&nbsp;&nbsp;   Use only one of the above; if none are used, the code generates second order potential functions.

     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>idos</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;        integrated DOS (by principal layer in the <b>lmpg</b> case)
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>noidos</tt></FONT>'                              suppress calculation of integrated DOS
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>pdos</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;        accumulate partial DOS
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>emom</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;        accumulate output moments; use '<FONT size="+1"><tt>noemom</tt></FONT>' to suppress
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>noemom</tt></FONT>'      suppresss accumulation of output moments
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>sdmat</tt></FONT>'&nbsp;&nbsp;                   make site density-matrix
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>dmat</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;        make density-matrix
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>frzvc</tt></FONT>'&nbsp;&nbsp;                   do not update potential shift needed to obtain charge neutrality
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>padtol</tt></FONT>'                              Tolerance in Pade correction to charge.  If tolerance exceeded,
     <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                                                              <b>lmgf</b> will repeat the band pass with an updated Fermi level
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>omgtol</tt></FONT>' (CPA) &nbsp;&nbsp; tolerance criterion for convergence in coherent potential
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>omgmix</tt></FONT>' (CPA) &nbsp;&nbsp; linear mixing parameter for iterating convergence in coherent potential
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>nitmax</tt></FONT>' (CPA) &nbsp;&nbsp; maximum number of iterations to iterate for coherent potential
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>lotf</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp; (CPA)
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>dz</tt></FONT>'&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (CPA)
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">DLM </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Governs self-consistency for both chemical CPA and magnetic CPA (disordered local moments).
     <br>&nbsp;&nbsp; 12 : normal CPA/DLM calculation: charge and coherent potential &Omega; both iterated to self-consistency.
     <br>&nbsp;&nbsp; 32 : &Omega; alone is iterated to self-consistency.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">BXY </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   (DLM) Setting this switch to <FONT size="+1"><tt>T</tt></FONT> generates a site-dependent
   constraining field to properly align magnetic moments.
   <br> In this context constraining field is applied by scaling the LDA exchange-correlation field.
   The scaling factor is [1+<FONT size="+1"><tt>bxc</tt></FONT>(<FONT size="+1"><tt>ib</tt></FONT>)<sup>2</sup>]<sup>1/2</sup>.
   <br> A table of <FONT size="+1"><tt>bxc</tt></FONT> is kept for each site in the first column of file <FONT size="+1"><tt>shfac.<i>ext</i></tt></FONT>.
   See also <FONT size="+1"><tt>HAM_BXCSCAL</tt></FONT>.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">TEMP </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   (DLM) spin temperature.
   </TD>
   </TR>

   </TBODY>
   </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- GW -->
<H3><A name="GWcat"></A>
<FONT size="+2"><tt>GW</tt></FONT> category
</H3>
Category <FONT size="+1"><tt>GW</tt></FONT> holds parameters specific to <A href="gw.html">GW</A> calculations,
particularly for the GW driver <A href=gw.html#lmfgwd><b>lmfgwd</b></A>. Most of these tokens supply values for tags in the
<FONT size="+1"><tt>GWinput</tt></FONT> template when <A href=gw.html#gwtemplate><b>lmfgwd</b> generates it</A> (job &minus;1).

<P>
 <TABLE border="1">
  <TBODY>
        <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
    <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>


   <TR>
   <TD bgcolor="e5e1ff"> CODE </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 2 </TD>
   <TD bgcolor="feffe1">
   This token tells what GW code you are creating input files for.
   <b>lmfgwd</b> serves as a driver to several <i>GW</i> codes
   <OL>
   <LI value="0"> First GW version <FONT size="+1"><tt>v033a5</tt></FONT> (code still works but it is no longer maintained).
   <LI value="2"> Current version of GW codes
   <LI value="1"> Driver for the Julich <FONT size="+1"><tt>spex</tt></FONT> code (not fully debugged or maintained)
   <LI value="10"> Driver for the Rutgers DMFT code (under development)
   </OL>
   
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> NKABC </TD>
   <TD bgcolor="feffe1"><PRE> 1 to 3 i</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">

   Defines the <b>k</b>-mesh for <i>GW</i>.  This token serves the same function for <i>GW</i> as
   <A href="#BZcat"><FONT size="+1"><tt>BZ_NKABC</tt></FONT></A> does for the LDA codes, and the input format is the same.
   <br> When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes the contents of <FONT size="+1"><tt>NKABC</tt></FONT> to the <FONT size="+1"><tt>n1n2n3</tt></FONT> tag.
   <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
   Shell scripts <b>lmgw</b> and <b>lmgwsc</b> used for the GW codes may also use this token.
   When invoked with switches <FONT size="+1"><tt>--getsigp</tt></FONT> or <FONT size="+1"><tt>--getnk</tt></FONT>,
   they will modify the <FONT size="+1"><tt>n1n2n3</tt></FONT> in <FONT size="+1"><tt>GWinput</tt></FONT>.
   The data they use is taken from <FONT size="+1"><tt>GW_NKABC</tt></FONT>.
   </TD>
   </TR>

<!--
   <TR>
   <TD bgcolor="e5e1ff"> BZJOB </TD>
   <TD bgcolor="feffe1"><PRE> 1 to 3 i</PRE></TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Controls the centering of the <i>k</i>-points in the BZ. This token serves the same function for <i>GW</i> as
   <A href="#BZcat"><FONT size="+1"><tt>BZ_BZJOB</tt></FONT></A> does for the LDA codes, and the input format is the same.
   </TD>
   </TR>
-->

   <TR>
   <TD bgcolor="e5e1ff"> MKSIG </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 3 </TD>
   <TD bgcolor="feffe1">
   (self-consistent calculations only).
   Controls the form of <i>V</i><sup>xc</sup> (the static QS<i>GW</i>  approximation to the dynamical self-energy &Sigma;).
   In the table below &Sigma;<sub><i>nn</i>'&thinsp;</sub>(<i>E</i>) refers to a matrix element of &Sigma; between eigenstates <i>n</i> and <i>n</i>', at energy <i>E</i> relative to <i>E<sub>F</sub></i>. <br>
   When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes <FONT size="+1"><tt>MKSIG</tt></FONT> to the <FONT size="+1"><tt>iSigMode</tt></FONT> tag.<br>
   Values of this tag have the following meanings.
   <OL>
   <LI value="0"> do not make <i>V</i><sup>xc</sup><br>
   <LI value="1"> <i>V</i><sup>xc</sup> = &Sigma;<sub><i>nn</i>'</sub>&thinsp;(<i>E</i><sub><i>F</i></sub>)
                       if <i>n</i>&ne;<i>n</i>', and &Sigma;<sub><i>nn</i></sub>(<i>E</i><sub><i>n</i></sub>) if <i>n</i>=<i>n</i>' :
                       mode B, Eq.(11) in Phys. Rev. B<b>76</b>, 165106 (2007) <br>
   <LI value="3"> <i>V</i><sup>xc</sup> =
                       1/2[&Sigma;<sub><i>nn</i>'</sub>&thinsp;(<i>E</i><sub><i>n</i></sub>) + &Sigma;<sub><i>nn</i>'</sub>&thinsp;(<i>E</i><sub><i>n</i>'</sub>)]:
                       mode A, Eq.(10) in Phys. Rev. B<b>76</b>, 165106 (2007) <br>
   <LI value="5"> "eigenvalue only" self-consistency <i>V</i><sup>xc</sup> = &delta;<sub><i>nn</i>'</sub>&Sigma;<sub><i>nn</i>'&thinsp;</sub>(<i>E</i><sub><i>n</i></sub>)
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> GCUTB </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 2.7 </TD>
   <TD bgcolor="feffe1">
   G-vector cutoff for basis envelope functions as used in the GW package.<br>
   When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes GCUTB to the <FONT size="+1"><tt>QpGcut_psi</tt></FONT> tag.
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> GCUTX </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 2.2 </TD>
   <TD bgcolor="feffe1">
   G-vector cutoff for interstitial part of two-particle objects such as the screened coulomb interaction.<br>
   When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes GCUTX to the <FONT size="+1"><tt>QpGcut_cou</tt></FONT> tag.
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ECUTS </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 2.5 </TD>
   <TD bgcolor="feffe1">
   (self-consistent calculations only).  Maximum energy for which to calculate the <i>V</i><sup>xc</sup> described in MKSIG above.
   This energy should larger than <A href="#HAMcat"><FONT size="+1"><tt>HAM_SIGP_EMAX</tt></FONT></A>
   which is <A href="gw.html#sigintrp">used to interpolate <i>V</i><sup>xc</sup></A>.
   When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes ECUTS+1/2 to the <FONT size="+1"><tt>emax_sigm</tt></FONT> tag.
   </TD>
   </TR>

<!--
   <TR>
   <TD bgcolor="e5e1ff"> NBAND </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 99999 </TD>
   <TD bgcolor="feffe1">
   Maximum number bands to include in calculating the response function.
   When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes ECUTS+1/2 to the <FONT size="+1"><tt>emax_sigm</tt></FONT> tag.
   </TD>
   </TR>
-->

   <TR>
   <TD bgcolor="e5e1ff"> NIME </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 6 </TD>
   <TD bgcolor="feffe1">
   Number of frequencies on the imaginary integration axis when making the correlation part of &Sigma;.
   <br>When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes <FONT size="+1"><tt>NIME</tt></FONT> to the <FONT size="+1"><tt>niw</tt></FONT> tag.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> DELRE </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> .01,.04 </TD>
   <TD bgcolor="feffe1">
   frequency mesh parameters <FONT size="+1"><tt>(dw,omg_c)</tt></FONT> definining the real axis mesh when calculating Im &chi;<sub>0</sub>.
   The <i>i</i><sup>th</sup> mesh point is given by:<br>
        &emsp;&emsp;<FONT size="+1"><tt>&emsp;&emsp; &omega;<sub><i>i</i></sub> =
         dw&times;(<i>i</i>&minus;1) + [dw&times;(<i>i</i>&minus;1)]<sup>2</sup>/omg_c/2 </tt></FONT><br>
   Points are approximately uniformly spaced, separated by
   <FONT size="+1"><tt>dw</tt></FONT>, up to frequency <FONT size="+1"><tt>omg_c</tt></FONT>, around which point the spacing begins to increase linearly with frequency.
   <br>When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes <FONT size="+1"><tt>DELRE(1)</tt></FONT> to the <FONT size="+1"><tt>dw</tt></FONT> tag and
   <FONT size="+1"><tt>DELRE(2)</tt></FONT> to the <FONT size="+1"><tt>omg_c</tt></FONT> tag.
   <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
   the similarity to <A href=#OPTICScat><FONT size="+1"><tt>OPTICS_DW</tt></FONT></A> used by the optics part of <b>lmf</b> and <b>lm</b>.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> DELTA </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> -1e-4 </TD>
   <TD bgcolor="feffe1">
   &delta;-function broadening for calculating &chi;<sub>0</sub>, in atomic units.
   Tetrahedron integration is used if <FONT size="+1"><tt>DELTA</tt></FONT>&lt;0.
   <br>When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes <FONT size="+1"><tt>DELTA</tt></FONT> to the <FONT size="+1"><tt>delta</tt></FONT> tag.
   </TD>
   </TR>

<!-- 
   <TR>
   <TD bgcolor="e5e1ff"> DELTAW </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.02 </TD>
   <TD bgcolor="feffe1">
   Width for finite difference in numerical differentiaion of &Sigma; when calculating the Z factor.
   <br>When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes <FONT size="+1"><tt>DELTAW</tt></FONT> to the <FONT size="+1"><tt>deltaw</tt></FONT> tag.
   </TD>
   </TR>
-->

   <TR>
   <TD bgcolor="e5e1ff"> GSMEAR </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> .003 </TD>
   <TD bgcolor="feffe1">
   Broadening width for smearing pole in the Green's function when calculating &Sigma;.
   <br> This parameter is sometimes important in metals, e.g. Fe.
   See Section 3 in <A href=man033_ver1.pdf>this manual</A>.
   <br>When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes <FONT size="+1"><tt>GSMEAR</tt></FONT> to the <FONT size="+1"><tt>esmr</tt></FONT> tag.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> PBTOL </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> .001 </TD>
   <TD bgcolor="feffe1">
   Overlap criterion for product basis functions inside augmentation spheres.
   The overlap matrix of the basis of product functions generated and diagonalized for each <i>l</i>.  Functions with overlaps less than <FONT size="+1"><tt>PBTOL</tt></FONT> are removed from the product basis.
   <br>When <A href=gw.html#gwtemplate>generating a <FONT size="+1"><tt>GWinput</tt></FONT> template</A>,
   <b>lmfgwd</b> passes <FONT size="+1"><tt>PBTOL</tt></FONT> to the second line after the the start of the <FONT size="+1"><tt>PRODUCT_BASIS</tt></FONT> section.
   </TD>
   </TR>

</TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- HAM -->
<H3><A name="HAMcat"></A>
<FONT size="+2"><tt>HAM</tt></FONT> category
</H3>
This category contains parameters defining the one-particle hamiltonian.
Portions of <FONT size="+1"><tt>HAM</tt></FONT> are read by these codes:

<b>lm</b>,
<b>lmfa</b>,
<b>lmfgwd</b>,
<b>lmfgws</b>,
<b>lmf</b>,
<b>lmmc</b>,
<b>lmgf</b>,
<b>lmdos</b>,
<b>lmchk</b>,
<b>lmscell</b>,
<b>lmstr</b>,
<b>lmctl</b>,
<b>lmpg</b>,
<b>tbe</b>,
<b>lmmag</b>,

<P>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">NSPIN </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
   1 for non-spin-polarized calculations<br>
   2 for spin-polarized calculations
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">REL </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff">ALL </TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
   0 : for nonrelativistic Schrodinger equation<br>
   1 : for scalar relativistic approximation to the Dirac equation<br>
   2 : for Dirac equation<br>
  NB: For the magnetic parameters below to be active, <FONT size="+1"><tt>HAM_NSPIN</tt></FONT> must be 2 </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SO </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">0</TD>
   <TD bgcolor="feffe1">
   0 : no SO coupling<br>
   1 : Add <i>L&middot;S</i> to hamiltonian<br>
   2 : Add <i>L<sub>z</sub>&middot;S<sub>z</sub></i> only to hamiltonian<br>
   3 : Like 2, but also add <i>L&middot;S&minus;L<sub>z</sub>S<sub>z</sub></i> in an approximate manner that preserves indpendence in the spin channels.<br>
   See <A href="spin-orbit-coupling.html">here</A>  for analysis and description of the different approximations
</TD>
   </TR>

   <TD bgcolor="e5e1ff">NONCOL </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   <FONT size="+1"><tt>F</tt></FONT>: collinear magnetism<br>
   <FONT size="+1"><tt>T</tt></FONT>: non-collinear magnetism</TD>
   </TR>

   <TD bgcolor="e5e1ff">SS </TD>
   <TD bgcolor="feffe1"><PRE>4 r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 </TD>
   <TD bgcolor="feffe1">
   Magnetic spin spiral, direction vector and angle.
   <br><FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>nc/test/test.nc 1</tt></FONT> .
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> BFIELD </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lm,lmf</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   0 : no external magnetic field applied.<br>
   1 : add site-dependent constant external Zeeman field (requires <FONT size="+1"><tt>NONCOL=T</tt></FONT>).
   Fields are read from file <FONT size="+1"><tt>bfield.<i>ext</i></tt></FONT>.<br>
   2 : add <i>B<sub>z</sub>&middot;S<sub>z</sub></i> only to hamiltonian.
   <br><FONT color="#3300bb"><I>Examples</I>&nbsp;:&nbsp;</FONT>
   <br> &nbsp&nbsp&nbsp&nbsp&nbsp;<FONT size="+1"><tt>fp/test/test.fp gdn</tt></FONT>
   <br> &nbsp&nbsp&nbsp&nbsp&nbsp;<FONT size="+1"><tt>nc/test/test.nc 5</tt></FONT>
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> BXCSCAL </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lm,lmgf</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   This tag provides an alternative means to add an effective external magnetic field in the LDA.<br>
   0 : no special scaling of the exchange-correlation field.<br>
   1 : scale the magnetic part of the LDA XC field by a site-dependent factor 1&nbsp;+&nbsp;<i>sbxc<sub>i</sub></i> as described below.<br>
   2 : scale the magnetic part of the LDA XC field by a site-dependent factor (1&nbsp;+&nbsp;<i>sbxc<sub>i</sub></i><sup>2</sup>)<sup>1/2</sup> as described below.
   This is a special mode used to impose contraining fields on rotations, used, e.g. by the
    <A href="cpa.html">CPA code</A>.<br>
   Site-dependent scalings <i>sbxc<sub>i</sub></i>&nbsp; are read from file <FONT size="+1"><tt>bxc.<i>ext</i></tt></FONT>.<br>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">XCFUN </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL LDA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">2 </TD>
   <TD bgcolor="feffe1">
   Specifies local exchange correlation functional:<br>
   1 : Ceperly-Alder<br>
   2 : Barth-Hedin (ASW fit)<br>
   3 : PW91 (same as PBE) <br>
   4 : PBE (same as PW91)</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">GGA </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL LDA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Specifies a GGA functional:<br>
      <OL start=0>

   <LI> No GGA (LDA only)<br>
   <LI> Langreth-Mehl<br>
   <LI> PW91<br>
   <LI> PBE<br>
   <LI> PBE with Becke exchange<br>
          <FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
           <FONT size="+1"><tt>fp/test/test.fp te</tt></FONT>
   </OL
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">PWMODE </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmf</tt></FONT>,<br><FONT size="+1"><tt>lmfgwd</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Controls how <A href="fp.html#apw">APWs are added</A> to the LMTO basis.
   <P>
   1s digit:
      <OL start=0>
      <LI> LMTO basis only<br>
      <LI> Mixed LMTO+PW<br>
          <FONT color="#3300bb"><I>Examples</I>&nbsp;:&nbsp;</FONT>
           <FONT size="+1"><tt>fp/test/test.fp srtio3</tt></FONT> &nbsp;&nbsp; and &nbsp;&nbsp; <FONT size="+1"><tt>fp/test/test.fp felz 4</tt></FONT>
      <LI> PW basis only<br>
      </OL>

   10s digit:
      <OL start=0>
      <LI> PW basis fixed (less accurate, but simpler)<br>
      <LI> PW basis <b>k</b>-dependent.  Symmetry-consistent but basis and basis dimension depend on <b>k</b>.<br>
          <FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
           <FONT size="+1"><tt>fp/test/test.fp te</tt></FONT>
      </OL>
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">PWEMIN </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmf</tt></FONT>,<br><FONT size="+1"><tt>lmfgwd</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">0</TD>
   <TD bgcolor="feffe1">
    Include APWs with energy <i>E</i> > <FONT size="+1"><tt>PWEMIN</tt></FONT> (Ry)</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">PWEMAX </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmf</tt></FONT>,<br><FONT size="+1"><tt>lmfgwd</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> -1</TD>
   <TD bgcolor="feffe1">
      Include APWs with energy <i>E</i> < <FONT size="+1"><tt>PWEMAX</tt></FONT> (Ry)</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">NPWPAD </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmf</tt></FONT>,<br><FONT size="+1"><tt>lmfgwd</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> -1</TD>
   <TD bgcolor="feffe1">
   Overrides default padding of variable basis dimension</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">RDSIG </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,lmfgwd,<br>lm,lmgf</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">0</TD>
   <TD bgcolor="feffe1">

  Controls how the self-energy &Sigma; is added to local exchange correlation functional.  See <A href="gw.html">gw.html</A> for detailed documentation.<br>
    1s digit:<br>
      &nbsp&nbsp&nbsp;0 do not read &Sigma;<br>
      &nbsp&nbsp&nbsp;1 read file &Sigma; in <FONT size="+1"><tt>sigm.<i>ext</i></tt></FONT>, if it exists, and add it to the LDA potential<br>
      &nbsp&nbsp&nbsp;Add 2 to symmetrize &Sigma;(T)<br>
      &nbsp&nbsp&nbsp;Add 4 to include Re(&Sigma;(T)) only<br>
    10s digit:  &nbsp;&nbsp;  (see <A href="gw.html#sigintrp">gw.html</A> for a more complete
    description of the theory behind this digit)<br>
      &nbsp&nbsp&nbsp;0 simple interpolation<br>
      &nbsp&nbsp&nbsp;1 approximate high energy parts of sigma by diagonal (see sigp)<br>
      &nbsp&nbsp&nbsp;3 interpolate sigma by LDA eigenvectors (no longer supported)<br>
        &nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp;In this mode use 100s digit for # interpolation points.<br>
    &nbsp&nbsp&nbsp;Add 10000 to indicate the sigma file was stored in the full BZ (no symmetry operations are assumed)<br>
    &nbsp&nbsp&nbsp;Add 20000 to use the minimum neighbor table (only one translation vector at the surfaces or edges; cannot be used with symmetrization)<br>
    &nbsp&nbsp&nbsp;Add 40000 to allow file mismatch between expected <i>k</i>-points and file values; see <A href="gw.html">gw.html</A>.
   <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
   Some options can also <A href="gw.html#sigmavariants">be supplied through the command-line argument</A> <FONT size="+1"><tt>--rsig[~option~option...]</tt></FONT>.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">RSSTOL </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 5e-6</TD>
   <TD bgcolor="feffe1">
   Max tolerance in Bloch sum error for real-space &Sigma;.
   <P> Unless otherwise specified (by e.g. <A href="gw.html#sigmavariants"><FONT size="+1"><tt>--rsig~rs</tt></FONT></A>),
   &Sigma; is read in <i>k</i>-space and is immediately converted to real space by inverse Bloch transform.
   The r.s.form is forward Bloch summed and checked against the original <i>k</i>-space &Sigma;.
   If the difference exceeds <FONT size="+1"><tt>RSSTOL</tt></FONT> the program will abort.
   The conversion should be exact to machine precision unless the range of &Sigma; is truncated.
   You can control the range of real-space &Sigma; with <FONT size="+1"><tt>RSRNGE</tt></FONT> below.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">RSRNGE </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 5</TD>
   <TD bgcolor="feffe1">
   Maximum range of connecting vectors for real-space &Sigma; (units of <FONT size="+1"><tt>ALAT</tt></FONT>).
   </TD>
   </TR>

   <TD bgcolor="e5e1ff">NMTO </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Order of polynomial approximation for NMTO hamiltonian.
   </TD>
   </TR>

   <TD bgcolor="e5e1ff">KMTO </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Corresponding NMTO kinetic energies.<br>
   Read <FONT size="+1"><tt>NMTO</tt></FONT> values, or skip if <FONT size="+1"><tt>NMTO=0</tt></FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">EWALD </TD>
   <TD bgcolor="feffe1"><PRE> l </PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lm</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Make strux by Ewald summation (NMTO only).</TD>
   </TR>

   <TD bgcolor="e5e1ff"> VMTZ </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Muffin-tin zero defining wave functions.
   </TD>
   </TR>

   <TD bgcolor="e5e1ff"> QASA </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 3</TD>
   <TD bgcolor="feffe1">
   A parameter specifying the definition of ASA moments <FONT size="+1"><tt>Q0,Q1,Q2</tt></FONT>; see <A href="lmto.html#sectionpq">lmto documentation</A><br>
   <OL start=0>
   <LI> Methfessel conventions for 2nd gen ASA moments <FONT size="+1"><tt>Q0,Q1,Q2</tt></FONT> <br>
   <LI> Q2 = coefficient to <i>&phi;&#775;</i><sup>2</sup> &minus; <i>p</i> <i>&phi;</i><sup>2</sup> in sphere.<br>
   <LI> Q1,Q2 accumulated as coefficients to &lt;<i>&phi;&middot;&phi;&#775;</i>&gt; and &lt;<i>&phi;&#775;</i><sup>2</sup>&gt;, respectively.<br>
   <LI> 1+2 (Stuttgart conventions)
   </OL>
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">PMIN </TD>
   <TD bgcolor="feffe1"><PRE> r </PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0 0 ...</TD>
   <TD bgcolor="feffe1">
   Global minimum in fractional part of <A href="lmto.html#sectionpq">logarithmic derivative parameters</A> <i>P<sub>l</sub></i>. &nbsp; Enter values for <FONT size="+1"><tt>l=0,..lmx</tt></FONT><br>
   0 : no minimum constraint<br>
   # : with #<1, floor of fractional <FONT size="+1"><tt>P</tt></FONT> is #<br>
   1 : use free-electron value as minimum<br>
   <FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
   <b>lmf</b> always uses a minimum constraint, the free-electron
   value (or slightly higher if <FONT size="+1"><tt>AUTOBAS_GW</tt></FONT> is set).
   You can set the floor still higher with <FONT size="+1"><tt>PMIN=#</tt></FONT>.<br>
   </TD>
   </TR>


   <TR>
   <TD bgcolor="e5e1ff">PMAX </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0 0 ...</TD>
   <TD bgcolor="feffe1">
   Global maximum in fractional part of <A href="lmto.html#sectionpq">potential functions</A> <i>P<sub>l</sub></i>. &nbsp; Enter values for <FONT size="+1"><tt>l=0,..lmx</tt></FONT><br>
   0 : no maximum constraint<br>
   # : with #<1, uppper bound of of fractional <FONT size="+1"><tt>P</tt></FONT> is #<br>
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">OVEPS</TD>
   <TD bgcolor="feffe1"><PRE> r </PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">0</TD>
   <TD bgcolor="feffe1">
   The overlap is diagonalized and the hilbert space is contracted, discarding the part
   with eigenvalues of overlap &lt; <FONT size="+1"><tt>OVEPS</tt></FONT> <br>
   Especially useful with the <A href="fp.html#apw">PMT basis</A>, where the combination of smooth Hankel functions and APWs has a tendency to make the basis overcomplete.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">OVNCUT </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">0</TD>
   <TD bgcolor="feffe1">
   This tag has a similar objective to <FONT size="+1"><tt>OVEPS</tt></FONT>.
   The overlap is diagonalized and the hilbert space is contracted, discarding the part
   belonging to lowest <FONT size="+1"><tt>OVNCUT</tt></FONT> evals of overlap.
   Supersedes <FONT size="+1"><tt>OVEPS</tt></FONT>, if present.
   </TD>
   </TR>

   <TR>
      <TD bgcolor="#e5e1ff">GMAX </TD>
      <TD bgcolor="#feffe1"><PRE> r</PRE></TD>
      <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmf,<br>lmfgwd</tt></FONT></TD>
      <TD bgcolor="#feffe1">N </TD>
      <TD bgcolor="#e5e1ff"></TD>
   <TD bgcolor="feffe1">
            <b>G</b>-vector cutoff used to create the mesh for the interstitial
            density.  A uniform mesh is with spacing between points in
            the three directions as homogeneous as possible, with <b>G</b> vectors
            |<b>G</b>|&lt;<FONT size="+1"><tt>GMAX</tt></FONT>.<br>
            This input is required; but you may omit it if you supply information with the <FONT size="+1"><tt>FTMESH</tt></FONT> token.
    </TD>
    </TR>

    <TR>
      <TD bgcolor="#e5e1ff">FTMESH </TD>
      <TD bgcolor="#feffe1"><pre> i1 [i2 i3]</pre></TD>
      <TD bgcolor="#e5e1ff"> FP </TD>
      <TD bgcolor="#feffe1">N </TD>
      <TD bgcolor="#e5e1ff"></TD>
      <TD bgcolor="feffe1">
           The number of divisions specifying the uniform mesh density
           along the three reciprocal lattice vectors.  The second
           and third arguments default to the value of the first one,
           if they are not specified <br>
           This input is used only if if the parser failed to read the <FONT size="+1"><tt>GMAX</tt></FONT> token.
    </TR>

    <TR>
      <TD bgcolor="#e5e1ff">TOL </TD>
      <TD bgcolor="#feffe1"><pre> r</pre></TD>
      <TD bgcolor="#e5e1ff"> FP </TD>
      <TD bgcolor="#feffe1"> Y</TD>
      <TD bgcolor="#e5e1ff"><FONT size="+1"><tt>1e-6</tt></FONT></TD>
   <TD bgcolor="feffe1">
      Specifies the precision to which the generalized LMTO envelope
      functions are expanded in a Fourier expansion of <b>G</b> vectors.<BR>
    </TR>

    <TR>
      <TD bgcolor="#e5e1ff"> FRZWF </TD>
      <TD bgcolor="#feffe1"><pre> l</pre></TD>
      <TD bgcolor="#e5e1ff"> FP </TD>
      <TD bgcolor="#feffe1"> Y</TD>
      <TD bgcolor="#e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
           Set to <FONT size="+1"><tt>T</tt></FONT> to freeze the shape of the augmented part of the
           wave functions.  Normally their shape is updated as the
           potential changes, but with <FONT size="+1"><tt>FRZWF=t</tt></FONT> the potential used to
           make augmentation wave functions is frozen at what is read
           from the restart file (or free-atom potential if starting
           from superposing free atoms).<BR>

           This is not normally necessary, and freezing wave functions
           makes the basis slightly less accurate.  However, there are
           slight inconsistencies when these orbitals are allowed to
           change shape.  Notably the calculated forces to not take
           this shape change into account, and they will be slightly
           inconsistent with the total energy.</TD> </TR>

    <TR>
      <TD bgcolor="#e5e1ff">FORCES </TD>
      <TD bgcolor="#feffe1"><pre> i</pre></TD>
      <TD bgcolor="#e5e1ff">  FP </TD>
      <TD bgcolor="#feffe1"> Y</TD>
      <TD bgcolor="#e5e1ff">0</TD>
   <TD bgcolor="feffe1">
           Controls how forces are to be calculated, and how the
           second-order corrections are to be evaluated.  Through the
           variational principle, the total energy is correct to
           second order in deviations from self-consistency, but
           forces are correct only to first order.  To obtain forces
           to second order, it is necessary to know how the density
           would change with a (virtual) displacement of the
           core+nucleus, which requires a linear response treatment.
           <B>lmf</B> estimates this changes in one of two ways:
           <OL>
             <LI> the free-atom density is subtracted from the total
             density for nuclei centered at the original position and
             added back again at the (virtually) displaced position.
             <BR>For this ansatz, use <FONT size="+1"><tt>FORCES=1</tt></FONT>.

             <LI> the core+nucleus is shifted and screened assuming a
             Lindhard dielectric response.
             <BR>For this ansatz, use <FONT size="+1"><tt>FORCES=12</tt></FONT>.  You also must
             specify <FONT size="+1"><tt>ELIND</tt></FONT>, below.
           </OL>
     </TD>
    </TR>

    <TR>
      <TD bgcolor="#e5e1ff"> ELIND </TD>
      <TD bgcolor="#feffe1"><pre> r</pre></TD>
      <TD bgcolor="#e5e1ff"> lmf </TD>
      <TD bgcolor="#feffe1"> Y</TD>
      <TD bgcolor="#e5e1ff">-1</TD>
   <TD bgcolor="feffe1">
           a parameter in the Lindhard response function, (the
           Fermi level for a free-electron gas relative to the bottom of
           the band).  You can specify this energy directly, by using a
           positive number for the parameter.  If you use instead a
           negative number, the program will choose a default value from
           the total number of valence electrons and assuming a
           free-electron gas, scale that default by the absolute value of
           the number you specify.  If you have a simple sp bonded system,
           the default value is a good choice.  If you have <I>d</I>
           or <I>f</I> electrons, it tends to overestimate the response.
           Use a something smaller, e.g. <FONT size="+1"><tt>ELIND=-0.7</tt></FONT>.

           <P> <FONT size="+1"><tt>ELIND</tt></FONT> is used in
           three contexts:
          <DD>
             (1) in the force correction term; see <FONT size="+1"><tt>FORCES=</tt></FONT> above
          <DD>
             (2) to estimate a self-consistent density from the input and
                 output densities after a band pass
          <DD>
             (3) to estimate a reasonable smooth density from a starting
                 density after atoms are moved in a relaxation step.
          </DL>
      </TD>
    </TR>

    <TR>
      <TD bgcolor="#e5e1ff"> SIGP[...] </TD>
      <TD bgcolor="#feffe1"><pre> r</pre></TD>
      <TD bgcolor="#e5e1ff"> lmf,<br>lmfgwd </TD>
      <TD bgcolor="#feffe1">Y </TD>
      <TD bgcolor="#e5e1ff"></TD>
      <TD bgcolor="feffe1">
           Parameters used to interpolate the self-energy &Sigma;. &nbsp; Used in conjunction with the <i>GW</i> package. See <A href="gw.html#sigintrp">gw.html</A>
           for description.
      Default:not used
      </TD>
    </TR>

    <TR>
      <TD bgcolor="#e5e1ff"> SIGP_MODE </TD>
      <TD bgcolor="#feffe1"><pre> r</pre></TD>
      <TD bgcolor="#e5e1ff"> lmf,<br>lmfgwd </TD>
      <TD bgcolor="#feffe1">Y </TD>
      <TD bgcolor="#e5e1ff">4</TD>
      <TD bgcolor="feffe1">
           Specifies the linear function used for <A href="gw.html#sigintrp">matrix elements of &Sigma; at highly-lying energies</A>.
           With recent implementations of the <i>GW</i> package 4 is recommended; it requires no input from you.
      </TD>
    </TR>

    <TR>
      <TD bgcolor="#e5e1ff"> SIGP_EMAX<br>SIGP_NMAX<br>
                             SIGP_EMIN<br>SIGP_NMIN<br>SIGP_A<br>SIGP_B </TD>
      <TD bgcolor="#feffe1"><pre> r</pre></TD>
      <TD bgcolor="#e5e1ff"> lmf,<br>lmfgwd </TD>
      <TD bgcolor="#feffe1">Y </TD>
      <TD bgcolor="#e5e1ff"></TD>
      <TD bgcolor="feffe1">
           See <A href="gw.html#sigintrp">gw.html</A>.
      </TD>
    </TR>

    <TR>
      <TD bgcolor="#e5e1ff"> AUTOBAS[...] </TD>
      <TD bgcolor="#feffe1"><pre> r</pre></TD>
      <TD bgcolor="#e5e1ff"> lmfa,<br>lmf,<br>lmfgwd </TD>
      <TD bgcolor="#feffe1">Y </TD>
      <TD bgcolor="#e5e1ff"></TD>
   <TD bgcolor="feffe1">
           Parameters associated with the automatic determination of the basis set.
           These switches greatly simplify the creation of an input file for <b>lmf</b>. <br>
          <FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
           Programs <b>lmfa</b> and <b>lmf</b> both use tokens in the <FONT size="+1"><tt>AUTOBAS</tt></FONT> tag but they mean different things,
           as described below.
           This is because <b>lmfa</b> <i>generates</i> the parameters while <b>lmf</b> <i>uses</i> them.
           See <A href="Building_FP_input_file.html">Building_FP_input_file.html</A>
           for more detail.
      <br>
      Default: not used<BR>
      </TD>
    </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_GW </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmfa</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Set to 1 to tailor the
   <A href="Building_FP_input_file.html#autobas">autogenerated basis set file</A> <FONT size="+1"><tt>basp0.<i>ext</i></tt></FONT> to a somewhat larger basis, better suited for <i>GW</i>.
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_GW </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmf</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Set to 1 to float log derivatives
   <A href="lmto.html#sectionpq"><FONT size="+1"><tt>P</tt></FONT></A> a bit more conservatively --- better suited to <i>GW</i> calculations.
   </TR>

<TR>
   <TD bgcolor="e5e1ff">AUTOBAS_LMTO </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmfa</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">

   <b>lmfa</b> autogenerates
   a <A href="Building_FP_input_file.html#autobas">trial basis</A> set, saving the result into <FONT size="+1"><tt>basp0.<i>ext</i></tt></FONT>.
   <FONT size="+1"><tt>LMTO</tt></FONT> is used in an algorithm to determine how large a basis it should construct: the number of orbitals increases
   as you increase <FONT size="+1"><tt>LMTO</tt></FONT>.  This algorithm also depends on which states in the free atom which carry charge.
   Let <i>l<sub>q</sub></i> be the highest <i>l</i> which carries charge in the free atom.
   <P>There are the following choices for <FONT size="+1"><tt>LMTO</tt></FONT>:<br>
   <OL start=0>
   <LI> standard minimal basis; same as <FONT size="+1"><tt>LMTO=3</tt></FONT>.
   <LI>
   The <i>hyperminimal basis</i>, which consists of envelope functions corresponding those <i>l</i>
   which carry charge in the free atom, e.g. Ga <i>sp</i> and Mo <i>sd</i>.
   &nbsp;&nbsp&nbsp;
   Note: this basis is only sensible when used in conjunction with <A href="fp.html#apw">APWs</A>.  <br>
   <LI> All <i>l</i> up to <i>l<sub>q</sub></i>+1 if <i>l<sub>q</sub></i>&lt;2;
        otherwise all <i>l</i> up to <i>l<sub>q</sub></i> <br>
   <LI> All <i>l</i> up to min(<i>l<sub>q</sub></i>+1,&nbsp;3).
        For elements lighter than Kr, restrict <i>l</i>&le;2.
        For elements heavier than Kr, include <i>l</i> to 3. <br>
   <LI> (Standard basis) Same as <FONT size="+1"><tt>LMTO</tt></FONT>=3,
        but restrict <i>l</i>&le;2 for elements lighter than Ar. <br>
   <LI> (Large basis)  All <i>l</i> up to max(<i>l<sub>q</sub></i>+1,3)
        except for H, He, Li, B (use <i>l</i>=<i>spd</i>).     <br>
  </OL>

   Use the <FONT size="+1"><tt>MTO</tt></FONT> token (see below) in combination with this one.
   <FONT size="+1"><tt>MTO</tt></FONT> controls whether the LMTO basis is 1-&kappa; or 2-&kappa;,
   meaning whether 1 or 2 envelope functions are allowed per <i>l</i> channel.

   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_MTO </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmfa</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Autogenerate parameters that control which LMTO basis functions are to be included, and their shape. <br>

   Tokens <FONT size="+1"><tt>RSMH,EH</tt> (and possibly <tt>RSMH2,EH2</tt></FONT>)
   determine the <i>shape</i> of the MTO basis.  <b>lmfa</b> will
   determine a reasonable set of <FONT
   size="+1"><tt>RSMH,EH</tt></FONT> automatically (and <FONT size="+1"><tt>RSMH2,EH2</tt></FONT>
   for a 2-<i>&kappa;</i> basis), fitting to
   radial wave functions of the free atom.
   <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
   <b>lmfa</b> can generate parameters and <i>write</i> them to file <FONT size="+1"><tt>basp0.<i>ext</i></tt></FONT>.&nbsp;
   <b>lmf</b>  can <i>read</i> parameters from <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>.
   You must manually create <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>,
                       e.g. by copying <FONT size="+1"><tt>basp0.<i>ext</i></tt></FONT> into
                       <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>.  You can tailor
                       <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT> with a text editor.<br>
   There are the following choices for <FONT size="+1"><tt>MTO</tt></FONT>:<br>
   &nbsp&nbsp&nbsp;0: do not autogenerate basis parameters         <br>
   &nbsp&nbsp&nbsp;1: or 3 1-&kappa; parameters with Z-dependent <FONT size="+1"><tt>LMX</tt></FONT> <br>
   &nbsp&nbsp&nbsp;2: or 4 2-&kappa; parameters with Z-dependent <FONT size="+1"><tt>LMX</tt></FONT> <br>

   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_MTO </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmf</tt></FONT>,<br><FONT size="+1"><tt>lmfgwd</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Read parameters <FONT size="+1"><tt>RSMH,EH,RSMH2,EH2</tt></FONT> that control which LMTO basis functions enter the basis.<br>

   Once initial values have been generated you can tune these parameters automatically for the solid, using
   <b>lmf</b> with the <FONT size="+1"><tt>--optbas</tt></FONT> switch; see
   <A href="Building_FP_input_file.html">Building_FP_input_file.html</A>
   and
   <A href="FPoptbas.html">FPoptbas.html</A>.

   The <FONT size="+1"><tt>--optbas</tt></FONT> step is not essential, especially for large basis sets, but it is a way to improve on the
   basis without increasing the size.<br>

   There are the following choices for <FONT size="+1"><tt>MTO</tt></FONT>:<br>

   &nbsp&nbsp&nbsp;0       Parameters not read from <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>;
                           they are specified in the input file <FONT size="+1"><tt>ctrl.<i>ext</i></tt></FONT>.<br>
   &nbsp&nbsp&nbsp;1 or 3: 1-&kappa; parameters may be read from the basis file <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>, if they exist<br>
   &nbsp&nbsp&nbsp;2 or 4: 2-&kappa; parameters may be read from the basis file <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>, if they exist<br>
   &nbsp&nbsp&nbsp;1 or 2: Parameters read from <FONT size="+1"><tt>ctrl.<i>ext</i></tt></FONT> take precedence over <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT><br>
   &nbsp&nbsp&nbsp;3 or 4: Parameters read from <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT> take precedence over those read from
                           <FONT size="+1"><tt>ctrl.<i>ext</i></tt></FONT>.<br>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_PNU </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmfa</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">0</TD>
   <TD bgcolor="feffe1">

   Autoset boundary condition for augmentation part of basis, through specification of
   <A href="lmto.html#pbasp">logarithmic derivative parameters</A> P. <br>

   &nbsp&nbsp&nbsp;0 do not make <FONT size="+1"><tt>P</tt></FONT> <br>
   &nbsp&nbsp&nbsp;1 Find <FONT size="+1"><tt>P</tt></FONT> for <i>l</i>&lt;lmxb from free atom wave function; save in file
                     <FONT size="+1"><tt>basp0.<i>ext</i></tt></FONT><br>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_PNU </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmf</tt></FONT>,<br><FONT size="+1"><tt>lmfgwd</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">0</TD>
   <TD bgcolor="feffe1">

   Autoset boundary condition for augmentation part of basis, through specification of
   <A href="lmto.html#pbasp">logarithmic derivative parameters</A> P. <br>

     &nbsp&nbsp&nbsp;0 do not attempt to read <FONT size="+1"><tt><FONT size="+1"><tt>P</tt></FONT></tt></FONT> from <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>.<br>
     &nbsp&nbsp&nbsp;1 Read <FONT size="+1"><tt>P</tt></FONT> from <FONT size="+1"><tt>basp.<i>ext</i></tt></FONT>, for those species which <FONT size="+1"><tt>P</tt></FONT> is given.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_LOC </TD>
   <TD bgcolor="feffe1"><PRE> i </PRE></TD>
   <TD bgcolor="e5e1ff"> lmfa,<br>lmf,<br>lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Autoset <A href="fp.html#localorbitals">local orbital</A> parameters <FONT size="+1"><tt>PZ</tt></FONT>,
    which determine which deep or high-lying states are to be included as local orbitals. <br>

   Used by <b>lmfa</b> to control whether parameters PZ are to be sought:<br>
   &nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0: do not autogenerate PZ <br>
   &nbsp&nbsp&nbsp;1 or 2:   autogenerate PZ <br>

   Used by <b>lmf</b> and <b>lmfgwd</b> to control how PZ is read: <br>

   &nbsp&nbsp&nbsp;1 or 2: read parameters PZ<br>
   &nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: Nonzero values from ctrl file take precedence over basis file input</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_ELOC </TD>
   <TD bgcolor="feffe1"><PRE> r </PRE></TD>
   <TD bgcolor="e5e1ff"> lmfa
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> -2 Ry</TD>
   <TD bgcolor="feffe1">
   The first of two criteria to decide which orbitals should be included in the valence as local orbitals.
   If the energy of the free atom wave function exceeds (is more shallow than) <FONT size="+1"><tt>ELOC</tt></FONT>,
   the orbital is included as a local orbital.
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_QLOC </TD>
   <TD bgcolor="feffe1"><PRE> r </PRE></TD>
   <TD bgcolor="e5e1ff"> lmfa
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.005</TD>
   <TD bgcolor="feffe1">
   The second of two criteria to decide which orbitals should be included in the valence as local orbitals.
   If the fraction of the free atom wave function's charge outside the augmentation radius
   exceeds <FONT size="+1"><tt>QLOC</tt></FONT>, the orbital is included as a local orbital.
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">AUTOBAS_PFLOAT </TD>
   <TD bgcolor="feffe1"><PRE> i1 i2</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1 1</TD>
   <TD bgcolor="feffe1">
   Governs how the
   <A href="lmto.html#sectionpq">logarithmic derivative parameters</A> <i>P<sub>l</sub></i> are set and floated in the course of a self-consistency cycle.<br>
   The 1st argument controls default starting values of <FONT size="+1"><tt>P</tt></FONT> and lower bounds to <FONT size="+1"><tt>P</tt></FONT> when it is floated<br>
     &nbsp&nbsp&nbsp;0: Use version 6 defaults and float lower bound<br>
     &nbsp&nbsp&nbsp;1: Use defaults and float lower bound designed for LDA<br>
     &nbsp&nbsp&nbsp;2: Use defaults and float lower bound designed for <i>GW</i><br>
   The 2nd argument controls how the band center of gravity (CG) is determined -- used when floating <FONT size="+1"><tt>P</tt></FONT>.<br>
     &nbsp&nbsp&nbsp;0: band CG is found by a traditional method<br>
     &nbsp&nbsp&nbsp;1: band CG is found from the true energy moment of the density</TD>
   </TR>

   </TBODY>
 </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- HEADER -->
<H3><A name="HEADERcat"></A>
<FONT size="+2"><tt>HEADER</tt></FONT> category</H3>

This category is optional, and merely prints to the standard
output whatever text is in the category.  For example:
<pre>
HEADER  This line and the following one are printed to
        standard out on execution of a program.
XXX
</pre>
Alternately:
<pre>
HEADER [ In this form only two lines reside within the
        category delimiters,]
        and only two lines are printed.
</pre>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- IO -->
<H3><A name="IOcat"></A>
<FONT size="+2"><tt>IO</tt></FONT> category</H3>

This optional category controls what kind of information, and how much, is written
to the standard output file.
<P>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TD bgcolor="e5e1ff"> SHOW </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>all</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Echo lines as it is read from input file and parsed by the proprocessor. <br>
   Command-line argument <FONT size="+1"><tt>--show</tt></FONT> provides the same functionality.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> HELP </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>all</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Show what input would be sought, without attempting to read data. <br>
   Command-line argument <FONT size="+1"><tt>--input</tt></FONT> provides the same functionality.</TD>
   </TR>

   <TD bgcolor="e5e1ff"> VERBOS </TD>
   <TD bgcolor="feffe1"><PRE> 1 to 3</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>all</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 30</TD>
   <TD bgcolor="feffe1">
   Sets the verbosity.  20 is terse, 30 slightly terse, 40 slightly verbose, 50 verbose,
   and so on.  If more than one number is given, later numbers control verbosity
   in subsections of the code, notably the parts dealing with augmentation spheres. <br>
   May also be set from the command-line: <FONT size="+1"><tt>--pr#1[,#2]</tt></FONT>
   </TR>

   <TD bgcolor="e5e1ff"> IACTIV </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>all</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Turn on interactive mode.  At some point programs will prompt you with queries. <br>
   May also be controlled from the command-line:  <FONT size="+1"><tt>--iactiv</tt></FONT>  or  <FONT size="+1"><tt>--iactiv=no</tt></FONT>.
   </TR>

   <TD bgcolor="e5e1ff"> TIM </TD>
   <TD bgcolor="feffe1"><PRE> 1 or 2</PRE></TD>
   <TD bgcolor="e5e1ff"> <tt>all</tt></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0,0</TD>
   <TD bgcolor="feffe1">
   Prints out CPU usage of blocks of code in a tree format.
   First value sets tree depth.  Second value, if present, prints timings on the fly.<br>
   May also be controlled from the command-line: <FONT size="+1"><tt>--time=#1[,#2]</tt></FONT>
   </TR>

 </TBODY>
</TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- ITER -->
<H3><A name="ITERcat"></A>
<FONT size="+2"><tt>ITER</tt></FONT> category
</H3>
The <FONT size="+1"><tt>ITER</tt></FONT> category contains parameters that control the requirements to reach self-consistency.
It applies to all programs that iterate to self-consistency:

<b>lm</b>,
<b>lmfa</b>,
<b>lmf</b>,
<b>lmmc</b>,
<b>lmgf</b>,
<b>lmpg</b>,
<b>tbe</b>.

<P>
 <TABLE border="1">
  <TBODY>
        <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
    <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

 <TR>
   <TD bgcolor="e5e1ff"> NIT </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
   Maximum number of iterations in the self-consistency cycle.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> NRMIX </TD>
   <TD bgcolor="feffe1"><PRE> i1 i2</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA,<FONT size="+1"><tt>lmfa</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 80,2</TD>
   <TD bgcolor="feffe1">
   Uses when self-consistency is needed inside an augmentation sphere.  This occurs when the density is determined from the moments
   <A href="lmto.html#sectionpq"><FONT size="+1"><tt>Q0,Q1,Q2</tt></FONT></A> in the ASA; or in the free atom code, just <FONT size="+1"><tt>Q0</tt></FONT>.<br>
   &nbsp&nbsp&nbsp;<FONT size="+1"><tt>i1</tt></FONT>: max number of iterations<br>
   &nbsp&nbsp&nbsp;<FONT size="+1"><tt>i2</tt></FONT>: number of prior iterations for Anderson mixing of the sphere density
    <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
    You will probably never need to use this token.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MIX </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Mixing rules for mixing input, output density in the self-consistency cycle. Syntax:<br>
   &nbsp&nbsp&nbsp;<FONT size="+1"><tt>A[nmix][,b=beta][,bv=betv][,n=nit][,w=w1,w2][,nam=fn][,k=nkill][;...]</tt></FONT>  or<br>
   &nbsp&nbsp&nbsp;<FONT size="+1"><tt>B[nmix][,b=beta][,bv=betv][,wc=wc][,n=#][,w=w1,w2][,nam=fn][,k=nkill]</tt></FONT><br>
   Click <A href=#mixing>here</A> for a further explanation of <FONT size="+1"><tt>MIX</tt></FONT>.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> AMIX </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Mixing rules when Euler angles are mixed independently.  Syntax as in <FONT size="+1"><tt>MIX</tt></FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> CONV </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1e-4</TD>
   <TD bgcolor="feffe1">
   Maximum energy change from the prior iteration for self-consistency to be reached.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> CONVC </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1e-4</TD>
   <TD bgcolor="feffe1">
   Maximum in the RMS difference in &lt;<i>n</i><sup>out</sup>&minus;<i>n</i><sup>in</sup>&gt;.
   <br>In the ASA, this is measured by the change in moments <FONT size="+1"><tt>Q0..Q2</tt></FONT> and log derivative parameter <FONT size="+1"><tt>P</tt></FONT>.
   <br>In the full-potential case it is measured by an integral over the various parts of <i>n</i> (local, interstitial parts).
   </TD>
   </TR>

<!--
   <TR>
   <TD bgcolor="e5e1ff"> XIPMX </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   If 1, <b>lm</b> mixes potential at the MT
          boundary more slowly than the charge.
          That is, after
          computing the mixed charges Q, it computes the
          electrostatic potential of Q, and makes a linear mix of
          the starting electrostatic potential Vin and the
          potential Vmix from the mixed Q.  The linear mixing
          parameter is betv; see below.  Thus the potential
          reacts more sluggishly (if betv=1, the potential
          mixing has no effect), which damps out potential
          arising from long-wavelength (and low energy) charge
          sloshing.

          <P>Alternatively, you can can make the potential mix truly
          independently.  Using XIPMX=2 you linearly mix Vin and
          the estat potential of the output Q (=Vout).  XIPMX=2
          is like XIPMX=1, but mixes Vin and Vout instead of Vin
          and Vmix.

          <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
          These switch is dated and no longer maintained.  Better to use
          <FONT size="+1"><tt>OPTIONS_SCR</tt></FONT>.
     </TD>
   </TR>
-->

   <TR>
   <TD bgcolor="e5e1ff"> UMIX </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
   Mixing parameter for density matrix; used with LDA+U</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> TOLU </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Tolerance for density matrix; used with LDA+U</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> NITU </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Maximum number of LDA+U iterations of density matrix</TD>
   </TR>
   </TBODY>
   </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- OPTICS -->
<H3><A name="OPTICScat"></A>
<FONT size="+2"><tt>OPTICS</tt></FONT> category
</H3>
Optics functions available with the ASA extension packages <FONT size="+1"><tt>OPTICS</tt></FONT>.
It is read by <b>lm</b> and is also partially implemented in full-potential <b>lmf</b>.
<P>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">MODE </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
     &emsp;&nbsp;&nbsp;0: make no optics calculations<br>
     &emsp;&nbsp;&nbsp;1: generate linear &epsilon;<sub>2</sub><br>
     &emsp;20: generate second harmonic &epsilon;<br>
       &emsp;&emsp;  <FONT color="#3300bb"><I>Example</I>&nbsp;&nbsp;</FONT>
                     <FONT size="+1"><tt>optics/test/test.optics sic</tt></FONT> <br>

       <br>The following cases (<FONT size="+1"><tt>MODE</tt></FONT> &lt; 0)
           generate joint or single density-of-states.

          &emsp;<FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
          <FONT size="+1"><tt>MODE</tt></FONT> &lt; 0 works only with <FONT size="+1"><tt>LTET=3</tt></FONT> described below <br>


     &emsp;&minus;1: generate joint density-of-states<br>
       &emsp;&emsp;<FONT color="#3300bb"><I>Examples</I></FONT><br>
       &emsp;&emsp;&emsp;(ASA) &emsp; <FONT size="+1"><tt>optics/test/test.optics --all 4</tt></FONT> <br>
       &emsp;&emsp;&emsp;(FP)&emsp;&emsp; <FONT size="+1"><tt>fp/test/test.fp zbgan</tt></FONT>           <br>


     &emsp;&minus;2: generate joint density-of-states, spin 2<br>
       &emsp;&emsp;  <FONT color="#3300bb"><I>Example</I>&nbsp;&nbsp;</FONT>
                     <FONT size="+1"><tt>optics/test/test.optics fe 6</tt></FONT> <br>

     &emsp;&minus;3: generate up-down joint density-of-states<br>
     &emsp;&minus;4: generate down-up joint density-of-states<br>
     &emsp;&minus;5: generate spin-up single density-of-states<br>

       &emsp;&emsp;  <FONT color="#3300bb"><I>Example</I>&nbsp;&nbsp;</FONT>
                     <FONT size="+1"><tt>optics/test/test.optics --all 7</tt></FONT><br>

     &emsp;&minus;6: generate spin-dn single density-of-states
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">LTET </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
     &emsp;&nbsp;&nbsp;0: Integration by Methfessel-Paxton sampling<br>
     &emsp;&nbsp;&nbsp;1: standard tetrahedron integration<br>
     &emsp;&nbsp;&nbsp;2: standard tetrahedron integration<br>
     &emsp;&nbsp;&nbsp;3: enhanced tetrahedron integration<br>

     <FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
      In the metallic case states near the Fermi level must be treated with
      partial occupancy.  <FONT size="+1"><tt>LTET=3</tt></FONT> is the only scheme that handles this properly.
      It was adapted from the GW package and has extensions, e.g. the ability to handle non-vertical transitions <b>k</b><sup>occ</sup> &ne; <b>k</b><sup>unocc</sup>.

   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> WINDOW </TD>
   <TD bgcolor="feffe1"><PRE> r1 r2</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0 1</TD>
   <TD bgcolor="feffe1">
   Energy (frequency) window over which to calculate Im[&epsilon;(&omega;)].  <br>
   Im &epsilon; is calculated on a mesh of points &omega;<sub><i>i</i></sub>.
   &ensp; The mesh spacing is specified by <FONT size="+1"><tt>NPTS</tt></FONT> or <FONT size="+1"><tt>DW</tt></FONT>, below.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> NPTS </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 501</TD>
   <TD bgcolor="feffe1">
   Number of mesh points in the energy (frequency) window.  Together with <FONT size="+1"><tt>WINDOW</tt></FONT>, <FONT size="+1"><tt>NPTS</tt></FONT> specifies
   the frequency mesh as:<br>
        <FONT size="+1"><tt>&emsp;&emsp; &omega;<sub><i>i</i></sub> =
        WINDOW(1) + DW&times;(<i>i</i>&minus;1)</tt></FONT> &emsp; where &emsp;
        <FONT size="+1"><tt>DW = (WINDOW(2)&minus;WINDOW(1))/(NPTS&minus;1)</tt></FONT><br>
   <FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT> you may alternatively specify <FONT size="+1"><tt>DW</tt></FONT> below.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> DW </TD>
   <TD bgcolor="feffe1"><PRE> r1 [r2]</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Frequency mesh spacing <FONT size="+1"><tt>DW[,OMG]</tt></FONT>. You can supply either one argument, or two.
   If one argument (<FONT size="+1"><tt>DW</tt></FONT>) is supplied, the mesh will consist of evenly
   spaced points separated by <FONT size="+1"><tt>DW</tt></FONT>.
   If a second argument (<FONT size="+1"><tt>OMG</tt></FONT>) is supplied, points are spaced quadratically as:<br>
        &emsp;&emsp;<FONT size="+1"><tt>&emsp;&emsp; &omega;<sub><i>i</i></sub> =
         WINDOW(1) + DW&times;(<i>i</i>&minus;1) + [DW&times;(<i>i</i>&minus;1)]<sup>2</sup>/OMG/2 </tt></FONT><br>
         Spacing is approximately uniform up to frequency <FONT size="+1"><tt>OMG</tt></FONT>; beyond which it increases linearly.<br>
   <FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT> The quadratic spacing can be used only with <FONT size="+1"><tt>LTET=3</tt></FONT>.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> FILBND </TD>
   <TD bgcolor="feffe1"><PRE> i1 [i2]</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0</TD>
   <TD bgcolor="feffe1">
   <FONT size="+1"><tt>i1[,i2]</tt></FONT> occupied energy bands from which to calculate
           &epsilon; using first order perturbation theory, without local fields.<br>
           &nbsp&nbsp&nbsp;<FONT size="+1"><tt>i1</tt></FONT> = lowest  occupied band<br>
           &nbsp&nbsp&nbsp;<FONT size="+1"><tt>i2</tt></FONT> = highest occupied band (defaults to no. electrons)
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> EMPBND </TD>
   <TD bgcolor="feffe1"><PRE> i1 [i2]</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0</TD>
   <TD bgcolor="feffe1">
   <FONT size="+1"><tt>i1[,i2]</tt></FONT> unoccupied energy bands from which to calculate
           &epsilon; using first order perturbation theory, without local fields.<br>
           &nbsp&nbsp&nbsp;<FONT size="+1"><tt>i1</tt></FONT> = lowest unoccupied band<br>
           &nbsp&nbsp&nbsp;<FONT size="+1"><tt>i2</tt></FONT> = highest unoccupied band (defaults to no. bands)
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> PART </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
    Resolve &epsilon; or joint DOS into band-to-band contributions, or by <b>k</b>.
    Result is output into file <FONT size="+1"><tt>popt.<i>ext</i></tt></FONT>.
   <OL start=0>

   <LI>  No decomposition

   <LI>  Resolve &epsilon; or DOS into individual (occ,unocc) contributions
   <br><FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>optics/test/test.optics ogan 5</tt></FONT>

   <LI>  Resolve &epsilon; or DOS by <b>k</b>
   <br><FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>optics/test/test.optics --all 6</tt></FONT>

   <LI>  Both 1 and 2 <br>
         Add 10 to write <FONT size="+1"><tt>popt</tt></FONT> as a binary file.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> CHI2[..] </TD>
   <TD bgcolor="feffe1"><PRE> </PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Tag containing parameters for second harmonic generation.
   Not calculated unless tag is parsed.
   <br><FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>optics/test/test.optics sic</tt></FONT>
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> CHI2_NCHI2 </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Number of direction vectors for which to calculate &chi;<sub>2</sub></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> CHI2_AXES </TD>
   <TD bgcolor="feffe1"><PRE> i1,i2,i3</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   direction vectors for each of the <FONT size="+1"><tt>NCHI2</tt></FONT> sets</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ESCISS </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Scissors operator (constant energy added to unoccupied levels)</TD>
   </TR>


   <TR>
   <TD bgcolor="e5e1ff"> ECUT </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> OPTICS</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.2</TD>
   <TD bgcolor="feffe1">
   Energy safety margin for determining (occ,unocc) window.
   lmf will attempt to reduce the number of (occ,unocc) pairs by restricting, for each <b>k</b>,
   transitions that contribute to the response, i.e. to those inside the optics <FONT size="+1"><tt>WINDOW</tt></FONT>.
   The window is padded by <FONT size="+1"><tt>ECUT</tt></FONT> include states outside, but
   near the edge of the window.
   States outside window may nevertheless make contribution, e.g. because they can be part of a tetrahedron that does contribute.
   &emsp; If you do not want <b>lmf</b> to restrict the range, use <FONT size="+1"><tt>ECUT</tt></FONT>&lt;0.
   </TR>

   </TBODY>
 </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- OPTIONS-->
<H3><A name="OPTIONScat"></A>
<FONT size="+2"><tt>OPTIONS</tt></FONT> category</H3>

Portions of <FONT size="+1"><tt>OPTIONS</tt></FONT> are read by these codes:

<b>lm</b>,
<b>lmfa</b>,
<b>lmfgwd</b>,
<b>lmfgws</b>,
<b>lmf</b>,
<b>lmmc</b>,
<b>lmgf</b>,
<b>lmdos</b>,
<b>lmstr</b>,
<b>lmctl</b>,
<b>lmpg</b>,
<b>tbe</b>


</H3>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> HF </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lm,lmf</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   If <FONT size="+1"><tt>T</tt></FONT>, Use the Harris-Foulkes functional only; do not evaluate output density.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SHARM </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA,<br><FONT size="+1"><tt>lmf</tt></FONT>,<br><FONT size="+1"><tt>lmfgwd</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   If T, use true spherical harmonics, rather than real harmonics.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> FRZ </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   (ASA) If <FONT size="+1"><tt>T</tt></FONT>, freezes core wave functions.<br>
   (FP) If <FONT size="+1"><tt>T</tt></FONT>, freezes the potential used to make augmented partial waves, so that the basis set does not change with potential.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SAVVEC </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lm</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Save eigenvectors on disk.  (This may be enabled automatically in some circumstances)
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> Q </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   <FONT size="+1"><tt>Q=HAM</tt></FONT>, <FONT size="+1"><tt>Q=BAND</tt></FONT>,
   <FONT size="+1"><tt>Q=MAD</tt></FONT>, <FONT size="+1"><tt>Q=ATOM</tt></FONT>,
   <FONT size="+1"><tt>Q=SHOW</tt></FONT> <br>
   make the program stop at selected points without completing a full iteration.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SCR </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
           Is connected with the generation or use of the <i>q</i>&rightarrow;0 ASA
           dielectric response function.  It is useful in cases
           when there is difficulty in making the density self-consistent.
           See <A href="linear-response-asa.html">linear-response-asa.html</A>
           for documentation.
          <OL start=0>
          <LI>  do not screen <FONT size="+1"><tt>qout&minus;qin</tt></FONT>.
          <LI>  Make the ASA response function  <i>P</i><sup>0</sup> (see <A href="linear-response-asa.html">linear-response-asa.html</A>).
          <LI>  Use <i>P</i><sup>0</sup> to screen <FONT size="+1"><tt>qout&minus;qin</tt></FONT> and
                the change in <FONT size="+1"><tt>ves</tt></FONT>.
          <LI>  1+2 (<b>lmgf</b> only)
          <LI>  screen <FONT size="+1"><tt>qout&minus;qin</tt></FONT> from a model <i>P</i><sup>0</sup>
          <LI>  illegal input
          <LI>  Use <i>P</i><sup>0</sup> to screen the change in <FONT size="+1"><tt>ves</tt></FONT> only
          </OL>
     <i>P</i><sup>0</sup> and <i>U</i> should be updated every iteration, but this is expensive and not worth the cost.  However, you can: <br>
     &nbsp;&nbsp; Add 10*k to recompute intra-site contribution <i>U</i> every <i>k</i><sup>th</sup> iteration, 0&lt;<i>k</i>&le;9. <br>
     &nbsp;&nbsp; Add 100*k to recompute <i>P</i><sup>0</sup> every <i>k</i><sup>th</sup> iteration (<b>lmgf</b> only).
   <br><FONT color="#3300bb"><I>Examples</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>testing/test.scr</tt></FONT> &nbsp;&nbsp; and &nbsp;&nbsp; <FONT size="+1"><tt>gf/test/test.gf mnpt 6</tt></FONT>
   </TD>
   </TR>

    <TR>
      <TD bgcolor="#e5e1ff"> ASA[...]</TD>
      <TD bgcolor="#feffe1"><pre> r</pre></TD>
      <TD bgcolor="#e5e1ff"> ASA </TD>
      <TD bgcolor="#feffe1">N </TD>
      <TD bgcolor="#e5e1ff"></TD>
      <TD bgcolor="feffe1">
           Parameters associated with ASA-specific input.<br>
      </TD>
    </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ASA_ADNF </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Enables automatic downfolding of orbitals</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ASA_NSPH </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 </TD>
   <TD bgcolor="feffe1">
   Set to 1 to generate <i>l</i>&gt;0 contributions (from neighboring sites) to <i>l</i>=0 electrostatic potential</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ASA_TWOC </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Set to 1 to use the two-center approximation ASA hamiltonian</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ASA_GAMMA </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Set to 1 to rotate to the (orthogonal) gamma representation.  This should have
           no effect on the eigenvalues for the usual
           three-center hamiltonian, but converts the two-center
           hamiltonian from first order to second order.  <br>
   Set to 2 to rotate to the spin-averaged gamma representation. <br>
           The <b>lm</b> code does not
           allow downfolding with <FONT size="+1"><tt>GAMMA&ne;0</tt></FONT>.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ASA_CCOR </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lm</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> T</TD>
   <TD bgcolor="feffe1">
           If <FONT size="+1"><tt>F</tt></FONT>, suppresses the combined correction. By default it is enabled.
          <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
           NB: if any orbitals are downfolded, <FONT size="+1"><tt>CCOR</tt></FONT> is automatically enabled.
  </TD>
   </TR>

<!--
   <TR>
   <TD bgcolor="e5e1ff"> ASA_ELIN </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> NC</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Set nonzero energy to linearize for CCOR (2nd gen ASA 2C hamiltonian)</TD>
   </TR>
-->

   <TR>
   <TD bgcolor="e5e1ff"> ASA_NEWREP </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> NC</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Set to 1 to rotate structure constants to a user-specified representation.
           It requires special compilation to be effective</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ASA_NOHYB </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> NC</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Set to 1 to turn off hybridization</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ASA_MTCOR </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> NC</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Set to T to turn on Ewald MT correction</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ASA_QMT </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> NC</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Override standard background charge for Ewald MT correction<br>
   Input only meaningful if MTCOR=T</TD>
   </TR>
   </TBODY>
 </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- CONST (lmstr) -->
 <H3><A name="CONSTcat"></A>
<FONT size="+2"><tt>CONST</tt></FONT> category
</H3>

Category <FONT size="+1"><tt>CONST</tt></FONT> enables the user to declare variables for use in
algebraic expressions.  The syntax is a string of declarations
inside the category, e.g:

<pre>
CONST   a=10.69 nspec=4+2
</pre>

Variables declared this way are similar to, but distinct from
variables declared for the preprocessor, such as <br>
<FONT size="+1"><tt>% const nbas=5</tt></FONT> <br>

In the latter case the preprocessor makes a pass, and may use
expressions involving variables declared by e.g. <FONT size="+1"><tt>"%
const nbas=5"</tt></FONT> to alter the structure of the input file.
Variables declared for use by the preprocessor lose their definition after
the preprocessor completes.

<br><br>

Variables in CONST are declared after the preprocessor has completed;
They are available for use by the input file.

<br>
The following code segment illustrates both types:

<pre>
% const nbas=5
CONST   a=10.69 nspec=4
SPEC    ALAT=a  NSPEC=nspec NBAS={nbas}
</pre>

After the preprocessor comples, the input file appears as:

<pre>
CONST   a=10.69 nspec=4
SPEC    ALAT=a  NSPEC=nspec NBAS=5
</pre>

When the CONST category is read (it is read before other categories),
variables <FONT size="+1"><tt>a</tt></FONT> and <FONT
size="+1"><tt>nspec</tt></FONT> are defined and used in the SPEC category.

<P> Go to <A href=#contents>Table of Contents</A>

 <!-- PGF -->
 <H3><A name="PGFcat"></A>
<FONT size="+2"><tt>PGF</tt></FONT> category
</H3>
Category <FONT size="+1"><tt>PGF</tt></FONT> concerns <A href="pgf.pdf">layer Green's function
     calculations</A> by the layer Green's function program <b>lmpg</b>.
     It is read by <b>lmpg</b> and <b>lmstr</b>.
<P>
 <TABLE border="1">
  <TBODY>
        <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
    <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

 <TR>
   <TD bgcolor="e5e1ff"> MODE </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   &nbsp&nbsp&nbsp;0: do nothing<br>
   &nbsp&nbsp&nbsp;1: diagonal layer GF<br>
   &nbsp;&nbsp;&nbsp;<FONT color="#3300bb"><I>Examples</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>pgf/test/test.pgf -all 5</tt></FONT>&nbsp;&nbsp; and &nbsp;&nbsp; <FONT size="+1"><tt>pgf/test/test.pgf -all 6</tt></FONT><br>
   &nbsp&nbsp&nbsp;2: left- and right-bulk bulk GF<br>
   &nbsp&nbsp&nbsp;3: find <i>k</i>(<i>E</i>) for left bulk<br>
   &nbsp;&nbsp;&nbsp;<FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>pgf/test/test.pgf 2</tt></FONT><br>
   &nbsp&nbsp&nbsp;4: find <i>k</i>(<i>E</i>) for right bulk<br>
   &nbsp&nbsp&nbsp;5: Calculate ballistic current<br>
   &nbsp;&nbsp;&nbsp;<FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>pgf/test/test.pgf femgo</tt></FONT><br>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SPARSE </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   &nbsp&nbsp&nbsp;0: Calculate <i>G</i> layer by layer using Dyson's equation<br>
   &nbsp;&nbsp;&nbsp;<FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>pgf/test/test.pgf -all 5</tt></FONT><br>
   &nbsp&nbsp&nbsp;1: Calculate <i>G</i> using LU decomposition<br>
   &nbsp;&nbsp;&nbsp;<FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>pgf/test/test.pgf -all 6</tt></FONT><br>
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> PLATL </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   The third lattice vector of left bulk region</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> PLATR </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   The third lattice vector of right bulk region</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> GFOPTS </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   ASCII string with switches governing execution of <b>lmgf</b> or <b>lmpg</b>.  Use `<FONT size="+1"><tt>;</tt></FONT>' to separate the switches.
   <br> Available switches:
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>p1</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; First order of potential function
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>p3</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Third order of potential function
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>pz</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exact potential function (some problems; not recommended
     <br>&nbsp;&nbsp;   Use only one of the above; if none are used, the code makes second order potential functions

     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>idos</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;        integrated DOS (by principal layer in the <b>lmpg</b> case)
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>noidos</tt></FONT>'                              suppress calculation of integrated DOS
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>pdos</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;        accumulate partial DOS
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>emom</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;        accumulate output moments; use '<FONT size="+1"><tt>noemom</tt></FONT>' to suppress
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>noemom</tt></FONT>'      suppresss accumulation of output moments
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>sdmat</tt></FONT>'&nbsp;&nbsp;                   make site density-matrix
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>dmat</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp;        make density-matrix
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>frzvc</tt></FONT>'&nbsp;&nbsp;                   do not update potential shift needed to obtain charge neutrality
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>padtol</tt></FONT>'                              Tolerance in Pade correction to charge.  If tolerance exceeded,
     <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                                                              <b>lmgf</b> will repeat the band pass with an updated Fermi level
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>omgtol</tt></FONT>' (CPA) &nbsp;&nbsp; tolerance criterion for convergence in coherent potential
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>omgmix</tt></FONT>' (CPA) &nbsp;&nbsp; linear mixing parameter for iterating convergence in coherent potential
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>nitmax</tt></FONT>' (CPA) &nbsp;&nbsp; maximum number of iterations to iterate for coherent potential
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>lotf</tt></FONT>'&nbsp;&nbsp;&nbsp;&nbsp; (CPA)
     <br>&nbsp;&nbsp;   '<FONT size="+1"><tt>dz</tt></FONT>'&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (CPA)

   </TD>
   </TR>

   </TBODY>
   </TABLE>

<!-- SITE -->
<H3><A name="SITEcat"></A>
<FONT size="+2"><tt>SITE</tt></FONT> category
</H3>
Category <FONT size="+1"><tt>SITE</tt></FONT> holds site information.  As in the <FONT size="+1"><tt>SPEC</tt></FONT> category,
 tokens must read for each site entry, and a similar restriction
 applies as to the order of tokens.  Token <FONT size="+1"><tt>ATOM=</tt></FONT> must be the
 first token for each site, and all tokens defining parameters
 for that site must occur before a subsequent <FONT size="+1"><tt>ATOM=</tt></FONT>.
<P>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">FILE </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
    Provides a mechanism to read site data from a separate file.  File
          <A href="../subs/iosite.f">subs/iosite.f</A> documents the syntax of the <FONT size="+1"><tt>site</tt></FONT> file structure.
          The reccommended (standard) format has the following syntax: <br>

          The first line should contain a '%' in
          the first column, and a `version' token vn=#.
          Structural data (see category <A href="#STRUCcat">STRUC</A> documentation)
          may also be put this line.  Each subsequent line supplies
          input for one site.  In the simplest format, a line would
          would have the following:<br>
            &nbsp&nbsp&nbsp;<FONT size="+1"><tt>spid   x y z</tt></FONT><br>
          where spid is the species identifier (same information
          would otherwise be specified by token ATOM= below)
          and x y z are the site positions.<br><br>

         <FONT color="#3300bb"><I>Examples</I>&nbsp;:&nbsp;</FONT>
         <FONT size="+1"><tt>fp/test/test.fp er</tt></FONT>
         &nbsp;&nbsp; and &nbsp;&nbsp;
         <FONT size="+1"><tt>fp/test/test.fp tio2</tt></FONT><br><P>

          Bug: when you read site data from an alternate file, the
          reader doesn't compute the reference energy.<br><br>

          <i>Kotani format</i>&nbsp&nbsp&nbsp; (documented here but no longer maintained) In this alternative format the first four lines always specify data read
          in the STRUC category; see FILE= in <A href="#STRUCcat">STRUC</A>.
          Then follow lines, one line for each site<br>
             &nbsp&nbsp&nbsp;<FONT size="+1"><tt>ib iclass spid x y z</tt></FONT><br>
          The first number is merely a basis index and should
          increment 1,2,3,4,... in successive lines.  The second class
          index is ignored by these programs.  The remaining columns
          columns are the species identifier the site positions.<br><br>

          If <FONT size="+1"><tt>SITE_FILE</tt></FONT> is missing, the
          following are read from the <FONT size="+1"><tt>ctrl</tt></FONT> file:
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Identifies the species (by label) to which this atom belongs.  It is a
   fatal error for the species not to have been defined.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM_POS </TD>
   <TD bgcolor="feffe1"><PRE> r1 r2 r3</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   the basis vector (length 3), in dimensionless Cartesian coordinates.  As with the
          primitive lattice translation vectors, the true vectors (in
          atomic units) are scaled from these by ALAT in category
          STRUC.<br>
   NB: <FONT size="+1"><tt>XPOS</tt></FONT> and <FONT size="+1"><tt>POS</tt></FONT> are alternative forms of input.  One or the other is required.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATMOM_XPOS </TD>
   <TD bgcolor="feffe1"><PRE> r1 r2 r3</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Atom coordinates, as (fractional) multiples of the lattice vectors. <br>
   NB: <FONT size="+1"><tt>XPOS</tt></FONT> and <FONT size="+1"><tt>POS</tt></FONT> are alternative forms of input.  One or the other is required.</TD>

   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM_DPOS </TD>
   <TD bgcolor="feffe1"><PRE> r1 r2 r3</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0 0</TD>
   <TD bgcolor="feffe1">
   Shift in atom coordinates added to <FONT size="+1"><tt>POS</tt></FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM_RELAX </TD>
   <TD bgcolor="feffe1"><PRE> i1 i2 i3</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff">1 1 1</TD>
   <TD bgcolor="feffe1">
   relax site positions (lattice dynamics or molecular statics) or Euler angles (spin dynamics)</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM_RMAXS </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> FP</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Site-dependent radial cutoff for structure constants, in a.u.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM_ROT </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Rotation of spin quantization axis at this site</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM_PL </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> <FONT size="+1"><tt>lmpg</tt></FONT></TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   (lmpg) Assign principal layer number to this site</TD>
   </TR>

   </TBODY>
 </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- SPEC -->
<H3><A name="SPECcat"></A>
<FONT size="+2"><tt>SPEC</tt></FONT> category
</H3>

Category <FONT size="+1"><tt>SPEC</tt></FONT> contains species-specific information.  Because
 data must be read for each species, tokens are repeated (once
 for each species).  For that reason, there is some restriction
 as to the order of tokens.  Data for a specific species
 (<FONT size="+1"><tt>Z=, R=, R/W=, LMX=, IDXDN=</tt></FONT> and the like described below)
 begins with a token <FONT size="+1"><tt>ATOM=</tt></FONT>; input of tokens specific to that
 species must precede the next occurence of <FONT size="+1"><tt>ATOM=</tt></FONT>.
<P>
 The following four species apply to the automatic sphere resizer:
 <TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SCLWSR </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   <FONT size="+1"><tt>SCLWSR>0</tt></FONT> turns on the <A href="lmto.html#section8.1">automatic sphere resizer</A>.
           It defaults to 0, which turns off the resizer.
           The 10's digit tells the resizer how to deal with resizing
           empty spheres; see <A href="lmto.html#section8.1">lmto.html</A>.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> OMAX1 </TD>
   <TD bgcolor="feffe1"><PRE> r1 r2 r3</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.16,<br>0.18,<br>0.2</TD>
   <TD bgcolor="feffe1">
   Constrains maximum allowed values of sphere overlaps.
           You may input up to three numbers, which correspond to
           atom-atom, and atom-empty-sphere, and empty-sphere-empty-sphere
           overlaps respectively.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> OMAX2 </TD>
   <TD bgcolor="feffe1"><PRE> r1 r2 r3</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.4,<br>0.45,<br>0.5</TD>
   <TD bgcolor="feffe1">
   Constrains maximum allowed values of sphere overlaps defined
           differently from <FONT size="+1"><tt>OMAX1</tt></FONT>; see <A href="lmto.html#section8.1">lmto.html</A>.<br>
           Both constraints are applied.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> WSRMAX </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Imposes an upper limit to any one sphere radius</TD>
   </TR>
   </TBODY>
   </TABLE>
   <br>
   <br>
   The following tokens are input for each species.  Data sandwiched between successive
   occurences of <FONT size="+1"><tt>ATOM</tt></FONT> apply to one species.

<P>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff">ATOM </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   A character string (8 characters or fewer) that labels this
         species.  This label is used, e.g. by the <FONT size="+1"><tt>SITE</tt></FONT>
         category to associate a species with an atom at a given site.
         Species are split into classes; how and when this is done depends
         whether you are using an ASA or full-potential implementation.

         <br><FONT color="#3300bb"><I>ASA-specific</I>&nbsp;:&nbsp;</FONT>
          The species ID also names a disk file with information
          about that atom (potential parameters, moments, potential
          and some sundry other information).  More precisely, species are split into classes,
          the program differentiates class names by appending integers to the species label.
          The first class associated with the species has the species label; subsequent ones have integers appended.<br>

          <FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
          <FONT size="+1"><tt>testing/test.ovlp 3</tt></FONT><br>

   </TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> Z </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Nuclear charge.  Normally an integer, but <FONT size="+1"><tt>Z</tt></FONT> <i>can</i> be a fractional number.  A fractional number
   implies a virtual crystal approximation to an alloy
   with some <i>Z</i> intermediate between the two integers sandwiching it.
   </TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> R </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   The augmentation sphere radius, in atomic units.  This is a required input for most programs:
   choose one of <FONT size="+1"><tt>R=</tt></FONT>, <FONT size="+1"><tt>R/W=</tt></FONT> or
   <FONT size="+1"><tt>R/A=</tt></FONT>.  Read descriptions of the latter two below for further remarks;
   also see <A href="lmto.html#section8">this page</A> for a more complete discussion on the choice of sphere radii.

   <br><br><A href="Command-line-options.html#section1lmchk"><b>lmchk</b></A> can
   <A href="lmto.html#section8.2">find sphere radii
   automatically</A> for you.  Invoke <b>lmchk</b> with
   <A href="Command-line-options.html#section1lmchk">--getwsr</A>.
   You can also <A href="lmto.html#section8.1">rescale user-chosen radii to meet constraints</A>.
   with the <FONT size="+1"><tt>SCLWSR</tt></FONT> token.

   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> R/W </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
           <FONT size="+1"><tt>R/W=</tt></FONT> ratio of the augmentation sphere radius to the average Wigner Seitz radius <FONT size="+1"><tt>W</tt></FONT>.
           <FONT size="+1"><tt>W</tt></FONT> is the radius of a sphere such that
           (4&pi;<i>W</i><sup>3</sup>/3) = <i>V</i>/<i>N</i>, where <i>V</i>/<i>N</i> is the volume per atom.
           Thus if all radii are equal with <FONT size="+1"><tt>R/W=1</tt></FONT>, the sum of sphere volumes
           would fill space, as is usual in the ASA.

           <br><FONT color="#3300bb"><I>ASA-specific</I>&nbsp;:&nbsp;</FONT>
           You must choose the radii so that the sum of sphere volumes
           (4&pi;/3&Sigma;<sub><i>i</i></sub><i>R</i><sub><i>i</i></sub><sup>3</sup>)
           equals the unit cell volume <i>V</i>; otherwise results may
           become unreliable.  The space-filling requirement means
           sphere may overlap quite a lot, particularly in open
           systems.  If sphere overlaps get too large, (&gt;20% or so) accuracy
           becomes an issue.  In such a case you should add "empty
           spheres" to fill space.  Use <b>lmchk</b> to print out sphere overlaps.
           <b>lmchk</b> also has an automatic empty spheres finder, which you invoke
           with the <A href="Command-line-options.html#section1lmchk">--findes</A> switch;
           see <A href="lmto.html#section8.3">here</A> for a discussion.<br>

          <FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
          <FONT size="+1"><tt>testing/test.ovlp 3</tt></FONT>

           <br><FONT color="#3300bb"><I>FP-specific</I>&nbsp;:&nbsp;</FONT>
           FP results are much less sensitive to the choice of sphere
           radii.  Strictly, the spheres should not overlap, but because
           of <b>lmf</b>'s unique <A href="#fnlmf">augmentation scheme</A>,
           overlaps of up to 10% cause negligibly small errors as a rule.
           (This does not apply to <i>GW</i> calculations!)
           Even so, it is not advisable to let the overlaps get too large.
	   As a general rule the <i>L</i>-cutoff should increase
           as the sphere radius increases.  Also it has been found in practice that
           self-consistency is harder to accomplish when spheres overlap significantly.

   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> R/A </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">

   <FONT size="+1"><tt>R/A=</tt></FONT> ratio of the augmentation sphere radius to the lattice constant.
   </TD>
   </TR>

   <TR>
   <A name="SPECcata"></A>
   <TD bgcolor="e5e1ff"> A </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Radial mesh point spacing parameter.  All programs dealing with
   augmentation spheres represent the density on a shifted logarithmic
   radial mesh.  The <i>i</i><sup>th</sup> point on the mesh is
   <i>r<sub>i</sub></i> = <i>b</i>[exp(<i>a</i>(<i>i</i>&minus;1)&minus;1].  <i>b</i> is determined from
   the number of radial mesh points specified by <FONT size="+1"><tt>NR</tt></FONT>.
</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> NR </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> Depends <br> on other <br> input</TD>
   <TD bgcolor="feffe1">
   Number of radial mesh points</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> LMX </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">basis <i>l</i>-cutoff inside the sphere.  If not specified,
           it defaults to <FONT size="+1"><tt>NL&minus;1</tt></FONT></TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> RSMH </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Smoothing radii defining basis, one radius for each <i>l</i>.
   <FONT size="+1"><tt>RSMH</tt></FONT> and <FONT size="+1"><tt>EH</tt></FONT> together define the shape of basis function in <b>lmf</b>.
To automate selection, see
   <A href="Building_FP_input_file.html">Building_FP_input_file.html</A>.
   To optimize, try running <b>lmf</b> with <FONT size="+1"><tt>--optbas</tt></FONT> or see
   <A href="FPoptbas.html">FPoptbas.html</A>.
   </TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> EH </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Hankel energies for basis, one energy for each <i>l</i>.  <FONT size="+1"><tt>RSMH</tt></FONT> and <FONT size="+1"><tt>EH</tt></FONT> together define the shape of basis function in <b>lmf</b>.
   To automate selection, see
   <A href="Building_FP_input_file.html">Building_FP_input_file.html</A>.
   To optimize, see
   <A href="FPoptbas.html">FPoptbas.html</A>.
   </TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> RSMH2 </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Basis smoothing radii, second group</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> EH2 </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Basis Hankel function energies, second group</TD>
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">LMXA </TD>
   <TD bgcolor="#feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="#e5e1ff">FP </TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff">NL-1 </TD>
   <TD bgcolor="feffe1">
           angular momentum <I>l</I>-cutoff for projection of wave functions tails
           centered at other sites in this sphere.
           Must be at least the basis <I>l</I>-cutoff (specified by <FONT size="+1"><tt>LMX=</tt></FONT>).
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> IDXDN </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
   a set of integers, one for each <i>l</i>-channel marking which
           orbitals should be downfolded.<br>
           &nbsp&nbsp&nbsp;0 use automatic downfolding in this channel.<br>
           &nbsp&nbsp&nbsp;1 leaves the orbitals in the basis.<br>
           &nbsp&nbsp&nbsp;2 folds down about the inverse potential function at E<sub>&nu;</sub> <br>
           &nbsp&nbsp&nbsp;3 folds down about the screening constant <FONT size="+1"><tt>alpha</tt></FONT>.<br>
           In the FP case, 1 includes the orbital in the basis;&nbsp; &gt;1 removes it</TD>

   </TR>


   <TR>
   <TD BGCOLOR="#E5E1FF">KMXA </TD>
   <TD bgcolor="#feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff">3 </TD>
   <TD bgcolor="feffe1">
           Polynomial cutoff for projection of wave functions in sphere.
           Smoothed Hankels are expanded in polynomials around other sites
           instead of Bessel functions as in the case of normal Hankels.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">RSMA </TD>
   <TD bgcolor="#feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> R*0.4</TD>
   <TD bgcolor="feffe1">
           Smoothing radius for projection of smoothed Hankel tails into
           augmentation spheres.  sm-Hankels are expanded in polynomials by
           integrating with Gaussians at that site.  Thus RSMA=0 =>
           sm-Hankels Taylor series expansion about the origin.  For large
           KMXA the choice is irrelevant, but RSMA is best chosen that
           maximizes the convergence of sm-Hankels with KMXA.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">LMXL </TD>
   <TD bgcolor="#feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> NL-1</TD>
   <TD bgcolor="feffe1">
           Angular momentum <I>l</I>-cutoff for explicit representation of local
           charge on a radial mesh.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">RSMG </TD>
   <TD bgcolor="#feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmf,<br>lmfgwd</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> R/4</TD>
   <TD bgcolor="feffe1">
           Smoothing radius for Gaussians added to sphere densities to correct
           multipole moments needed for electrostatics.  Value should be as
           large as possible but small enough that the Gaussian doesn't spill
           out significantly beyond rmt.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">LFOCA </TD>
   <TD bgcolor="#feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="#e5e1ff"> FP</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
           Prescribes how the core density is treated.
<DD>
           &nbsp&nbsp&nbsp;0 confines core to within RMT.  Usually the least accurate.
<DD>
           &nbsp&nbsp&nbsp;1 treats the core as frozen but lets it spill into the interstitial
<DD>
           &nbsp&nbsp&nbsp;2 same as 1, but interstitial contribution to vxc treated perturbatively.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">RFOCA </TD>
   <TD bgcolor="#feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="#e5e1ff">FP </TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> R*0.4</TD>
   <TD bgcolor="feffe1">
           Smoothing radius fitting tails of core density.  A large radius
           produces smoother interstitial charge, but less accurate fit.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">RSMFA </TD>
   <TD bgcolor="#feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="#e5e1ff"> FP</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> R/2</TD>
   <TD bgcolor="feffe1">
           Smoothing radius for tails of free-atom charge density.
           Irrelevant except first iteration only (non-self-consistent harris).
           A large radius produces smoother interstitial charge, but somewhat
           less accurate fit.
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> RS3 </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> FP</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
   Minimum allowed smoothing radius for local orbital</TD>
   </TR>

 <TR>
   <TD bgcolor="e5e1ff"> HCR </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lm</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Hard sphere radii for structure constants<br>
   *If token is not parsed, attempt to read the following:</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> HCR/R </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lm</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.7</TD>
   <TD bgcolor="feffe1">
   Hard sphere radii for structure constants, in units of R</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> ALPHA </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Screening parameters for structure constants</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> DV </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Artificial constant potential shift added to spheres belonging to this species</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> MIX </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Set to suppress self-consistency of classes in this species</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> IDMOD </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   &nbsp;0 : floats log derivative parameter <A href="lmto.html#sectionpq"><i>P<sub>l</sub></i></A> to band center of gravity<br>
   &nbsp;1 : freezes <i>P<sub>l</sub></i><br>
   &nbsp;2 : freezes linearization energy <i>E</i><sub>&nu;</sub>.</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> CSTRMX </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Set to T to exclude this species when automatically resizing sphere radii</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> GRP2 </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
    Species with a common nonzero value of GRP2 are symmetrized, independent of
    symmetry operations. <br>
    The sign of GRP2 is used as a switch, so species with negative
    GRP2 are symmetrized but with spins flipped (<FONT size="+1"><tt>NSPIN</tt></FONT>=2)
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> FRZWF </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> FP</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Set to freeze augmentation wave functions for this species</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> IDU </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0 0 0</TD>
   <TD bgcolor="feffe1">
   LDA+U mode:<br>
   &nbsp&nbsp&nbsp;0 No LDA+U<br>
   &nbsp&nbsp&nbsp;1 LDA+U with Around Mean Field limit double counting<br>
   &nbsp&nbsp&nbsp;2 LDA+U with Fully Localized Limit double counting<br>
   &nbsp&nbsp&nbsp;3 LDA+U with mixed double counting</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> UH </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0 0 0</TD>
   <TD bgcolor="feffe1">
   Hubbard U for LDA+U</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff"> JH </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0 0 0 0</TD>
   <TD bgcolor="feffe1">
   Exchange parameter J for LDA+U</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff">EREF= </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Reference energy subtracted from total energy</TD>
   </TR>

    <TR>
   <TD bgcolor="e5e1ff">AMASS= </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> FP</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Nuclear mass in a.u. (for dynamics)</TD>
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">C-HOLE </TD>
   <TD bgcolor="#feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="#e5e1ff"> lmf,lm</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
           channel for core hole.  You can force partial core occupation.
           Syntax consists of two characters, the principal quantum number and
           the second one of `s',`d',`d',`f' for the <I>l</I> quantum number, e.g. `2s'
           See <A href="fp.html#corehole">Partially occupied core holes</A> for description and examples. <BR>
           Default: nothing
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">C-HQ </TD>
   <TD bgcolor="#feffe1"><PRE> r[,r]</PRE></TD>
   <TD bgcolor="#e5e1ff"> ALL</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> -1 0</TD>
   <TD bgcolor="feffe1">
           First number specifies the number of electrons to remove from the <I>l</I>
           channel specified by C-HOLE=.  <BR>
           Second (optional) number specifies the hole magnetic moment.  <BR>
           See <A href="fp.html#corehole">Partially occupied core holes</A> for description and examples.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">P </TD>
   <TD bgcolor="#feffe1"><PRE> r,r,...</PRE></TD>
   <TD bgcolor="#e5e1ff"> ALL</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
           starting values for potential functions, one for each of <I>l</I>=0..LMXA
   <BR>
           Default: taken from an internal table.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">PZ </TD>
   <TD bgcolor="#feffe1"><PRE> r,r,...</PRE></TD>
   <TD bgcolor="#e5e1ff"> FP</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff">0 </TD>
   <TD bgcolor="feffe1">
           starting values for local orbital's potential functions,
           one for each of <I>l</I>=0..LMX.  Setting PZ=0 for any
           <I>l</I> means that no local orbital is specified for this
           <I>l</I>.  Each integer part of PZ must be either one less
           than P (semicore state) or one greater (high-lying state).
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">Q </TD>
   <TD bgcolor="#feffe1"><PRE> r,r,...</PRE></TD>
   <TD bgcolor="#e5e1ff"> ALL</TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
           charges for each <I>l</I>-channel making up free-atom density
   <BR>
           Default: taken from an internal table.
   </TR>

   <TR>
   <TD BGCOLOR="#E5E1FF">MMOM </TD>
   <TD bgcolor="#feffe1"><PRE> r,r,...</PRE></TD>
   <TD bgcolor="#e5e1ff">ALL </TD>
   <TD bgcolor="#feffe1">Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
           magnetic moments for each <I>l</I>-channel making up free-atom density
           Relevant only for the spin-polarized case.
   </TR>
   </TBODY>
 </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- STR -->
<H3><A name="STRcat"></A>
<FONT size="+2"><tt>STR</tt></FONT> category
</H3>
Category <FONT size="+1"><tt>STR</tt></FONT> contains information connected with real-space structure
 constants, used by the ASA programs.  It is read by <b>lmstr</b>,
 <b>lmxbs</b>, <b>lmchk</b>, and <b>tbe</b>.
<P>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> RMAXS </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Radial cutoff for strux, in a.u.<br>
   If token is not parsed, attempt to read the following:</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> RMAX </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   the maximum sphere radius (in units of the average WSR)
          over which neighbors will be included in the generation
          of structure constants.  This takes a default value and
          is not required input.  It is an interesting exercise
          to see how much the structure constants and eigenvalues
          change when this radius is increased.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> NEIGHB </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> FP</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 30</TD>
   <TD bgcolor="feffe1">
   Minimum number of neighbors in cluster</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ENV_MODE </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Type of envelope functions:<br>
   &nbsp&nbsp&nbsp;0 2nd generation<br>
   &nbsp&nbsp&nbsp;1 SSSW (3rd generation)<br>
   &nbsp&nbsp&nbsp;2 NMTO<br>
   &nbsp&nbsp&nbsp;3 SSSW and val-lap basis</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ENV_NEL </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lm,<br>lmstr</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   (NMTO only) Number of NMTO energies</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ENV_EL </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lm,<br>lmstr</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   SSSW of NMTO energies, in a.u.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> DELRX </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 3</TD>
   <TD bgcolor="feffe1">
   Range of screened function beyond last site in cluster</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> TOLG </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> FP</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1e-6</TD>
   <TD bgcolor="feffe1">
   Tolerance in <tt>l=0</tt> gaussians, which determines their range</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> RVL/R </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.7</TD>
   <TD bgcolor="feffe1">
   Radial cutoff for val-lap basis (this is experimental)</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> VLFUN </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Functions for val-lap basis (this is experimental)<br>
    &nbsp&nbsp&nbsp;0 G0 + G1<br>
    &nbsp&nbsp&nbsp;1 G0 + Hsm<br>
    &nbsp&nbsp&nbsp;2 G0 + Hsm-dot</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> MXNBR </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
  make lmstr allocate enough memory in dimensioning
          arrays for MXNBR neighbors in the neighbor table.  This
          is rarely needed</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SHOW </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> lmstr</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Show strux after generating them</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> EQUIV </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> lmstr</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   if true, try to find equivalent neighbor tables, to
          reduce the computational effort in generating strux.
          Not generally recommended</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> LMAXW </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmstr</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> -1</TD>
   <TD bgcolor="feffe1">
   l-cutoff for (optional) Watson sphere, used to help
          localize strux</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> DELRW </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmstr</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0.1</TD>
   <TD bgcolor="feffe1">
   range extending beyond cluster radius for Watson sphere</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">IINV_NIT= </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmstr</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Number of iterations</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> IINV_NCUT </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> lmstr</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Number of sites for inner block</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> IINV_TOL </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> lmstr</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   Tolerance in errors</TD>
   </TR>

   </TBODY>
 </TABLE>
 <br>
 *IINV parameters govern iterative solutions to screened strux<br><br>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- START -->
<H3><A name="STARTcat"></A>
<FONT size="+2"><tt>START</tt></FONT> category
</H3>
Category <FONT size="+1"><tt>START</tt></FONT> is specific to the ASA.
 It controls whether the code starts with moments <FONT size="+1"><tt>P,Q</tt></FONT> or potential
 parameters; also the moments <FONT size="+1"><tt>P,Q</tt></FONT> may be input in this category.
 It is read by
<b>lm</b>,
<b>lmgf</b>,
<b>lmpg</b>,
and <b>tbe</b>.

<P>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> BEGMOM </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 1</TD>
   <TD bgcolor="feffe1">
   when true, causes program <b>lm</b> to begin with moments from
          which potential parameters are generated.  If false,
          the potential parameters are used and the program
          proceeds directly to the band calculation.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> FREE </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   is intended to facilitate a self-consistent free-atom
          calculation.  When FREE is true, the program uses
          rmax=30 for the sphere radius rather than whatever rmax
          is passed to it; the boundary conditions at rmax are
          taken to be value=slope=0 (rmax=30 should be large
          enough that these boundary conditions are sufficiently
          close to that of a free atom.); subroutine atscpp does
          not calculate potential parameters or save anything to
          disk; and <b>lm</b> terminates after all the atoms
          have been calculated.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> CNTROL </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">

   When <FONT size="+1"><tt>CONTRL=T</tt></FONT>, the parser attempts to read the ``<A href="lmto.html#section2">continuously variable principal quantum numbers</A>'' <FONT size="+1"><tt>P</tt></FONT> and moments <A href="lmto.html#section2"><FONT size="+1"><tt><FONT size="+1"><tt>Q0,Q1,Q2</tt></FONT></tt></FONT></A>
   for each <i>l</i> channel; see <FONT size="+1"><tt>P,Q</tt></FONT> below.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Class label.  <FONT size="+1"><tt>P,Q</tt></FONT> (and possibly other data) is given by class.
   Tokens following a class label and preceding the next class label belong to that class.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM_P= <br> and <br> ATOM_Q </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">

   Read ``<A href="lmto.html#section2">continuously variable principal
   quantum numbers</A>''  for this
   class (<FONT size="+1"><tt>P=...</tt></FONT>), or energy
   moments <FONT size="+1"><tt>Q0,Q1,Q2</tt></FONT> (<FONT size="+1"><tt>Q=...</tt></FONT>).  <FONT size="+1"><tt>P</tt></FONT>
   consists of one number per <i>l</i>
   channel, <FONT size="+1"><tt>Q</tt></FONT> of three numbers
   (<FONT size="+1"><tt>Q0,Q1,Q2</tt></FONT>) for each <i>l</i>.

   <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT> In spin
   polarized calculations, a second set of parameters must follow the
   first, and the moments should all be half of what they are in
   non-spin polarized calculations.

   <P> In <A href="input-file-style.html#sampleinput">this sample input file</A> for Si, <FONT size="+1"><tt>P,Q</tt></FONT> is given as:
<pre>
      ATOM=SI  P=3.5 3.5 3.5    Q=1 0 0    2 0 0   0 0 0
      ATOM=ES  P=1.5 2.5 3.5    Q=.5 0 0  .5 0 0   0 0 0
</pre>
   One electron is put in the Si <i>s</i> orbital, 2 in the <i>p</i> and
   none in the <i>d</i>, while 0.5 electrons are put in the <i>s</i> and
   p channels for the empty sphere.  All first and second
   moments are zero.  This rough guess produces
   a correspondingly rough potential.

   <P> You do not have to supply information here for
   every class; but for classes you do, you must supply all
   of (<FONT size="+1"><tt>P,Q0,Q1,Q2</tt></FONT>). Data read in <FONT size="+1"><tt>START</tt></FONT>
   supersedes whatever may have read from disk.


   <A href="#STARTcatPQ">Remarks below</A> provide further information about how <FONT size="+1"><tt>P,Q</tt></FONT> is read and printed.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> RDVES </TD>
   <TD bgcolor="feffe1"><PRE> l</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> F</TD>
   <TD bgcolor="feffe1">
   Read Ves(RMT) from the <FONT size="+1"><tt>START</tt></FONT> category along with <FONT size="+1"><tt>P,Q</tt></FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ATOM_ENU </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ASA</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Linearization energies</TD>
   </TR>

   </TBODY>
 </TABLE>

<h4><A name="STARTcatPQ">How the parser reads <FONT size="+1"><tt>P,Q</tt></FONT></A></h4>

Remember that knowledge of <FONT size="+1"><tt>P,Q</tt> is
<A href="lmto.html#section2">sufficient to completely determine the ASA density.</FONT></A>
Thus the ASA codes use several ways to read these important quantities.

<P> The parser returns <FONT size="+1"><tt>P,Q</tt></FONT> according the following priorities:

<UL>

<LI> <FONT size="+1"><tt>P,Q</tt></FONT> are read from the disk, if supplied, (along possibly with other quantities such as potential parameters <i>E<sub>l</sub></i>, <i>C</i>, &Delta;, &gamma;.)&nbsp;
One file is created for each class that contains this data and other class-specific information.  Some or all of the data may be missing from the disk files.

<P> Alternatively, you may read these data from a restart file <FONT size="+1"><tt>rsta.<i>ext</i></tt></FONT>, which if it exists contains data for all classes in one file.
The program wil not read this data by default; use <FONT size="+1"><tt>--rs=1</tt></FONT> to have it read from the <FONT size="+1"><tt>rsta</tt></FONT> file.
To <i>write</i> class data to <FONT size="+1"><tt>rsta</tt></FONT>, use&nbsp; <FONT size="+1"><tt>--rs=*,1</tt></FONT> (<FONT size="+1"><tt>*</tt></FONT> must be be 0 or 1).

<LI> If <FONT size="+1"><tt>START_CONTRL=T</tt></FONT>,&nbsp; <FONT size="+1"><tt>P,Q</tt></FONT> (and possibly other quantities) are read from <FONT size="+1"><tt>START</tt></FONT> for classes you supply (usually all classes). Data read from this category supersedes any that might have been read from disk.

<P> If class data read from either of these sources, the input system returns it.  For classes where none is available the parser will pick a default:

<LI> If data from a different class but in the same species is available, use it.

<P>
<LI> Otherwise use some preset default values for <FONT size="+1"><tt>P,Q</tt></FONT>.

</UL>

<P> After a calculation finishes you can run <b>lmctl</b> to
   read <FONT size="+1"><tt>P,Q</tt></FONT> from disk and format it
   in a form ready to insert into the <FONT size="+1"><tt>START</tt></FONT> category.  Thus all the
   information needed to generate a self-consistent ASA calculation
   can be contained in the <FONT size="+1"><tt>ctrl</tt></FONT> file.

<P>When the <A href="input-file-style.html#sampleinput">sample Si test</A> is run to self-consistency, invoking <b>lmctl</b> will generate something like:
<pre>
ATOM=SI       P=  3.8303101  3.7074067  3.2545634
              Q=  1.1694276  0.0000000  0.0297168
                  1.8803181  0.0000000  0.0489234
                  0.1742629  0.0000000  0.0063520
ATOM=ES       P=  1.4162942  2.2521617  3.1546386
              Q=  0.2873686  0.0000000  0.0129888
                  0.3485430  0.0000000  0.0165416
                  0.1400664  0.0000000  0.0055459
</pre>
Because the <FONT size="+1"><tt>P</tt></FONT>'s float to the band center-of gravity
(i.e. center of gravity of the occupied states for a particular site and <i>l</i> channel)
the corresponding first moments <FONT size="+1"><tt>Q1</tt></FONT> vanish.
<FONT size="+1"><tt>P</tt></FONT>'s are floated by default since it minimizes the linearization error.

<br><FONT color="#ff3322"> Caution: Sometimes it is necessary to
override this default: If the band CG (of the occupied states) is far
removed the natural CG of the particular channel, you must restrict
how far <FONT size="+1"><tt>P</tt></FONT> and be shifted to the band
CG.  In some cases, allowing P to float completely will result in "ghost bands".

The high-lying Ga 4<i>d</i> state is a classic example.  To restrict <FONT size="+1"><tt>P</tt></FONT> to a fixed value, see <FONT size="+1"><tt>SPEC_IDMOD</tt></FONT>.
In such cases, you want to pick <FONT size="+1"><tt>P</tt></FONT> low, but not so low as to cause problems.
See <A href="lmto.html#pbasp2">this link</A> for further description.

</FONT>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- STRUC -->
<H3><A name="STRUCcat"></A>
<FONT size="+2"><tt>STRUC</tt></FONT> category
</H3>
<TABLE border="1">
  <TBODY>
   <TR>
     <TD bgcolor="#000000"><FONT color="#ffffff">Token </FONT></TD>
     <TD bgcolor="#000000"><FONT color="#ffffff">Arguments
     <TD bgcolor="#000000"><FONT color="#ffffff">Program
     <TD bgcolor="#000000"><FONT color="#ffffff">Optional
     <TD bgcolor="#000000"><FONT color="#ffffff">Default
     <TD bgcolor="#000000"><FONT color="#ffffff">Explanation</FONT></TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> FILE </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">

   provides a mechanism to read structural data from an independent file using alternate input styles.
   If <FONT size="+1"><tt>SITE</tt></FONT> is not present in the <FONT size="+1"><tt>STRUC</tt></FONT> category, <FONT size="+1"><tt>NBAS</tt></FONT>, <FONT size="+1"><tt>PLAT</tt></FONT> and <FONT size="+1"><tt>ALAT</tt></FONT> are read from the
  <FONT size="+1"><tt>ctrl</tt></FONT> file.

  File <A href="../subs/iosite.f">subs/iosite.f</A> documents the syntax of the file structure. <P>

  The first line should contain a '%' sign
  and a `version' token vn=#. On the same line, supply tokens
  nbas= and plat=, similar to the input file.<br>
  You can also include <FONT size="+1"><tt>alat</tt></FONT> on this line.
  If you omit it, <FONT size="+1"><tt>alat</tt></FONT> is read from <FONT size="+1"><tt>ALAT</tt></FONT> in the <FONT size="+1"><tt>ctrl</tt></FONT> file.<br>
  <FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
  <FONT size="+1"><tt>% vn=3.0 nbas=7 plat= -0.5 0.5 1 0.5 -0.5 1 0.5 0.5 1</tt></FONT>
<P>

  Following the header line comes a table of site positions other site-related stuff.  That table is not read in the <FONT size="+1"><tt>STRUC</tt></FONT> category.  To
  read site data from this file, specify <FONT size="+1"><tt>FILE</tt></FONT> in the <A href="#SITEcat"><FONT size="+1"><tt>SITE</tt></FONT></A>
  category.<br><br>
          <i>Kotani format</i>&nbsp&nbsp&nbsp; (documented here but no longer maintained) The first line should contain a '%' sign
          and a `version' token vn=kotani. Then follow four lines
          containing real numbers:
<pre> #        <-- alat
 # # #     <-- plat(1,1) plat(2,1) plat(3,1)
 # # #     <-- plat(1,2) plat(2,2) plat(3,2)
 # # #     <-- plat(1,3) plat(2,3) plat(3,3)</pre>
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ALAT </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   A scaling, in atomic units, of the primitive
          translation and basis vectors</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> NBAS </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Size of the basis</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> PLAT </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   (dimensionless) primitive translation vectors</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> NSPEC </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Number of atom species</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> DALAT </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 0</TD>
   <TD bgcolor="feffe1">
   is added to <FONT size="+1"><tt>ALAT</tt></FONT>.  Useful because the average Wigner-Seitz radius <FONT size="+1"><tt>W</tt></FONT> is
          computed from <FONT size="+1"><tt>ALAT</tt></FONT>, so quantities scaled by <FONT size="+1"><tt>W</tt></FONT> are fixed while <FONT size="+1"><tt>ALAT</tt></FONT> varies.  NB:
          this token is Not Particularly Useful for the ASA, since
          spheres must be space-filling.</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff">NL= </TD>
   <TD bgcolor="feffe1"><PRE> i</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> 3</TD>
   <TD bgcolor="feffe1">
   Sets a global default value for <i>l</i>-cutoffs <i>l</i><sup>cut</sup> :  <FONT size="+1"><tt>NL = </tt></FONT> [1 + <i>l</i><sup>cut</sup>]. This default is used for both the basis and augmentation cutoffs.

   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> SHEAR </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Enables shearing of the lattice in a volume-conserving
   manner.  For <FONT size="+1"><tt>SHEAR=#1,#2,#3,#4, #4</tt></FONT> is the distortion
   amplitude, and <FONT size="+1"><tt>#1,#2,#3</tt></FONT> are a direction vector.
   <br> <FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt>SHEAR=0,0,1,0.01</tt></FONT> <br>
   This distorts a lattice in initially cubic symmetry to tetragonal symmetry, with 0.01 shear.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ROT </TD>
   <TD bgcolor="feffe1"><PRE> c</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Rotates the lattice and basis vectors, and the symmetry
   group operations by a unitary matrix.

   <br> <FONT color="#3300bb"><I>Example</I>&nbsp;:&nbsp;</FONT>
   <FONT size="+1"><tt> ROT=z:pi/4,y:pi/3,z:pi/2</tt></FONT><br>
   generates a rotation matrix corresponding to the Euler
   angles &alpha;=&pi;/4, &beta;=&pi;/3 &gamma;=&pi;/2.
   See <A href="rotations.html">rotations.html</A> for the general syntax.

   <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
   Lattice and basis vectors, and point group operations <A href=#SYMGRPcat>(<FONT size="+1"><tt>SYMGRP</tt></FONT>)</A>
   are all rotated.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> DEFGRD </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   A 3&times;3 matrix defining a general linear transformation of the
          lattice vectors.
   </TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> STRAIN </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> Y</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   A sequence of six numbers defining a general distortion of the lattice vectors</TD>
   </TR>

   <TR>
   <TD bgcolor="e5e1ff"> ALPHA </TD>
   <TD bgcolor="feffe1"><PRE> r</PRE></TD>
   <TD bgcolor="e5e1ff"> ALL</TD>
   <TD bgcolor="feffe1"> N</TD>
   <TD bgcolor="e5e1ff"> </TD>
   <TD bgcolor="feffe1">
   Amount of Voigt strain</TD>
   </TR>

   </TBODY>
 </TABLE>

<P> Go to <A href=#contents>Table of Contents</A>

<!-- SYMGRP -->
<H3><A name="SYMGRPcat"></A>
<FONT size="+2"><tt>SYMGRP</tt></FONT> category
</H3>

Category <FONT size="+1"><tt>SYMGRP</tt></FONT> provides symmetry
information; it helps in two ways.  First it is the relevant
information to find which sites are equivalent, which makes for
simpler and more accurate band calculations, and second, it reduces
the number of <i>k</i>-points needed in Brillouin zone integrations.

<p> Normally you don't need <FONT size="+1"><tt>SYMGRP</tt></FONT>;
the program is capable of finding its own symmetry operations.
However, there are cases where it is useful or even necessary.  For
example when including spin-orbit coupling or noncollinear magnetism
where the symmetry group isn't specified by atomic positions alone.
In this case you need to supply extra information.

<P> You can use <FONT size="+1"><tt>SYMGRP</tt></FONT> to explicitly
declare a set of generators from which the entire group can be
created.  For example, the three operations <FONT
size="+1"><tt>R4X</tt></FONT>, <FONT size="+1"><tt>MX</tt></FONT> and
<FONT size="+1"><tt>R3D</tt></FONT> are sufficient to generate all 48
elements of cubic symmetry.

Unless conditions are set for noncollinear magnetism and/or SO coupling,
the inversion is assumed by default as a consequence of time-reversal symmetry<a href="#fn1" id="ref1"><sup>&dagger;</sup></a>.

<P> A tag describing a generator for a point group operation has the
form <FONT size="+1"><tt><i>O</i>(nx,ny,nz)</tt></FONT> where <FONT
size="+1"><tt><i>O</i></tt></FONT> is one of <FONT size="+1"><tt>M</tt></FONT>, <FONT size="+1"><tt>I</tt></FONT> or <FONT size="+1"><tt>R<i>j</i></tt></FONT>, or <FONT size="+1"><tt>E</tt></FONT>, for mirror, inversion
<i>j</i>-fold rotation and identity operation, respectively.  <FONT size="+1"><tt>nx,ny,nz</tt></FONT> are a triplet of indices specifying
the axis of rotation.  You may use <FONT size="+1"><tt>X</tt></FONT>, <FONT size="+1"><tt>Y</tt></FONT>, <FONT size="+1"><tt>Z</tt></FONT> or <FONT size="+1"><tt>D</tt></FONT> as shorthand for
<FONT size="+1"><tt>(1,0,0), (0,1,0), (0,0,1),</tt></FONT> and <FONT size="+1"><tt>(1,1,1)</tt></FONT> respectively.
You may also enter products of rotations, such as <FONT size="+1"><tt>I*R4X</tt></FONT>.

<P> Thus
<pre>
  SYMGRP  R4X MX R3D
</pre>
specifies three generators (4-fold rotation around <i>x</i>, mirror in
<i>x</i>, 3-fold rotation around (1,1,1)). Generating all possible combinations
of these rotations will result in the 48 symmetry operations of the cube.

<P> To suppress all symmetry operations, use
<pre>
  SYMGRP E
</pre>

<P> Full-potential programs (e.g. <b>lmf</b>) do not make spherical approximations to the potential and require you to specify the full
space group.  The translation part is appended to the point group (rotation) in one of the following forms:
`<FONT size="+1"><tt>:(x1,x2,x3)</tt></FONT>' &nbsp; or alternatively
`<FONT size="+1"><tt>::(p1,p2,p3)</tt></FONT>' with the double `<FONT size="+1"><tt>::</tt></FONT>'.  The first defines the
translation in Cartesian coordinates; the second as multiples of
plat.  These two lines (taken from <FONT size="+1"><tt>testing/ctrl.cr3si6</tt></FONT>) are
equivalent specifications:
<pre>
  SYMGRP   r6z:(0,0,0.4778973) r2(1/2,sqrt(3)/2,0)
  SYMGRP   r6z::(0,0,1/3)      r2(1/2,sqrt(3)/2,0)</pre>
</pre>

<h4><A name="SYMGRP.1">Keywords in the SYMGRP</tt></FONT> category</A></h4>

<FONT size="+1"><tt>SYMGRP</tt></FONT> accepts, in addition to symmetry operations the following keywords:

<UL>
<LI> `<FONT size="+1"><tt>find</tt></FONT>' tells the program to determine its own
symmetry operations.  Thus
<pre>
  SYMGRP find
</pre>
amounts to the same as not including a SYMGRP category
in the input at all.

You can also specify a mix of generators you supply, and
tell the program to find any others that might exist.
For example,
<pre>
  SYMGRP r4x find
</pre>
specifies that 4-fold rotation be included, and `<FONT size="+1"><tt>find</tt></FONT>' tells
the program to look for any additional symops that might exist.

<P><LI> `<FONT size="+1"><tt>AFM</tt></FONT>' :
For certain antiferromagnets, certain translation operations exist provided
the rotation/shift is accompanied by a spin flip.  Say a translation
of (-1/2,1/2,1/2)<i>a</i> restores the crystal structure, but all
atoms after translation have opposite spin.  Specify this symmetry
with
<pre>
  SYMGRP   ...       AFM::-1/2,1/2,1/2
</pre>
This operation is used only by <b>lmf</b>.

<P><LI> `<FONT size="+1"><tt>SOC</tt></FONT>' or `<FONT size="+1"><tt>SOC=2</tt></FONT>' :
Tells the symmetry group generator to exclude operations that do not preserve the <i>z</i> axis.
This is used particularly for spin-orbit coupling where the crystal symmetry is reduced (<i>z</i> is the quantization axis).
<FONT size="+1"><tt>SOC=2</tt></FONT> is like <FONT size="+1"><tt>SOC</tt></FONT> but allows operations
that preserve <FONT size="+1"><tt>z</tt></FONT> or flip <FONT size="+1"><tt>z</tt></FONT> to &minus;<FONT size="+1"><tt>z</tt></FONT>.
This works in some cases.
 <br><FONT color="#33bb00"><I>*Note</I>&nbsp;</FONT>
This keyword is only active when the two spin channels are linked, e.g. SO coupling or noncollinear magnetism.

<P><LI> `<FONT size="+1"><tt>GRP2</tt></FONT>' turns on a switch that
can force the density among inequivalent classes that share a common species to be
averaged.  In the ASA codes the density is spherical and the averaging
is complete; in the FP case only the spherical part of the densities
can be averaged.  This helps sometimes with stabilizing difficult
cases in the path to self-consistency.
You specify which species are to be averaged with the <FONT size="+1"><tt>SPEC_ATOM_GRP2</tt></FONT> token.

<P>
`<FONT size="+1"><tt>GRP2</tt></FONT>' averages the input density;
`<FONT size="+1"><tt>GRP2=2</tt></FONT>' averages the output density;
`<FONT size="+1"><tt>GRP2=3</tt></FONT>' averages both the input and the output density.

<P><LI> `<FONT size="+1"><tt>RHOPOS</tt></FONT>' turns on a switch that
forces the density positive at all points.

<!-- VERS -->
<H3><A name="VERScat"></A>
<FONT size="+2"><tt>VERS</tt></FONT> category</H3>

This category is used for version control.  As of version 7, the
input file must have following tokens for any program in the suite:
<pre>
  VERS LM:7
</pre>
It tells the input system that you have a v7 style input file.

<P> For a particular program you need an additional token to
tell the parser that this file is set up for that program.
Thus your <FONT size="+1"><tt>VERS</tt></FONT> category should read:
<pre>
  VERS LM:7 ASA:7              for <b>lm</b>, <b>lmgf</b> or <b>lmpg</b>
  VERS LM:7 FP:7               for <b>lmf</b> or <b>lmfgwd</b>
  VERS LM:7 MOL:3              for a molecules codes such as <b>lmmc</b>
  VERS LM:7 TB:9               for the empirical tight-binding <b>tbe</b>
                               and so on.
</pre>
Add version control tokens for whatever programs your
input file is capable of handling.

<P> Go to <A href=#contents>Table of Contents</A>

<H3><A name="mixing"></A>
Explanation of token MIX
</H3>

<pre>
 Category MIX controls the mixing scheme used in the iterations
 towards self-consistency in the LM program.  There is a choice
 between the Broyden and Anderson mixing schemes.  Both schemes
 mix in linear combinations of the input and output density
 (recall that in the ASA, P's and Q's are enough to completely
 specify the density) both from the present iteration and prior
 iterations to accelerate convergence to self-consistency (output
 = input).  For Anderson mixing, the mixing beta controls how
 much output and how much input moment is used in the next
 estimate for the moments: Q* = beta*Qout + (1-beta)*Qin.  Here
 Qout and Qin are charges (that is, moments or densities), and
 the "charges" generated by the input "charge" for a sequence of
 prior iterations.  For small systems, you can take beta close to
 one; for large systems charge sloshing becomes a problem and you
 have to do something different.  Possible choices need to take
 beta much smaller.  See slatsm/amix.f for a description of the
 Anderson mixing scheme, and how it chooses the linear
 combination of prior iterations in the mix.

 The syntax for Anderson mixing is

   MODE=A[,b=val]

 where the optional b=val assigns val to beta.

 Broyden mixing uses a more sophisticated procedure, in which it
 tries to build up the Hessian matrix.  It usually works better
 but has more pitfalls than Anderson.  As with Anderson, it uses
 linear mixing in the absence of prior iterations, Q* = beta*Qout
 + (1-beta)*Qin.  Broyden has an additional parameter, wc, that
 controls how much weight is given to prior iterations in the mix
 (see below).  The syntax for Broyden mixing is

   MODE=B[,b=val][,wc=val]

 There are other switches available to handle more complex cases.
 You can change the name of the mixing file, kill the mixing file
 after a number of iterations, and change to a different set of
 mixing parameters after a specified number of iterations.  The
 most general syntax is
   MODE=parm-set-1[;parm-set-2;parm-set-3...]
 Each parm-set has a general syntax:

   A[nmix][,b=beta][,n=nit][,fn=fnam][,k=nkill][,w=w1,w2][,wa=wa][,bv=betv]  or
   B[nmix][,b=beta][,wc=wc][,n=nit][,fn=fnam][,k=nkill][,w=w1,w2][,wa=wa][,bv=betv]
   (NB: additional parm [,r=rmscst] for constrained mixing)

 The optional parameters (b=, wc=, etc) may occur in any order.

 These parameters are as follows.  Fortran routine <A href="../subs/parmxp.f">parmxp.f</A> parses
 the MODE line to read the parameters, and <A href="../subs/pqmix.f">pqmix.f</A> does
 the mixing.

   nmix: maximum number of prior iterations to include in the mix
         (the mixing file may contain more than nmix prior
         iterations.)  NB: nmix=0 implies linear mixing.

   beta: the mixing beta (see above)

   betv: (when XIPMX=t): the Madelung potential as generated from
         the mixed moments is damped out.  This is done by taking
         using instead of this potential V = (1-betv) V_prior +
         betv V_rhomixed; see XIPMX below.

   nit:  the number of iterations to use mix with this set of
         parameters before passing on to the next set. After the
         last set is exhausted, it starts over with the first
         set.

   fnam: change the mixing file name (mixm is the default).
         Must be four characters or fewer.

   nkill:kill mixing file after nkill iterations.  This is
         occasionally helpful when the mixing runs out of steam,
         or when the mixing parameters change.

   wc:   (Broyden only) that controls how much weight is given to
         prior iterations in estimating the Jacobian.  wc=1 is
         fairly conservative.  Choosing wc<0 assigns a floating
         value to wc, equal to -wc-input/rms-err.  This increases
         wc as the error becomes small.

   w1,w2 (spin-polarized calculations only) pqmix mixes the sum
         (up+down) and difference (up-down) of the two spin
         channels.  They are weighted by w1 and w2 in the mixing,
         more heavily emphasizing the more heavily weighted.  As
         special cases, w1=0 freezes the charge and mixes the
         magnetic moments only w2=0 freezes the moments and mixes
         the charge only

   wa:   weight for extra quantities included with P,Q in the
         mixing procedure.  For noncollinear magnetism, includes
         the Euler angles.  For nonspherical density, includes
         the qpp.  As special cases, any one or two of w1,w2 and
         wa may be zero.  A zero weight freezes the values
         corresponding to those weights.

   Example: MODE=B30,n=8,w=2,1,fn=mxm,wc=11,k=3;A2,b=1

   does 8 iterations of Broyden mixing, followed by Anderson mixing
   The Broyden iterations weight the (up+down) double that of
   (up-down) for the spin pol case, and iterations are saved in a file
   which is deleted at the end of every third iteration.  WC is 11.
   beta assumes the default value.
   The Anderson iterations mix two prior iterations with beta of 1.
</pre>

   <A href=#ITERcat>Back to ITER</A><br>
<P> Go to <A href=#contents>Table of Contents</A>

<hr></hr>
<sup id="fn1"><sup>&dagger;</sup></a>

To suppress the automatic inclusion of inversion symmetry, use
<FONT size="+1"><tt>BZ_NOINV=T</tt></FONT>.

<b>lm</b>,
<b>lmfa</b>,
<b>lmfgwd</b>,
<b>lmfgws</b>,
<b>lmf</b>,
<b>lmmc</b>,
<b>lmgf</b>,
<b>lmdos</b>,
<b>lmchk</b>,
<b>lmscell</b>,
<b>lmstr</b>,
<b>lmxbs</b>,
<b>lmctl</b>,
<b>lmpg</b>,
<b>tbe</b>,
<b>lmmag</b>

<br><br><br>

<P><P> <b>References</b>

<FN ID=fnlmf><P>
M. Methfessel, M. van Schilfgaarde, and R. A. Casali, ``A full-potential LMTO method based
on smooth Hankel functions,'' in <i>Electronic Structure and Physical Properties of
Solids: The Uses of the LMTO Method</i>, Lecture Notes in Physics,
<b>535</b>, 114-147. H. Dreysse, ed. (Springer-Verlag, Berlin) 2000.
</FN>
