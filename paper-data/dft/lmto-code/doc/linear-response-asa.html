<!DOCTYPE html><html>
<head>
<title>ASA linear response (v7.10) </title>
<style>

/* For hyperlinks */
a:link {color:#FF0000;}      /* unvisited link */
a:link {color:#222288;}      /* unvisited link */
a:visited {color:#228822;}  /* visited link */
a:hover {color:#FF00FF;}  /* mouse over link */
a:active {color:#0000FF;}  /* selected link */
a:link {text-decoration:none;}
a:visited {text-decoration:none;}
a:hover {text-decoration:underline;}
a:active {text-decoration:underline;}

div {
padding-top: 5px;
padding-bottom: 5px;
padding-right: 5px;
padding-left: 30px;
border: 3px solid;
}
body {
       background-color:#ffffgg;
     }
 h1 {
      color:#880000;
      text-align:center;
      font-size:12px;
    }
 h2 {
      color:#bb3300;
      font-size:120%;
      font-weight:normal;
      font-style:italic;
    }

 h3 {
      color:#33bb00;
      font-size:110%;
      font-weight:normal;
      font-style:italic;
      text-indent: 0.5em;
    }

 h4 {
      color:#000000;
      font-size:100%;
      font-weight:bold;
      text-indent: 1.0em;
    }

 h5 {
      color:#444488;
      font-size:100%;
      font-weight:bold;
      font-style:normal;
      text-indent: 1.5em;
    }

 hn {
      color:#000000;
      font-size:100%;
      font-weight:normal;
      font-style:normal;
      text-indent: 1.5em;
    }

  P {
<!--  font-family:"Times New Roman"; -->
<!--  font-size:12px; -->
<!--  color: red; -->
    }

  q {
      color: red;
    }

  a {
        color: blue;
    }

  tlarge {
       <font-size="+1">
    }

  p.pos_left
  {
  position:relative;
  left:-20px;
  }

  p.pos_right
  {
  position:relative;
  left:20px;
  right:520px;
  }

div.ex
{
width:3in;
padding:10px;
border:5px solid gray;
margin:0px;
}

</style>

</head>

<BODY bgcolor="#cccccc">

<H1><B><FONT size="+2">ASA self-consistency with approximate linear response (v7.10)</FONT></B></H1>


For large systems, estimating the self-consistent density given an
input density qin and output density qout is greatly accelerated if
the dielectric response function is known.  The codes have some
capability to generate to generate the ASA response function.

<P> First, you need to create the ASA bare response function <i>P</i><sup>0</sup>,
which I define as
<br>
&nbsp;&nbsp;&nbsp;   <i>dq<sub>RL</sub></i> = <i>P<sup>0</sup><sub>RL,R'L'</sub></i> <i>dv<sub>R'L'</sub></i>
<br>

<i>dv<sub>R'L'</sub></i> is a constant potential shift in channel <i>L'</i> of sphere <i>R'</i>, and
<i>dq<sub>RL</sub></i> is the induced change in the 0th moment in channel <i>L</i> of sphere <i>R</i>,
without taking into account interactions between electrons (noninteracting susceptibility).
The static dielectric response function is
<br>
&nbsp;&nbsp;&nbsp;  &epsilon;<sup>&minus;1</sup> = (1 &minus; <i>M' P</i><sup>0</sup>)<sup>&minus;1</sup>
<br>
where
<br>
&nbsp;&nbsp;&nbsp;  <i>M'</i> = <i>M</i> + (on-site term = something like the intraatomic <i>U</i>)
<br>
and
<br>
&nbsp;&nbsp;&nbsp;  <i>M</i> = Madelung matrix.
<br>

<P>  <b>lm</b> and <b>lmgf</b> can both generate <i>P</i><sup>0</sup>, and store it on the disk.
If you have generated <i>P</i><sup>0</sup>, you can have the mixing procedure construct
&epsilon;<sup>&minus;1</sup>
and then screen (<i>q</i><sup>out</sup>&minus;<i>q</i><sup>in</sup>) by 
&epsilon;<sup>&minus;1</sup>.  More exactly, it
replaces the raw <FONT size="+1"><tt>qout</tt></FONT> (generated by <b>lm</b> or <b>lmgf</b>) by
<pre>
  qout* = qin + &epsilon;<sup>&minus;1</sup> (qout&minus;qin)
</pre>
and then it proceeds with self-consistency in the usual way, using
<FONT size="+1"><tt>qout*</tt></FONT> in place of the usual <FONT size="+1"><tt>qout</tt></FONT>.
It is not difficult to show that if &epsilon;<sup>&minus;1</sup> is the exact inverse
dielectric function, <FONT size="+1"><tt>qout*</tt></FONT> is the RPA estimate of the self-consistent density.
See, for example, Richard Martin's book, <i>Electronic Structure</i>.
Indeed &epsilon; is sometimes called the "density-density response function."

<P> To tell the code to do this screening, set <FONT size="+1"><tt>OPTIONS_SCR=2</tt></FONT>.  The program will
crash if it can't read <i>P</i><sup>0</sup> from the disk (<i>P</i><sup>0</sup> is stored in file <FONT size="+1"><tt>psta.<i>ext</i></tt></FONT>).

You can create <i>P</i><sup>0</sup> either with the band program <b>lm</b> or the Green's
function code <b>lmgf</b>.  Since the metals treatment of <i>P</i><sup>0</sup>  is
very primitive in the <b>lm</b> code, it is better to use <b>lmgf</b> to create <i>P</i><sup>0</sup> for metals.
<b>lmgf</b> can also make <i>P</i><sup>0</sup> for the noncollinear case.
To run <b>lmgf</b>, you need to add a couple of tokens
to the <FONT size="+1"><tt>ctrl</tt></FONT> file.  See <A href="gf.html">gf.html</A>.  For either program, 
set <FONT size="+1"><tt>OPTIONS_SCR=1</tt></FONT> to create <i>P</i><sup>0</sup>.

<P> The intraatomic <i>U</i> is estimated from the second derivative of the sphere
total energy wrt to charge.  You can update it every <i>k</i><sup>th</sup> iteration by adding
<FONT size="+1"><tt>10*k</tt></FONT> to the token <FONT size="+1"><tt>SCR=</tt></FONT> ... thus <FONT size="+1"><tt>SCR=52</tt></FONT> will update the <i>U</i> each 5<sup>th</sup>
iteration in the sphere program.

<P> If you don't want to make <i>P</i><sup>0</sup>, you can let the codes make a model estimate for you.
It saves you the trouble of making <i>P</i><sup>0</sup>, but it is less good than when <i>P</i><sup>0</sup> is calculated explicitly.

<P> Use the <FONT size="+1"><tt>OPTIONS_SCR</tt></FONT> token to tell the ASA programs what kind of screening you want:
<pre>
 OPTIONS_SCR       opt    i4       1,  1          default = 0
   Use scr to accelerate convergence:
   0 do nothing
   1 Make ASA static response function (see documentation)
   2 Use response to screen output q and ves
   4 Use model response to screen output q
   6 Use response to screen output ves only
     Add 1 to combine mode 1 with another mode
     Add 10*k to compute intra-site contribution to vbare each kth iteration
     Add 100*k to compute response function on every kth iteration
</pre>

