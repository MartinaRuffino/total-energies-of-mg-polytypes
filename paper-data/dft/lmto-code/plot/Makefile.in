# --- Makefile for FPLOT package ---
#     invoke  'make init' to run any preprocessing steps
#             'make ASA'  to compile a subset of packages
#

# variables to be subsbituted by configure
SHELL = @SHELL@
RANLIB = @RANLIB@
ADD0 = @ADD0@
@SET_MAKE@

# The default location for installation.  Defaults to home
prefix=@prefix@
# Like 'prefix', but used for architecture-specific files.
exec_prefix=@exec_prefix@
bindir=@bindir@

# Allow configure to specify the install program.
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_INFO = install-info

# Not used now
infodir = @infodir@
mandir = @mandir@

# ---- Machine-specific compiler flags ---
include Make.inc
# We don't need high speed here ... avoid compiler bugs by using lower default optimization
FFLAGS=$(FFLAGS_LESS)

LIBSLA = @LIBSLA@
PLDIR = @PLDIR@
PROGS = fplot pldos plbnds
#SUBS = ./subs.a

all:	$(PROGS)

progs:	$(PROGS)

# plsub.o contour.o fpsub.o: 
# 	$(FC) $(FFLAGS_LESS) -c $<
 
# fplot.o plbnds.o pldos.o: 
# 	$(FC) $(FFLAGS_LESS) -c  $<

# contour.o: 
# 	$(FC) $(FFLAGS_LLESS) -c contour.f
 
fplot:	fplot.o fpsub.o plsub.o contour.o
	$(LK) $(LKFLAGS1) $@.o fpsub.o plsub.o contour.o $(LIBES) $(LKFLAGS2) -o $@

pldos:	pldos.o plsub.o
	$(LK) $(LKFLAGS1) $@.o plsub.o $(LIBES) $(LKFLAGS2) -o $@

plbnds:	plbnds.o plsub.o
	$(LK) $(LKFLAGS1) $@.o plsub.o $(LIBES) $(LKFLAGS2) -o $@

progs:
	make -f Makefile fplot pldos plbnds
 
install:
	for p in  fplot pldos plbnds; do \
	  if test -x $$p; then \
	     echo "$(INSTALL_PROGRAM) $$p $(bindir)/$$p "; \
	     $(INSTALL_PROGRAM) $$p $(bindir)/$$p ; \
	  else \
	     echo executable $$p is missing ... not installed ;\
	  fi ; \
	done

tar:	
	rm -r -f plot; mkdir plot
	cp -rp README configure Makefile.in etc examples fplot.f plbnds.f pldos.f fpsub.f plsub.f contour.f plot
	tar --gzip -cvf FPLOT.tar.gz plot
	rm -r -f plot
 
clean:	
	rm -f $(PROGS)

veryclean:
	for p in  fplot pldos plbnds; do \
	  rm -f $$p $$p.o ; \
	done
	rm -f contour.o fpsub.o plsub.o
	rm -f plot.dos dos.cr ps.dos.cr
	rm -f plot.plbnds bnds.cr ps.cr bnd1.dat bnd2.dat bnd3.dat bnd4.dat bnd5.dat bnd6.dat
	rm -f plot.dos plot.plbnds out.fplot out.plbnds out.pldos

check:
	 examples/test.fplot  --quiet $(ADD0)
	 examples/test.pldos  --quiet $(ADD0)
	 examples/test.plbnds --quiet $(ADD0)

 
