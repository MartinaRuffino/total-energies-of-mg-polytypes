      SUBROUTINE HSM1CI(E1,E2,RSM1,RSM2,S,LMAX)
C  INTEGRAL OVER PRODUCT OF TWO SMOOTHED HANKELS WITH SAME CENTER
      IMPLICIT REAL*8 (A-H,P-Z), INTEGER (o)
      DIMENSION S(0:LMAX)
      PI=4D0*DATAN(1D0)
      SRPI=DSQRT(PI)
      GAM1=0.25D0*RSM1*RSM1
      GAM2=0.25D0*RSM2*RSM2
      GAM=GAM1+GAM2
      A=0.5D0/DSQRT(GAM)
      LEQ=0
      IF(DABS(E1-E2).LT.1D-8) LEQ=1
C ------ HERE FOR E1.EQ.E2 -----------------------
      IF(LEQ.EQ.1) THEN
      E=0.5D0*(E1+E2)
      AK=DSQRT(-E)
      HP=DERFC(0.5D0*AK/A)/(2D0*AK)
      H=-AK*DERFC(0.5D0*AK/A)+2.D0*A*DEXP(GAM*E)/SRPI
      G=4D0*PI*(A*A/PI)**1.5D0 * DEXP(GAM*E)
      S(0)=HP-GAM*H
      DO 10 L=1,LMAX
      HP=E*HP+GAM*G+H
      H=E*H+G
      S(L)=HP-GAM*H
  10  G=G*(2*L+1)*2D0*A*A
      ENDIF
C ------ HERE FOR E1.NE.E2 -----------------------
      IF(LEQ.EQ.0) THEN
      AK1=DSQRT(-E1)
      AK2=DSQRT(-E2)
      G=DEXP(E1*GAM1+E2*GAM2)*2D0*A/(SRPI*(E1-E2))
      H1=-AK1*DERFC(0.5D0*AK1/A)*DEXP(GAM2*(E2-E1))/(E1-E2)+G
      H2=-AK2*DERFC(0.5D0*AK2/A)*DEXP(GAM1*(E1-E2))/(E2-E1)-G
      S(0)=H1+H2
      DO 1 L=1,LMAX
      G=G*(2*L-1)*2*A*A
      H1=E1*H1+G
      H2=E2*H2-G
  1   S(L)=H1+H2
      ENDIF
      RETURN
      END
