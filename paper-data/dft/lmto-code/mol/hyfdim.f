      SUBROUTINE HYFDIM(MMAX,LX1,EX1,NX1,LX2,EX2,NX2,LP1,EP1,LP2,EP2,
     .   R1,R2,RSM1,RSM2,LSYM,NDIM,NRHS,NDIMX,NSDMX,NRHSX,NCOF,NXI,
     .   NALF,NDIMB,NDIMBX,NSDMBX)
C  GET DIMENSIONS FOR MHYF1
      IMPLICIT REAL*8 (A-H,P-Z), INTEGER (o)
      DIMENSION NDIM(0:20),NRHS(0:20),NDIMB(0:20),LX1(1),LX2(1),
     .   EX1(1),EX2(1)
      CALL GETPR(IPR)
      FUZZ=1.D-10
C ------ DETERMINE WHETHER CASE IS SYMMETRIC --------
      LSYM=1
      IF(LP1.NE.LP2.OR.NX1.NE.NX2) LSYM=0
      IF(DABS(RSM1-RSM2).GT.FUZZ)  LSYM=0
      IF(DABS(R1-R2).GT.FUZZ.OR.DABS(EP1-EP2).GT.FUZZ) LSYM=0
      DO 4 I=1,MIN0(NX1,NX2)
  4   IF(LX1(I).NE.LX2(I).OR.DABS(EX1(I)-EX2(I)).GT.FUZZ) LSYM=0
C ------ PRINT OUT SPECIFICATIONS FOR FUNCTIONS -----
      IF(IPR.GE.20) THEN
      WRITE(6,991) MMAX,R1,R2
  991 FORMAT(/' HYFDIM:   MMAX=',I3,'    R1,R2=',2F10.5)
      WRITE(6,990) 1,(LX1(I),I=1,NX1),(200,I=NX1+1,6),
     .   (EX1(I),I=1,NX1)
      WRITE(6,990) 2,(LX2(I),I=1,NX2),(200,I=NX2+1,6),
     .   (EX2(I),I=1,NX1)
      WRITE(6,992) LP1,EP1,RSM1,LP2,EP2,RSM2,LSYM
  990 FORMAT(' XI',I1,':   L= ',6(1X,I1),'   E=',6F7.2)
  992 FORMAT(' PHI1:  LMX=',I3,'    E=',F8.4,'    RSM=',F7.3
     .  /' PHI2:  LMX=',I3,'    E=',F8.4,'    RSM=',F7.3,/' LSYM=',I2)
      ENDIF
C ------ GET THE DIMENSION -------------------
      CALL TCFDIM(MMAX,LX1,NX1,LX2,NX2,LP1,LP2,LSYM,
     .   NDIM,NRHS,NDIMX,NSDMX,NRHSX,NCOF,NXI)
      NSDMBX=0
      NDIMBX=0
      DO 3 M=0,MMAX
      NDIMB(M)=NDIM(M)*NALF
      NSDB=(NDIMB(M)*(NDIMB(M)+1))/2
      NDIMBX=MAX0(NDIMBX,NDIMB(M))
  3   NSDMBX=MAX0(NSDMBX,NSDB)
      IF(IPR.GE.30) WRITE(6,300) NSDMBX,(NDIMB(M),M=0,MMAX)
  300 FORMAT(' NSDMBX=',I6,'  NDIMB=',12I5)
      RETURN
      END
